; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--c99 --list --debug -c --asm --interleave -o.\obj\sflashrecord.o --asm_dir=.\lst\ --list_dir=.\lst\ --depend=.\obj\sflashrecord.d --cpu=ARM926EJ-S --apcs=interwork -O0 -I.\src -I..\..\common\src\BSP\Driver\Include -I..\..\common\src\FreeRTOS -I..\..\common\src\FreeRTOS\Source\include -I..\..\common\src\FreeRTOS\Source\portable\RVDS\ARM926EJ-S -I..\..\common\src\BSP\ThirdParty\FATFS\src -I.\src\userdrv -I.\src\syshal -I.\src\user -I.\src\userdrv\vl53l0x\core\inc -I.\src\userdrv\vl53l0x\platform\inc -I.\src\syshal\json -I.\src\syshal\modemlib -I..\..\common\src\BSP\ThirdParty\yaffs2 -I..\..\common\src\BSP\ThirdParty\yaffs2\include -I..\..\common\src\BSP\ThirdParty\yaffs2\include\asm -I..\..\common\src\BSP\ThirdParty\yaffs2\include\linux -I.\src\syshal\yaffs2 -I..\..\common\src\BSP\Library\SmartcardLib\Include -I.\src\syshal\cardlib -I.\src\syshal\cardlog -I.\src\syshal\blk -I..\..\common\src\BSP\Library\USB_HOST\Inc -I..\..\common\src\BSP\Library\USB_HOST\Inc\usb_uvc -IC:\Keil\ARM\RV31\INC -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\Inc\Toshiba -DEPM_PROJECT -DCONFIG_YAFFS_DIRECT -DCONFIG_YAFFS_SHORT_NAMES_IN_RAM -DCONFIG_YAFFS_YAFFS2 -DNO_Y_INLINE -DCONFIG_YAFFS_PROVIDE_DEFS -DCONFIG_YAFFSFS_PROVIDE_VALUES --omf_browse=.\obj\sflashrecord.crf src\syshal\sflashrecord.c]
                          ARM

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_d
                          REQUIRE _printf_int_dec
                  printfBuffData PROC
;;;40     /*-----------------------------------------*/
;;;41     static void printfBuffData(char* str, uint8_t* data, int len)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;42     {
000004  e1a05000          MOV      r5,r0
000008  e1a06001          MOV      r6,r1
00000c  e1a07002          MOV      r7,r2
;;;43         int i;
;;;44         sysprintf("\r\n %s: len = %d...\r\n  ", str, len);
000010  e1a02007          MOV      r2,r7
000014  e1a01005          MOV      r1,r5
000018  e28f0f7b          ADR      r0,|L1.524|
00001c  ebfffffe          BL       sysprintf
;;;45         
;;;46         for(i = 0; i<len; i++)
000020  e3a04000          MOV      r4,#0
000024  ea00000b          B        |L1.88|
                  |L1.40|
;;;47         { 
;;;48             #if(1)
;;;49             sysprintf("0x%02x, ", data[i]);
000028  e7d61004          LDRB     r1,[r6,r4]
00002c  e28f0e1f          ADR      r0,|L1.548|
000030  ebfffffe          BL       sysprintf
;;;50             if(i%0x10 == 0xf)
000034  e1a01fc4          ASR      r1,r4,#31
000038  e0841e21          ADD      r1,r4,r1,LSR #28
00003c  e1a01241          ASR      r1,r1,#4
000040  e0441201          SUB      r1,r4,r1,LSL #4
000044  e351000f          CMP      r1,#0xf
000048  1a000001          BNE      |L1.84|
;;;51                 sysprintf("\r\n  ");
00004c  e28f0f77          ADR      r0,|L1.560|
000050  ebfffffe          BL       sysprintf
                  |L1.84|
000054  e2844001          ADD      r4,r4,#1              ;46
                  |L1.88|
000058  e1540007          CMP      r4,r7                 ;46
00005c  bafffff1          BLT      |L1.40|
;;;52             #else
;;;53             if((data[i]>=0x20)&&(data[i]<=0x7e))
;;;54                 sysprintf("[%02d]:0x%02x(%c)\r\n", i, (unsigned char)data[i], (unsigned char)data[i]);
;;;55             else
;;;56                 sysprintf("[%02d]:0x%02x\r\n", i, (unsigned char)data[i]);
;;;57             #endif
;;;58             
;;;59         }
;;;60         sysprintf("\r\n");
000060  e28f0e1d          ADR      r0,|L1.568|
000064  ebfffffe          BL       sysprintf
;;;61         
;;;62     }
000068  e8bd81f0          POP      {r4-r8,pc}
;;;63     
                          ENDP

                  recordIndexToStartAddress PROC
;;;81     */
;;;82     static uint32_t recordIndexToStartAddress(int recordIndex)
00006c  e1a01000          MOV      r1,r0
;;;83     {
;;;84         return SFLASH_RECORD_START_ADDRESS + recordIndex*SFLASH_RECORD_SIZE;
000070  e3a00000          MOV      r0,#0
000074  e0800581          ADD      r0,r0,r1,LSL #11
;;;85     }
000078  e12fff1e          BX       lr
;;;86     
                          ENDP

                  recordIndexToStatusAddress PROC
;;;87     static uint32_t recordIndexToStatusAddress(int recordIndex)
00007c  e92d4070          PUSH     {r4-r6,lr}
;;;88     {
000080  e1a04000          MOV      r4,r0
;;;89         sysprintf(" >> recordIndexToStatusAddress : recordIndex = %d, -> 0x%08x \r\n", recordIndex, recordIndexToStartAddress(recordIndex+1) - sizeof(SFlashRecordEnd) - sizeof(uint8_t));
000084  e2840001          ADD      r0,r4,#1
000088  ebfffffe          BL       recordIndexToStartAddress
00008c  e2405005          SUB      r5,r0,#5
000090  e1a02005          MOV      r2,r5
000094  e1a01004          MOV      r1,r4
000098  e28f0f67          ADR      r0,|L1.572|
00009c  ebfffffe          BL       sysprintf
;;;90         return recordIndexToStartAddress(recordIndex+1) - sizeof(SFlashRecordEnd) - sizeof(uint8_t);
0000a0  e2840001          ADD      r0,r4,#1
0000a4  ebfffffe          BL       recordIndexToStartAddress
0000a8  e2400005          SUB      r0,r0,#5
;;;91     }
0000ac  e8bd8070          POP      {r4-r6,pc}
;;;92     
                          ENDP

                  isFirstRecordInSector PROC
;;;93     //is first page/record in sector
;;;94     static BOOL isFirstRecordInSector(int recordIndex)
0000b0  e1a01000          MOV      r1,r0
;;;95     {
;;;96         if((recordIndex%SFLASH_RECORD_NUM_PER_SECTOR) == 0)
0000b4  e1a00001          MOV      r0,r1
0000b8  e0812fa0          ADD      r2,r1,r0,LSR #31
0000bc  e1a020c2          ASR      r2,r2,#1
0000c0  e0512082          SUBS     r2,r1,r2,LSL #1
0000c4  1a000001          BNE      |L1.208|
;;;97         {
;;;98             return TRUE;
0000c8  e3a00001          MOV      r0,#1
                  |L1.204|
;;;99         }
;;;100        else
;;;101        {
;;;102            return FALSE;
;;;103        }
;;;104    }
0000cc  e12fff1e          BX       lr
                  |L1.208|
0000d0  e3a00000          MOV      r0,#0                 ;102
0000d4  eafffffc          B        |L1.204|
;;;105    static BOOL getEntireRecord(uint8_t flashIndex, int recordIndex, uint8_t* pData, int dataLen)
                          ENDP

                  getEntireRecord PROC
0000d8  e92d41f0          PUSH     {r4-r8,lr}
;;;106    {
0000dc  e1a06000          MOV      r6,r0
0000e0  e1a04001          MOV      r4,r1
0000e4  e1a07002          MOV      r7,r2
0000e8  e1a05003          MOV      r5,r3
;;;107        if(dataLen != SFLASH_RECORD_SIZE)
0000ec  e3550b02          CMP      r5,#0x800
0000f0  0a000001          BEQ      |L1.252|
;;;108            return FALSE;
0000f4  e3a00000          MOV      r0,#0
                  |L1.248|
;;;109        FlashDrvNormalRead(flashIndex, recordIndexToStartAddress(recordIndex), pData, SFLASH_RECORD_SIZE);
;;;110        return TRUE;
;;;111    }
0000f8  e8bd81f0          POP      {r4-r8,pc}
                  |L1.252|
0000fc  e1a00004          MOV      r0,r4                 ;109
000100  ebfffffe          BL       recordIndexToStartAddress
000104  e1a08000          MOV      r8,r0                 ;109
000108  e3a03b02          MOV      r3,#0x800             ;109
00010c  e1a02007          MOV      r2,r7                 ;109
000110  e1a01008          MOV      r1,r8                 ;109
000114  e1a00006          MOV      r0,r6                 ;109
000118  ebfffffe          BL       FlashDrvNormalRead
00011c  e3a00001          MOV      r0,#1                 ;110
000120  eafffff4          B        |L1.248|
;;;112    
                          ENDP

                  getEntireRecordEx PROC
;;;113    static BOOL getEntireRecordEx(uint8_t flashIndex, int recordIndex, int recordNum, uint8_t* pData, int dataLen)
000124  e92d47f0          PUSH     {r4-r10,lr}
;;;114    {
000128  e1a08000          MOV      r8,r0
00012c  e1a05001          MOV      r5,r1
000130  e1a04002          MOV      r4,r2
000134  e1a06003          MOV      r6,r3
000138  e59d7020          LDR      r7,[sp,#0x20]
;;;115        if(dataLen != SFLASH_RECORD_SIZE*recordNum)
00013c  e1a00584          LSL      r0,r4,#11
000140  e1500007          CMP      r0,r7
000144  0a000005          BEQ      |L1.352|
;;;116        {
;;;117            sysprintf(" >> getEntireRecordEx Len error : dataLen = %d, SFLASH_RECORD_SIZE*recordNum = %d \r\n", dataLen, SFLASH_RECORD_SIZE*recordNum);
000148  e1a02584          LSL      r2,r4,#11
00014c  e1a01007          MOV      r1,r7
000150  e59f0124          LDR      r0,|L1.636|
000154  ebfffffe          BL       sysprintf
;;;118            return FALSE;
000158  e3a00000          MOV      r0,#0
                  |L1.348|
;;;119        }
;;;120        FlashDrvNormalRead(flashIndex, recordIndexToStartAddress(recordIndex), pData, SFLASH_RECORD_SIZE*recordNum);
;;;121        return TRUE;
;;;122    }
00015c  e8bd87f0          POP      {r4-r10,pc}
                  |L1.352|
000160  e1a00005          MOV      r0,r5                 ;120
000164  ebfffffe          BL       recordIndexToStartAddress
000168  e1a09000          MOV      r9,r0                 ;120
00016c  e1a03584          LSL      r3,r4,#11             ;120
000170  e1a02006          MOV      r2,r6                 ;120
000174  e1a01009          MOV      r1,r9                 ;120
000178  e1a00008          MOV      r0,r8                 ;120
00017c  ebfffffe          BL       FlashDrvNormalRead
000180  e3a00001          MOV      r0,#1                 ;121
000184  eafffff4          B        |L1.348|
;;;123    
                          ENDP

                  makeRecordStatus PROC
;;;124    //mark record status
;;;125    static BOOL makeRecordStatus(uint8_t flashIndex, int recordIndex, uint8_t status)
000188  e92d40f7          PUSH     {r0-r2,r4-r7,lr}
;;;126    {
00018c  e1a05000          MOV      r5,r0
000190  e1a04001          MOV      r4,r1
;;;127        sysprintf(" >> makeRecordStatus : recordIndex = %d, status = 0x%02x \r\n", recordIndex, status);
000194  e5dd2008          LDRB     r2,[sp,#8]
000198  e1a01004          MOV      r1,r4
00019c  e28f00dc          ADR      r0,|L1.640|
0001a0  ebfffffe          BL       sysprintf
;;;128        FlashDrvPageProgram(flashIndex, recordIndexToStatusAddress(recordIndex), &status, 1);
0001a4  e1a00004          MOV      r0,r4
0001a8  ebfffffe          BL       recordIndexToStatusAddress
0001ac  e1a06000          MOV      r6,r0
0001b0  e3a03001          MOV      r3,#1
0001b4  e28d2008          ADD      r2,sp,#8
0001b8  e1a01006          MOV      r1,r6
0001bc  e1a00005          MOV      r0,r5
0001c0  ebfffffe          BL       FlashDrvPageProgram
;;;129        return TRUE;
0001c4  e3a00001          MOV      r0,#1
;;;130    }
0001c8  e8bd80fe          POP      {r1-r7,pc}
;;;131    static uint16_t getChecksum(uint8_t* pTarget, uint16_t len, char* str)
                          ENDP

                  getChecksum PROC
0001cc  e92d4030          PUSH     {r4,r5,lr}
;;;132    {
0001d0  e1a03000          MOV      r3,r0
0001d4  e1a0c001          MOV      r12,r1
0001d8  e1a04002          MOV      r4,r2
;;;133        int i;
;;;134        uint16_t checksum = 0;
0001dc  e3a00000          MOV      r0,#0
;;;135        uint8_t* pr = (uint8_t*)pTarget;
0001e0  e1a02003          MOV      r2,r3
;;;136        //sysprintf("  -- getChecksum (%s) : len = %d\r\n", str, len); 
;;;137        for(i = 0; i< len; i++) 
0001e4  e3a01000          MOV      r1,#0
0001e8  ea000004          B        |L1.512|
                  |L1.492|
;;;138        {
;;;139            checksum = checksum + pr[i];
0001ec  e7d25001          LDRB     r5,[r2,r1]
0001f0  e0855000          ADD      r5,r5,r0
0001f4  e1a00805          LSL      r0,r5,#16
0001f8  e1a00820          LSR      r0,r0,#16
0001fc  e2811001          ADD      r1,r1,#1              ;137
                  |L1.512|
000200  e151000c          CMP      r1,r12                ;137
000204  bafffff8          BLT      |L1.492|
;;;140        }
;;;141        //sysprintf("  -- getChecksum (%s) : checksum = 0x%x (%d)\r\n", str, checksum, checksum); 
;;;142        return checksum;
;;;143    }
000208  e8bd8030          POP      {r4,r5,pc}
                  |L1.524|
00020c  0d0a2025          DCB      "\r\n %s: len = %d...\r\n  ",0
000210  733a206c
000214  656e203d
000218  2025642e
00021c  2e2e0d0a
000220  202000  
000223  00                DCB      0
                  |L1.548|
000224  30782530          DCB      "0x%02x, ",0
000228  32782c20
00022c  00      
00022d  00                DCB      0
00022e  00                DCB      0
00022f  00                DCB      0
                  |L1.560|
000230  0d0a2020          DCB      "\r\n  ",0
000234  00      
000235  00                DCB      0
000236  00                DCB      0
000237  00                DCB      0
                  |L1.568|
000238  0d0a00            DCB      "\r\n",0
00023b  00                DCB      0
                  |L1.572|
00023c  203e3e20          DCB      " >> recordIndexToStatusAddress : recordIndex = %d, -> 0"
000240  7265636f
000244  7264496e
000248  64657854
00024c  6f537461
000250  74757341
000254  64647265
000258  7373203a
00025c  20726563
000260  6f726449
000264  6e646578
000268  203d2025
00026c  642c202d
000270  3e2030  
000273  78253038          DCB      "x%08x \r\n",0
000277  78200d0a
00027b  00      
                  |L1.636|
                          DCD      ||.constdata||
                  |L1.640|
000280  203e3e20          DCB      " >> makeRecordStatus : recordIndex = %d, status = 0x%02"
000284  6d616b65
000288  5265636f
00028c  72645374
000290  61747573
000294  203a2072
000298  65636f72
00029c  64496e64
0002a0  6578203d
0002a4  2025642c
0002a8  20737461
0002ac  74757320
0002b0  3d203078
0002b4  253032  
0002b7  78200d0a          DCB      "x \r\n",0
0002bb  00      
                          ENDP

                  checkEntireRecord PROC
;;;144    //check data to mark bad or get currentMaxIndex / currentRecordIndex
;;;145    static BOOL checkEntireRecord(uint8_t* srcData, uint8_t** targetData, size_t* targetDataLen)
0002bc  e92d4ff8          PUSH     {r3-r11,lr}
;;;146    {    
0002c0  e1a04000          MOV      r4,r0
0002c4  e1a08001          MOV      r8,r1
0002c8  e1a09002          MOV      r9,r2
;;;147        //SFlashRecordHeader* pSFlashRecordHeader = (SFlashRecordHeader*)srcData;  
;;;148        SFlashRecord*       pSFlashRecord       = (SFlashRecord*)srcData;  
0002cc  e1a07004          MOV      r7,r4
;;;149        SFlashRecordHeader* pSFlashRecordHeader = &(pSFlashRecord->header);  
0002d0  e1a05007          MOV      r5,r7
;;;150        SFlashRecordEnd*    pSFlashRecordEnd    = &(pSFlashRecord->end); 
0002d4  e2876b01          ADD      r6,r7,#0x400
0002d8  e2866fff          ADD      r6,r6,#0x3fc
;;;151        //sysprintf("\r\checkEntireRecord[0x%02x, 0x%02x] len = %d: [srcDataLen = %d]...\r\n", pSFlashRecordHeader->value[0], pSFlashRecordHeader->value[1], pSFlashRecordHeader->Len, srcDataLen);
;;;152    
;;;153        if((pSFlashRecordHeader->value[0] == SFLASH_HEADER_VALUE) && 
0002dc  e5d50000          LDRB     r0,[r5,#0]
0002e0  e35000da          CMP      r0,#0xda
0002e4  1a000027          BNE      |L1.904|
;;;154            (pSFlashRecordHeader->value[1] == SFLASH_HEADER_VALUE2))
0002e8  e5d50001          LDRB     r0,[r5,#1]
0002ec  e35000ad          CMP      r0,#0xad
0002f0  1a000024          BNE      |L1.904|
;;;155                //&& pSFlashRecordHeader->Len == (srcDataLen-sizeof(SFlashRecordHeader) - sizeof(SFlashRecordEnd))) )       
;;;156        {
;;;157                //uint16_t checkSum = getChecksum(srcData + sizeof(SFlashRecordHeader), pSFlashRecordHeader->Len, "<parser>") ; 
;;;158                uint16_t checkSum = getChecksum(srcData + sizeof(SFlashRecordHeader), SFLASH_RECORD_SIZE - sizeof(SFlashRecordHeader) - sizeof(SFlashRecordEnd) - sizeof(uint8_t), "<parser>") ; 
0002f4  e28f2fcf          ADR      r2,|L1.1592|
0002f8  e59f1344          LDR      r1,|L1.1604|
0002fc  e2840006          ADD      r0,r4,#6
000300  ebfffffe          BL       getChecksum
000304  e1a0a000          MOV      r10,r0
;;;159                
;;;160                if((checkSum == pSFlashRecordEnd->checksum)  &&
000308  e5d60001          LDRB     r0,[r6,#1]
00030c  e5d61000          LDRB     r1,[r6,#0]
000310  e1810400          ORR      r0,r1,r0,LSL #8
000314  e150000a          CMP      r0,r10
000318  1a000011          BNE      |L1.868|
;;;161                    (pSFlashRecordEnd->value[0] == SFLASH_END_VALUE) && 
00031c  e5d60002          LDRB     r0,[r6,#2]
000320  e350001f          CMP      r0,#0x1f
000324  1a00000e          BNE      |L1.868|
;;;162                    (pSFlashRecordEnd->value[1] == SFLASH_END_VALUE2))
000328  e5d60003          LDRB     r0,[r6,#3]
00032c  e35000f1          CMP      r0,#0xf1
000330  1a00000b          BNE      |L1.868|
;;;163                {
;;;164                    *targetData = pSFlashRecord->data;// srcData + sizeof(SFlashRecordHeader);
000334  e2870006          ADD      r0,r7,#6
000338  e5880000          STR      r0,[r8,#0]
;;;165                    *targetDataLen = pSFlashRecordHeader->Len;
00033c  e2850002          ADD      r0,r5,#2
000340  ebfffffe          BL       __aeabi_uread4
000344  e5890000          STR      r0,[r9,#0]
;;;166                    srcData[pSFlashRecordHeader->Len + sizeof(SFlashRecordHeader)] = 0x0;
000348  e2850002          ADD      r0,r5,#2
00034c  ebfffffe          BL       __aeabi_uread4
000350  e2800006          ADD      r0,r0,#6
000354  e3a01000          MOV      r1,#0
000358  e7c41000          STRB     r1,[r4,r0]
;;;167                    //sysprintf("\r\n checkEntireRecord OK .\r\n");
;;;168                    //printfBuffData("checkEntireRecord", *targetData, 32);
;;;169                    return TRUE;
00035c  e3a00001          MOV      r0,#1
                  |L1.864|
;;;170                }
;;;171                else
;;;172                {
;;;173                    terninalPrintf("\r\n checkEntireRecord End ERROR [0x%02x, 0x%02x] checkSum = %d (%d)...\r\n", pSFlashRecordEnd->value[0], pSFlashRecordEnd->value[1], pSFlashRecordEnd->checksum, checkSum);
;;;174                    #if(0)
;;;175                    printfBuffData("checkEntireRecord", srcData, SFLASH_RECORD_SIZE);
;;;176                    #endif
;;;177                }
;;;178        }
;;;179        else
;;;180        {
;;;181            terninalPrintf("\r\n checkEntireRecord Header ERROR [0x%02x, 0x%02x] ...\r\n", pSFlashRecordHeader->value[0], pSFlashRecordHeader->value[1]);
;;;182            printfBuffData("checkEntireRecord", srcData, SFLASH_RECORD_SIZE);
;;;183        }
;;;184        return FALSE;
;;;185    }
000360  e8bd8ff8          POP      {r3-r11,pc}
                  |L1.868|
000364  e58da000          STR      r10,[sp,#0]           ;173
000368  e5d60001          LDRB     r0,[r6,#1]            ;173
00036c  e5d6c000          LDRB     r12,[r6,#0]           ;173
000370  e18c3400          ORR      r3,r12,r0,LSL #8      ;173
000374  e5d62003          LDRB     r2,[r6,#3]            ;173
000378  e5d61002          LDRB     r1,[r6,#2]            ;173
00037c  e59f02c4          LDR      r0,|L1.1608|
000380  ebfffffe          BL       terninalPrintf
000384  ea000007          B        |L1.936|
                  |L1.904|
000388  e5d52001          LDRB     r2,[r5,#1]            ;181
00038c  e5d51000          LDRB     r1,[r5,#0]            ;181
000390  e28f0fad          ADR      r0,|L1.1612|
000394  ebfffffe          BL       terninalPrintf
000398  e3a02b02          MOV      r2,#0x800             ;182
00039c  e1a01004          MOV      r1,r4                 ;182
0003a0  e28f0e2e          ADR      r0,|L1.1672|
0003a4  ebfffffe          BL       printfBuffData
                  |L1.936|
0003a8  e3a00000          MOV      r0,#0                 ;184
0003ac  eaffffeb          B        |L1.864|
;;;186    #define SFLASH_BATCH_CHECK_NUM   SFLASH_RECORD_TOTAL_NUM
                          ENDP

                  scanSFlash PROC
;;;187    static void scanSFlash(void)
0003b0  e92d43fe          PUSH     {r1-r9,lr}
;;;188    {
;;;189        int i, j;   
;;;190        int targetIndex;    
;;;191        //SFlashRecord data[SFLASH_BATCH_CHECK_NUM];
;;;192        SFlashRecord* data = pvPortMalloc(sizeof(SFlashRecord) * SFLASH_BATCH_CHECK_NUM);
0003b4  e3a00602          MOV      r0,#0x200000
0003b8  ebfffffe          BL       pvPortMalloc
0003bc  e1a08000          MOV      r8,r0
;;;193        if(data == NULL)
0003c0  e3580000          CMP      r8,#0
0003c4  1a000002          BNE      |L1.980|
;;;194        {
;;;195            sysprintf("S-Flash pvPortMalloc Fail .........\r\n");
0003c8  e28f0fb3          ADR      r0,|L1.1692|
0003cc  ebfffffe          BL       sysprintf
                  |L1.976|
;;;196            return;
;;;197        }
;;;198        SFlashRecord* pSFlashRecord;// = (SFlashRecord*)data;
;;;199        uint8_t* targetData;
;;;200        size_t targetDataLen;
;;;201        for(i = 0; i < SFLASH_RECORD_TOTAL_NUM/SFLASH_BATCH_CHECK_NUM ; i++)
;;;202        {
;;;203            //getEntireRecord(SPI_FLASH_EX_0_INDEX, i, data, sizeof(data));  
;;;204            getEntireRecordEx(SPI_FLASH_EX_0_INDEX, i * SFLASH_BATCH_CHECK_NUM, SFLASH_BATCH_CHECK_NUM, (uint8_t*)data, sizeof(SFlashRecord) * SFLASH_BATCH_CHECK_NUM/*sizeof(data)*/);
;;;205            //sprintf(title, "scanSFlash_%02d [Before]", i);
;;;206            #if(SFLASH_DEBUG)
;;;207            sysprintf("S-Flash Batch Check <%04d ~ %04d>\r\n", SFLASH_BATCH_CHECK_NUM * i + 0, SFLASH_BATCH_CHECK_NUM * i + SFLASH_BATCH_CHECK_NUM - 1);
;;;208            #endif
;;;209            for(j = 0; j < SFLASH_BATCH_CHECK_NUM ; j++)
;;;210            {
;;;211                //printfBuffData("S-Flash Check", data, SFLASH_RECORD_SIZE); 
;;;212                targetIndex = SFLASH_BATCH_CHECK_NUM * i + j;
;;;213                #if(!SFLASH_DEBUG)
;;;214                sysprintf("S-Flash Check <%04d/%04d>\r", targetIndex, SFLASH_RECORD_TOTAL_NUM);
;;;215                #endif
;;;216                pSFlashRecord = &data[j];
;;;217                currentStatus[targetIndex] = pSFlashRecord->status;        
;;;218                switch(pSFlashRecord->status)
;;;219                {
;;;220                    case SFLASH_RECORD_STATUS_EMPTY:
;;;221                        #if(SFLASH_DEBUG)
;;;222                        sysprintf(" <%08d> -> [EMPTY]\r\n", targetIndex);
;;;223                        #endif
;;;224                        break;
;;;225                    
;;;226                    case SFLASH_RECORD_STATUS_DATA:                
;;;227                        if(checkEntireRecord((uint8_t*)pSFlashRecord, &targetData, &targetDataLen))
;;;228                        {
;;;229                            #if(SFLASH_DEBUG)
;;;230                            sysprintf(" <%08d> -> [DATA] : index = %d, name = [%s] \r\n      data = [%s] \r\n", targetIndex, pSFlashRecord->index, pSFlashRecord->name, targetData);
;;;231                            #endif
;;;232                            if(currentMaxIndex <  pSFlashRecord->index)
;;;233                            {
;;;234                                currentMaxIndex = pSFlashRecord->index;
;;;235                                headerRecordIndex = targetIndex + 1; 
;;;236                                headerRecordIndex = headerRecordIndex % SFLASH_RECORD_TOTAL_NUM;
;;;237                            }  
;;;238                            if(endRecordIndex == -1)
;;;239                            {
;;;240                                endRecordIndex = targetIndex;
;;;241                            }                        
;;;242                        } 
;;;243                        else
;;;244                        {
;;;245                            #if(SFLASH_DEBUG)
;;;246                            sysprintf(" <%08d> -> [DATA] ERROR: Mark BAD Record \r\n", targetIndex);
;;;247                            #endif
;;;248                            makeRecordStatus(SPI_FLASH_EX_0_INDEX, targetIndex, SFLASH_RECORD_STATUS_BAD);
;;;249                            currentStatus[targetIndex] = SFLASH_RECORD_STATUS_BAD;
;;;250                        }                    
;;;251                        break;
;;;252                        
;;;253                    case SFLASH_RECORD_STATUS_BACKUP:                
;;;254                        if(checkEntireRecord((uint8_t*)pSFlashRecord, &targetData, &targetDataLen))
;;;255                        {
;;;256                            #if(SFLASH_DEBUG)
;;;257                            sysprintf(" <%08d> -> [BACKUP] : index = %d, name = [%s] \r\n      data = [%s] \r\n", targetIndex, pSFlashRecord->index, pSFlashRecord->name, targetData);
;;;258                            #endif
;;;259                            if(currentMaxIndex <  pSFlashRecord->index)
;;;260                            {
;;;261                                currentMaxIndex = pSFlashRecord->index;
;;;262                                headerRecordIndex = targetIndex +1; 
;;;263                                headerRecordIndex = headerRecordIndex % SFLASH_RECORD_TOTAL_NUM;
;;;264                            }   
;;;265                        } 
;;;266                        else
;;;267                        {
;;;268                            #if(SFLASH_DEBUG)
;;;269                            sysprintf(" <%08d> -> [BACKUP] ERROR: Mark BAD Record \r\n", targetIndex);
;;;270                            #endif
;;;271                            makeRecordStatus(SPI_FLASH_EX_0_INDEX, targetIndex, SFLASH_RECORD_STATUS_BAD);
;;;272                            currentStatus[targetIndex] = SFLASH_RECORD_STATUS_BAD;
;;;273                        }                 
;;;274                        break;
;;;275                        
;;;276                    case SFLASH_RECORD_STATUS_BAD:
;;;277                        #if(SFLASH_DEBUG)
;;;278                        sysprintf(" <%08d> -> [BAD] \r\n", targetIndex);
;;;279                        #endif
;;;280                        break;    
;;;281                        
;;;282                    default:
;;;283                        #if(SFLASH_DEBUG)
;;;284                        sysprintf(" <%08d> -> [OTHER] \r\n", targetIndex);
;;;285                        #endif
;;;286                        makeRecordStatus(SPI_FLASH_EX_0_INDEX, targetIndex, SFLASH_RECORD_STATUS_BAD);
;;;287                        currentStatus[targetIndex] = SFLASH_RECORD_STATUS_BAD;
;;;288                        break;
;;;289                }
;;;290                //getEntireRecord(SPI_FLASH_EX_0_INDEX, targetIndex, data, sizeof(data));
;;;291                //sprintf(title, "scanSFlash_%02d [End]", targetIndex);
;;;292                //printfBuffData(title, data, SFLASH_RECORD_SIZE);
;;;293                //sysprintf(" -- currentStatus[%d] = %d (0X%02X), currentMaxIndex = %d -- \r\n", targetIndex, currentStatus[targetIndex], currentStatus[targetIndex], currentMaxIndex);
;;;294            }
;;;295    
;;;296        }
;;;297        //printfBuffData(" [ Current Status ] ", currentStatus, SFLASH_RECORD_TOTAL_NUM);
;;;298        if(endRecordIndex == -1)
;;;299        {
;;;300            //endRecordIndex = 0;
;;;301            endRecordIndex = headerRecordIndex;
;;;302        }  
;;;303        sysprintf("\r\n #!!!# scanSFlash END: total record number = %d, currentMaxIndex = %d, headerRecordIndex = %d, endRecordIndex = %d -- \r\n", SFLASH_RECORD_TOTAL_NUM, currentMaxIndex, headerRecordIndex, endRecordIndex);
;;;304        vPortFree(data); 
;;;305    }
0003d0  e8bd83fe          POP      {r1-r9,pc}
                  |L1.980|
0003d4  e3a06000          MOV      r6,#0                 ;201
0003d8  ea00007e          B        |L1.1496|
                  |L1.988|
0003dc  e3a00602          MOV      r0,#0x200000          ;204
0003e0  e1a01506          LSL      r1,r6,#10             ;204
0003e4  e1a03008          MOV      r3,r8                 ;204
0003e8  e3a02b01          MOV      r2,#0x400             ;204
0003ec  e58d0000          STR      r0,[sp,#0]            ;204
0003f0  e3a00001          MOV      r0,#1                 ;204
0003f4  ebfffffe          BL       getEntireRecordEx
0003f8  e3a07000          MOV      r7,#0                 ;209
0003fc  ea000072          B        |L1.1484|
                  |L1.1024|
000400  e3a00b01          MOV      r0,#0x400             ;212
000404  e0247690          MLA      r4,r0,r6,r7           ;212
000408  e3a02b01          MOV      r2,#0x400             ;214
00040c  e1a01004          MOV      r1,r4                 ;214
000410  e28f0fab          ADR      r0,|L1.1732|
000414  ebfffffe          BL       sysprintf
000418  e0885587          ADD      r5,r8,r7,LSL #11      ;216
00041c  e5d507fb          LDRB     r0,[r5,#0x7fb]        ;217
000420  e59f12b8          LDR      r1,|L1.1760|
000424  e7c10004          STRB     r0,[r1,r4]            ;217
000428  e5d507fb          LDRB     r0,[r5,#0x7fb]        ;218
00042c  e3500000          CMP      r0,#0                 ;218
000430  0a000058          BEQ      |L1.1432|
000434  e35000fc          CMP      r0,#0xfc              ;218
000438  0a000030          BEQ      |L1.1280|
00043c  e35000fe          CMP      r0,#0xfe              ;218
000440  0a000002          BEQ      |L1.1104|
000444  e35000ff          CMP      r0,#0xff              ;218
000448  1a000054          BNE      |L1.1440|
00044c  ea00005c          B        |L1.1476|
                  |L1.1104|
000450  e1a00000          MOV      r0,r0                 ;226
000454  e28d2004          ADD      r2,sp,#4              ;227
000458  e28d1008          ADD      r1,sp,#8              ;227
00045c  e1a00005          MOV      r0,r5                 ;227
000460  ebfffffe          BL       checkEntireRecord
000464  e3500000          CMP      r0,#0                 ;227
000468  0a00001c          BEQ      |L1.1248|
00046c  e2850c07          ADD      r0,r5,#0x700          ;232
000470  e28000f7          ADD      r0,r0,#0xf7           ;232
000474  ebfffffe          BL       __aeabi_uread4
000478  e59f1264          LDR      r1,|L1.1764|
00047c  e5911000          LDR      r1,[r1,#0]            ;232  ; currentMaxIndex
000480  e1500001          CMP      r0,r1                 ;232
000484  9a00000e          BLS      |L1.1220|
000488  e2850c07          ADD      r0,r5,#0x700          ;234
00048c  e28000f7          ADD      r0,r0,#0xf7           ;234
000490  ebfffffe          BL       __aeabi_uread4
000494  e59f1248          LDR      r1,|L1.1764|
000498  e5810000          STR      r0,[r1,#0]            ;234  ; currentMaxIndex
00049c  e2840001          ADD      r0,r4,#1              ;235
0004a0  e59f1240          LDR      r1,|L1.1768|
0004a4  e5810000          STR      r0,[r1,#0]            ;235  ; headerRecordIndex
0004a8  e5910000          LDR      r0,[r1,#0]            ;236  ; headerRecordIndex
0004ac  e1a01fc0          ASR      r1,r0,#31             ;236
0004b0  e0801b21          ADD      r1,r0,r1,LSR #22      ;236
0004b4  e1a01541          ASR      r1,r1,#10             ;236
0004b8  e0401501          SUB      r1,r0,r1,LSL #10      ;236
0004bc  e59f2224          LDR      r2,|L1.1768|
0004c0  e5821000          STR      r1,[r2,#0]            ;236  ; headerRecordIndex
                  |L1.1220|
0004c4  e59f0220          LDR      r0,|L1.1772|
0004c8  e5900000          LDR      r0,[r0,#0]            ;238  ; endRecordIndex
0004cc  e3700001          CMN      r0,#1                 ;238
0004d0  1a000009          BNE      |L1.1276|
0004d4  e59f0210          LDR      r0,|L1.1772|
0004d8  e5804000          STR      r4,[r0,#0]            ;240  ; endRecordIndex
0004dc  ea000006          B        |L1.1276|
                  |L1.1248|
0004e0  e3a02000          MOV      r2,#0                 ;248
0004e4  e1a01004          MOV      r1,r4                 ;248
0004e8  e3a00001          MOV      r0,#1                 ;248
0004ec  ebfffffe          BL       makeRecordStatus
0004f0  e3a00000          MOV      r0,#0                 ;249
0004f4  e59f11e4          LDR      r1,|L1.1760|
0004f8  e7c10004          STRB     r0,[r1,r4]            ;249
                  |L1.1276|
0004fc  ea000030          B        |L1.1476|
                  |L1.1280|
000500  e1a00000          MOV      r0,r0                 ;253
000504  e28d2004          ADD      r2,sp,#4              ;254
000508  e28d1008          ADD      r1,sp,#8              ;254
00050c  e1a00005          MOV      r0,r5                 ;254
000510  ebfffffe          BL       checkEntireRecord
000514  e3500000          CMP      r0,#0                 ;254
000518  0a000016          BEQ      |L1.1400|
00051c  e2850c07          ADD      r0,r5,#0x700          ;259
000520  e28000f7          ADD      r0,r0,#0xf7           ;259
000524  ebfffffe          BL       __aeabi_uread4
000528  e59f11b4          LDR      r1,|L1.1764|
00052c  e5911000          LDR      r1,[r1,#0]            ;259  ; currentMaxIndex
000530  e1500001          CMP      r0,r1                 ;259
000534  9a000016          BLS      |L1.1428|
000538  e2850c07          ADD      r0,r5,#0x700          ;261
00053c  e28000f7          ADD      r0,r0,#0xf7           ;261
000540  ebfffffe          BL       __aeabi_uread4
000544  e59f1198          LDR      r1,|L1.1764|
000548  e5810000          STR      r0,[r1,#0]            ;261  ; currentMaxIndex
00054c  e2840001          ADD      r0,r4,#1              ;262
000550  e59f1190          LDR      r1,|L1.1768|
000554  e5810000          STR      r0,[r1,#0]            ;262  ; headerRecordIndex
000558  e5910000          LDR      r0,[r1,#0]            ;263  ; headerRecordIndex
00055c  e1a01fc0          ASR      r1,r0,#31             ;263
000560  e0801b21          ADD      r1,r0,r1,LSR #22      ;263
000564  e1a01541          ASR      r1,r1,#10             ;263
000568  e0401501          SUB      r1,r0,r1,LSL #10      ;263
00056c  e59f2174          LDR      r2,|L1.1768|
000570  e5821000          STR      r1,[r2,#0]            ;263  ; headerRecordIndex
000574  ea000006          B        |L1.1428|
                  |L1.1400|
000578  e3a02000          MOV      r2,#0                 ;271
00057c  e1a01004          MOV      r1,r4                 ;271
000580  e3a00001          MOV      r0,#1                 ;271
000584  ebfffffe          BL       makeRecordStatus
000588  e3a00000          MOV      r0,#0                 ;272
00058c  e59f114c          LDR      r1,|L1.1760|
000590  e7c10004          STRB     r0,[r1,r4]            ;272
                  |L1.1428|
000594  ea00000a          B        |L1.1476|
                  |L1.1432|
000598  e1a00000          MOV      r0,r0                 ;276
00059c  ea000008          B        |L1.1476|
                  |L1.1440|
0005a0  e1a00000          MOV      r0,r0                 ;282
0005a4  e3a02000          MOV      r2,#0                 ;286
0005a8  e1a01004          MOV      r1,r4                 ;286
0005ac  e3a00001          MOV      r0,#1                 ;286
0005b0  ebfffffe          BL       makeRecordStatus
0005b4  e3a00000          MOV      r0,#0                 ;287
0005b8  e59f1120          LDR      r1,|L1.1760|
0005bc  e7c10004          STRB     r0,[r1,r4]            ;287
0005c0  e1a00000          MOV      r0,r0                 ;288
                  |L1.1476|
0005c4  e1a00000          MOV      r0,r0                 ;224
0005c8  e2877001          ADD      r7,r7,#1              ;209
                  |L1.1484|
0005cc  e3570b01          CMP      r7,#0x400             ;209
0005d0  baffff8a          BLT      |L1.1024|
0005d4  e2866001          ADD      r6,r6,#1              ;201
                  |L1.1496|
0005d8  e3560001          CMP      r6,#1                 ;201
0005dc  baffff7e          BLT      |L1.988|
0005e0  e59f0104          LDR      r0,|L1.1772|
0005e4  e5900000          LDR      r0,[r0,#0]            ;298  ; endRecordIndex
0005e8  e3700001          CMN      r0,#1                 ;298
0005ec  1a000003          BNE      |L1.1536|
0005f0  e59f00f0          LDR      r0,|L1.1768|
0005f4  e5900000          LDR      r0,[r0,#0]            ;301  ; headerRecordIndex
0005f8  e59f10ec          LDR      r1,|L1.1772|
0005fc  e5810000          STR      r0,[r1,#0]            ;301  ; endRecordIndex
                  |L1.1536|
000600  e59f00e4          LDR      r0,|L1.1772|
000604  e5900000          LDR      r0,[r0,#0]            ;303  ; endRecordIndex
000608  e58d0000          STR      r0,[sp,#0]            ;303
00060c  e59f00d4          LDR      r0,|L1.1768|
000610  e5903000          LDR      r3,[r0,#0]            ;303  ; headerRecordIndex
000614  e59f00c8          LDR      r0,|L1.1764|
000618  e3a01b01          MOV      r1,#0x400             ;303
00061c  e5902000          LDR      r2,[r0,#0]            ;303  ; currentMaxIndex
000620  e59f00c8          LDR      r0,|L1.1776|
000624  ebfffffe          BL       sysprintf
000628  e1a00008          MOV      r0,r8                 ;304
00062c  ebfffffe          BL       vPortFree
000630  e1a00000          MOV      r0,r0
000634  eaffff65          B        |L1.976|
                  |L1.1592|
000638  3c706172          DCB      "<parser>",0
00063c  7365723e
000640  00      
000641  00                DCB      0
000642  00                DCB      0
000643  00                DCB      0
                  |L1.1604|
                          DCD      0x000007f5
                  |L1.1608|
                          DCD      ||.constdata||+0x58
                  |L1.1612|
00064c  0d0a2063          DCB      "\r\n checkEntireRecord Header ERROR [0x%02x, 0x%02x] .."
000650  6865636b
000654  456e7469
000658  72655265
00065c  636f7264
000660  20486561
000664  64657220
000668  4552524f
00066c  52205b30
000670  78253032
000674  782c2030
000678  78253032
00067c  785d202e
000680  2e      
000681  2e0d0a00          DCB      ".\r\n",0
000685  00                DCB      0
000686  00                DCB      0
000687  00                DCB      0
                  |L1.1672|
000688  63686563          DCB      "checkEntireRecord",0
00068c  6b456e74
000690  69726552
000694  65636f72
000698  6400    
00069a  00                DCB      0
00069b  00                DCB      0
                  |L1.1692|
00069c  532d466c          DCB      "S-Flash pvPortMalloc Fail .........\r\n",0
0006a0  61736820
0006a4  7076506f
0006a8  72744d61
0006ac  6c6c6f63
0006b0  20466169
0006b4  6c202e2e
0006b8  2e2e2e2e
0006bc  2e2e2e0d
0006c0  0a00    
0006c2  00                DCB      0
0006c3  00                DCB      0
                  |L1.1732|
0006c4  532d466c          DCB      "S-Flash Check <%04d/%04d>\r",0
0006c8  61736820
0006cc  43686563
0006d0  6b203c25
0006d4  3034642f
0006d8  25303464
0006dc  3e0d00  
0006df  00                DCB      0
                  |L1.1760|
                          DCD      currentStatus
                  |L1.1764|
                          DCD      currentMaxIndex
                  |L1.1768|
                          DCD      headerRecordIndex
                  |L1.1772|
                          DCD      endRecordIndex
                  |L1.1776|
                          DCD      ||.constdata||+0xa0
                          ENDP

                  listSFlash PROC
;;;306    
;;;307    static void listSFlash(uint8_t flashIndex)
0006f4  e92d40f0          PUSH     {r4-r7,lr}
;;;308    {
0006f8  e24ddb02          SUB      sp,sp,#0x800
0006fc  e24dd014          SUB      sp,sp,#0x14
000700  e1a06000          MOV      r6,r0
;;;309        int i;    
;;;310        uint8_t data[SFLASH_RECORD_SIZE];
;;;311        SFlashRecord* pSFlashRecord = (SFlashRecord*)data;
000704  e28d4014          ADD      r4,sp,#0x14
;;;312        uint8_t* targetData;
;;;313        size_t targetDataLen;
;;;314        for(i = 0; i < SFLASH_RECORD_TOTAL_NUM ; i++)
000708  e3a05000          MOV      r5,#0
00070c  ea000054          B        |L1.2148|
                  |L1.1808|
;;;315        {
;;;316            getEntireRecord(flashIndex, i, data, sizeof(data));        
000710  e3a03b02          MOV      r3,#0x800
000714  e28d2014          ADD      r2,sp,#0x14
000718  e1a01005          MOV      r1,r5
00071c  e1a00006          MOV      r0,r6
000720  ebfffffe          BL       getEntireRecord
;;;317            //sprintf(title, "listSFlash%02d [Before]", i);
;;;318            //printfBuffData(title, data, SFLASH_RECORD_SIZE);
;;;319            
;;;320            //if(checkEntireRecord(data, &targetData, &targetDataLen) == FALSE)
;;;321            //{
;;;322            //    #if(SFLASH_DEBUG)
;;;323            //    terninalPrintf(" <%08d> -> [checkEntireRecord] ERROR\r\n", i);
;;;324            //    #endif
;;;325            //    continue;
;;;326            //}
;;;327            
;;;328            currentStatus[i] = pSFlashRecord->status;        
000724  e5d407fb          LDRB     r0,[r4,#0x7fb]
000728  e51f1050          LDR      r1,|L1.1760|
00072c  e7c10005          STRB     r0,[r1,r5]
;;;329            switch(pSFlashRecord->status)
000730  e5d407fb          LDRB     r0,[r4,#0x7fb]
000734  e3500000          CMP      r0,#0
000738  0a00003d          BEQ      |L1.2100|
00073c  e35000fc          CMP      r0,#0xfc
000740  0a000021          BEQ      |L1.1996|
000744  e35000fe          CMP      r0,#0xfe
000748  0a000005          BEQ      |L1.1892|
00074c  e35000ff          CMP      r0,#0xff
000750  1a00003c          BNE      |L1.2120|
;;;330            {
;;;331                case SFLASH_RECORD_STATUS_EMPTY:
;;;332                    terninalPrintf(" <%08d> -> [EMPTY]\r\n", i);
000754  e1a01005          MOV      r1,r5
000758  e28f0e2b          ADR      r0,|L1.2576|
00075c  ebfffffe          BL       terninalPrintf
;;;333                    break;
000760  ea00003d          B        |L1.2140|
                  |L1.1892|
;;;334                
;;;335                case SFLASH_RECORD_STATUS_DATA:                
000764  e1a00000          MOV      r0,r0
;;;336                    if(checkEntireRecord(data, &targetData, &targetDataLen))
000768  e28d200c          ADD      r2,sp,#0xc
00076c  e28d1010          ADD      r1,sp,#0x10
000770  e28d0014          ADD      r0,sp,#0x14
000774  ebfffffe          BL       checkEntireRecord
000778  e3500000          CMP      r0,#0
00077c  0a00000e          BEQ      |L1.1980|
;;;337                    {
;;;338                        terninalPrintf(" <%08d> -> [DATA] : index = %d, len = %d, name = [%s] \r\n      data = [%s] \r\n", i, pSFlashRecord->index, targetDataLen, pSFlashRecord->name, targetData);                    
000780  e2840c07          ADD      r0,r4,#0x700
000784  e28000f7          ADD      r0,r0,#0xf7
000788  ebfffffe          BL       __aeabi_uread4
00078c  e1a07000          MOV      r7,r0
000790  e2841c07          ADD      r1,r4,#0x700
000794  e28110b6          ADD      r1,r1,#0xb6
000798  e59d0010          LDR      r0,[sp,#0x10]
00079c  e58d0004          STR      r0,[sp,#4]
0007a0  e58d1000          STR      r1,[sp,#0]
0007a4  e1a02007          MOV      r2,r7
0007a8  e1a01005          MOV      r1,r5
0007ac  e59f0274          LDR      r0,|L1.2600|
0007b0  e59d300c          LDR      r3,[sp,#0xc]
0007b4  ebfffffe          BL       terninalPrintf
0007b8  ea000002          B        |L1.1992|
                  |L1.1980|
;;;339                    } 
;;;340                    else
;;;341                    {
;;;342                        terninalPrintf(" <%08d> -> [DATA] ERROR\r\n", i);
0007bc  e1a01005          MOV      r1,r5
0007c0  e28f0f99          ADR      r0,|L1.2604|
0007c4  ebfffffe          BL       terninalPrintf
                  |L1.1992|
;;;343                    }                    
;;;344                    break;
0007c8  ea000023          B        |L1.2140|
                  |L1.1996|
;;;345                    
;;;346                case SFLASH_RECORD_STATUS_BACKUP:                
0007cc  e1a00000          MOV      r0,r0
;;;347                    if(checkEntireRecord(data, &targetData, &targetDataLen))
0007d0  e28d200c          ADD      r2,sp,#0xc
0007d4  e28d1010          ADD      r1,sp,#0x10
0007d8  e28d0014          ADD      r0,sp,#0x14
0007dc  ebfffffe          BL       checkEntireRecord
0007e0  e3500000          CMP      r0,#0
0007e4  0a00000e          BEQ      |L1.2084|
;;;348                    {
;;;349                        terninalPrintf(" <%08d> -> [BACKUP] : index = %d, len = %d, name = [%s] \r\n      data = [%s] \r\n", i, pSFlashRecord->index, targetDataLen, pSFlashRecord->name, targetData);      
0007e8  e2840c07          ADD      r0,r4,#0x700
0007ec  e28000f7          ADD      r0,r0,#0xf7
0007f0  ebfffffe          BL       __aeabi_uread4
0007f4  e1a07000          MOV      r7,r0
0007f8  e2841c07          ADD      r1,r4,#0x700
0007fc  e28110b6          ADD      r1,r1,#0xb6
000800  e59d0010          LDR      r0,[sp,#0x10]
000804  e58d0004          STR      r0,[sp,#4]
000808  e58d1000          STR      r1,[sp,#0]
00080c  e1a02007          MOV      r2,r7
000810  e1a01005          MOV      r1,r5
000814  e59f022c          LDR      r0,|L1.2632|
000818  e59d300c          LDR      r3,[sp,#0xc]
00081c  ebfffffe          BL       terninalPrintf
000820  ea000002          B        |L1.2096|
                  |L1.2084|
;;;350                    } 
;;;351                    else
;;;352                    {
;;;353                        terninalPrintf(" <%08d> -> [BACKUP] ERROR\r\n", i);
000824  e1a01005          MOV      r1,r5
000828  e28f0f87          ADR      r0,|L1.2636|
00082c  ebfffffe          BL       terninalPrintf
                  |L1.2096|
;;;354                    }                 
;;;355                    break;
000830  ea000009          B        |L1.2140|
                  |L1.2100|
;;;356                    
;;;357                case SFLASH_RECORD_STATUS_BAD:
000834  e1a00000          MOV      r0,r0
;;;358                    terninalPrintf(" <%08d> -> [BAD] \r\n", i);            
000838  e1a01005          MOV      r1,r5
00083c  e28f0f89          ADR      r0,|L1.2664|
000840  ebfffffe          BL       terninalPrintf
;;;359                    break;    
000844  ea000004          B        |L1.2140|
                  |L1.2120|
;;;360                    
;;;361                default:
000848  e1a00000          MOV      r0,r0
;;;362                    terninalPrintf(" <%08d> -> [OTHER] \r\n", i);
00084c  e1a01005          MOV      r1,r5
000850  e28f0f89          ADR      r0,|L1.2684|
000854  ebfffffe          BL       terninalPrintf
;;;363                    break;
000858  e1a00000          MOV      r0,r0
                  |L1.2140|
00085c  e1a00000          MOV      r0,r0                 ;333
000860  e2855001          ADD      r5,r5,#1              ;314
                  |L1.2148|
000864  e3550b01          CMP      r5,#0x400             ;314
000868  baffffa8          BLT      |L1.1808|
;;;364            }
;;;365        }
;;;366        terninalPrintf(" ##  total record number = %d, currentMaxIndex = %d, headerRecordIndex = %d, endRecordIndex = %d -- \r\n", SFLASH_RECORD_TOTAL_NUM, currentMaxIndex, headerRecordIndex, endRecordIndex);
00086c  e51f0188          LDR      r0,|L1.1772|
000870  e5900000          LDR      r0,[r0,#0]  ; endRecordIndex
000874  e58d0000          STR      r0,[sp,#0]
000878  e51f0198          LDR      r0,|L1.1768|
00087c  e5903000          LDR      r3,[r0,#0]  ; headerRecordIndex
000880  e51f01a4          LDR      r0,|L1.1764|
000884  e3a01b01          MOV      r1,#0x400
000888  e5902000          LDR      r2,[r0,#0]  ; currentMaxIndex
00088c  e59f0200          LDR      r0,|L1.2708|
000890  ebfffffe          BL       terninalPrintf
;;;367    }
000894  e28ddb02          ADD      sp,sp,#0x800
000898  e28dd014          ADD      sp,sp,#0x14
00089c  e8bd80f0          POP      {r4-r7,pc}
;;;368    static uint32_t getNextUseableRecordAddress(void)
                          ENDP

                  getNextUseableRecordAddress PROC
0008a0  e92d40f0          PUSH     {r4-r7,lr}
;;;369    {    
0008a4  e24ddf81          SUB      sp,sp,#0x204
;;;370        uint32_t addressTmp;
;;;371        int headerRecordIndexTmp;
;;;372        
;;;373        if(isFirstRecordInSector(headerRecordIndex))  
0008a8  e51f01c8          LDR      r0,|L1.1768|
0008ac  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
0008b0  ebfffffe          BL       isFirstRecordInSector
0008b4  e3500000          CMP      r0,#0
0008b8  0a00001a          BEQ      |L1.2344|
;;;374        {
;;;375            sysprintf(" -[ INFORMATION ]- getNextUseableRecordAddress [%d] need erase \r\n", headerRecordIndex);
0008bc  e51f01dc          LDR      r0,|L1.1768|
0008c0  e5901000          LDR      r1,[r0,#0]  ; headerRecordIndex
0008c4  e59f01cc          LDR      r0,|L1.2712|
0008c8  ebfffffe          BL       sysprintf
;;;376            FlashDrvSectorErase(SPI_FLASH_EX_0_INDEX, recordIndexToStartAddress(headerRecordIndex));
0008cc  e51f01ec          LDR      r0,|L1.1768|
0008d0  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
0008d4  ebfffffe          BL       recordIndexToStartAddress
0008d8  e1a05000          MOV      r5,r0
0008dc  e1a01005          MOV      r1,r5
0008e0  e3a00001          MOV      r0,#1
0008e4  ebfffffe          BL       FlashDrvSectorErase
;;;377            for(int i = 0; i < SFLASH_RECORD_NUM_PER_SECTOR ; i++)
0008e8  e3a05000          MOV      r5,#0
0008ec  ea00000b          B        |L1.2336|
                  |L1.2288|
;;;378            {
;;;379                int targetRecordIndex = i + headerRecordIndex;
0008f0  e51f0210          LDR      r0,|L1.1768|
0008f4  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
0008f8  e0856000          ADD      r6,r5,r0
;;;380                if(targetRecordIndex < SFLASH_RECORD_TOTAL_NUM)
0008fc  e3560b01          CMP      r6,#0x400
000900  aa000005          BGE      |L1.2332|
;;;381                {
;;;382                    currentStatus[targetRecordIndex] = SFLASH_RECORD_STATUS_EMPTY;
000904  e3a000ff          MOV      r0,#0xff
000908  e51f1230          LDR      r1,|L1.1760|
00090c  e7c10006          STRB     r0,[r1,r6]
;;;383                    sysprintf(" -[ INFORMATION ]- getNextUseableRecordAddress Set currentStatus[%d] = SFLASH_RECORD_STATUS_EMPTY  \r\n", targetRecordIndex);
000910  e1a01006          MOV      r1,r6
000914  e59f0180          LDR      r0,|L1.2716|
000918  ebfffffe          BL       sysprintf
                  |L1.2332|
00091c  e2855001          ADD      r5,r5,#1              ;377
                  |L1.2336|
000920  e3550002          CMP      r5,#2                 ;377
000924  bafffff1          BLT      |L1.2288|
                  |L1.2344|
;;;384                }  
;;;385            }
;;;386        } 
;;;387        headerRecordIndexTmp = headerRecordIndex;
000928  e51f0248          LDR      r0,|L1.1768|
00092c  e5904000          LDR      r4,[r0,#0]  ; headerRecordIndex
;;;388        while(currentStatus[headerRecordIndex] != SFLASH_RECORD_STATUS_EMPTY)
000930  ea000017          B        |L1.2452|
                  |L1.2356|
;;;389        {
;;;390            ++headerRecordIndex;
000934  e51f0254          LDR      r0,|L1.1768|
000938  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
00093c  e2800001          ADD      r0,r0,#1
000940  e51f1260          LDR      r1,|L1.1768|
000944  e5810000          STR      r0,[r1,#0]  ; headerRecordIndex
;;;391            headerRecordIndex = headerRecordIndex % SFLASH_RECORD_TOTAL_NUM;
000948  e5910000          LDR      r0,[r1,#0]  ; headerRecordIndex
00094c  e1a01fc0          ASR      r1,r0,#31
000950  e0801b21          ADD      r1,r0,r1,LSR #22
000954  e1a01541          ASR      r1,r1,#10
000958  e0401501          SUB      r1,r0,r1,LSL #10
00095c  e51f227c          LDR      r2,|L1.1768|
000960  e5821000          STR      r1,[r2,#0]  ; headerRecordIndex
;;;392            if(headerRecordIndexTmp == headerRecordIndex)
000964  e2820000          ADD      r0,r2,#0
000968  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
00096c  e1540000          CMP      r4,r0
000970  1a000007          BNE      |L1.2452|
;;;393            {
;;;394                #if(ENABLE_LOG_FUNCTION)
;;;395                {
;;;396                    char str[512];
;;;397                    sprintf(str, "**! INFORMATION !** S-Flash getNextUseableRecordAddress ERROR (headerRecordIndexTmp = %d)...\r\n", headerRecordIndexTmp);
000974  e1a02004          MOV      r2,r4
000978  e59f1120          LDR      r1,|L1.2720|
00097c  e28d0004          ADD      r0,sp,#4
000980  ebfffffe          BL       __2sprintf
;;;398                    LoglibPrintf(LOG_TYPE_ERROR, str);
000984  e28d1004          ADD      r1,sp,#4
000988  e3a00002          MOV      r0,#2
00098c  ebfffffe          BL       LoglibPrintf
;;;399                }
;;;400                #else
;;;401                sysprintf("**! INFORMATION !** S-Flash getNextUseableRecordAddress ERROR (headerRecordIndexTmp = %d)...\r\n", headerRecordIndexTmp);
;;;402                #endif
;;;403                break;
000990  ea000005          B        |L1.2476|
                  |L1.2452|
000994  e51f02bc          LDR      r0,|L1.1760|
000998  e51f12b8          LDR      r1,|L1.1768|
00099c  e5911000          LDR      r1,[r1,#0]            ;388  ; headerRecordIndex
0009a0  e7d00001          LDRB     r0,[r0,r1]            ;388
0009a4  e35000ff          CMP      r0,#0xff              ;388
0009a8  1affffe1          BNE      |L1.2356|
                  |L1.2476|
0009ac  e1a00000          MOV      r0,r0
;;;404            }
;;;405        }
;;;406        addressTmp = recordIndexToStartAddress(headerRecordIndex);
0009b0  e51f02d0          LDR      r0,|L1.1768|
0009b4  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
0009b8  ebfffffe          BL       recordIndexToStartAddress
0009bc  e1a07000          MOV      r7,r0
;;;407        sysprintf(" -[ INFORMATION ]- getNextUseableRecordAddress Get Target Record Index [%d][0x%04x] \r\n", headerRecordIndex, addressTmp);    
0009c0  e1a02007          MOV      r2,r7
0009c4  e51f02e4          LDR      r0,|L1.1768|
0009c8  e5901000          LDR      r1,[r0,#0]  ; headerRecordIndex
0009cc  e59f00d0          LDR      r0,|L1.2724|
0009d0  ebfffffe          BL       sysprintf
;;;408        ++headerRecordIndex;
0009d4  e51f02f4          LDR      r0,|L1.1768|
0009d8  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
0009dc  e2800001          ADD      r0,r0,#1
0009e0  e51f1300          LDR      r1,|L1.1768|
0009e4  e5810000          STR      r0,[r1,#0]  ; headerRecordIndex
;;;409        headerRecordIndex = headerRecordIndex % SFLASH_RECORD_TOTAL_NUM;
0009e8  e5910000          LDR      r0,[r1,#0]  ; headerRecordIndex
0009ec  e1a01fc0          ASR      r1,r0,#31
0009f0  e0801b21          ADD      r1,r0,r1,LSR #22
0009f4  e1a01541          ASR      r1,r1,#10
0009f8  e0401501          SUB      r1,r0,r1,LSL #10
0009fc  e51f231c          LDR      r2,|L1.1768|
000a00  e5821000          STR      r1,[r2,#0]  ; headerRecordIndex
;;;410        return addressTmp;  
000a04  e1a00007          MOV      r0,r7
000a08  e28ddf81          ADD      sp,sp,#0x204
;;;411    }
000a0c  e8bd80f0          POP      {r4-r7,pc}
                  |L1.2576|
000a10  203c2530          DCB      " <%08d> -> [EMPTY]\r\n",0
000a14  38643e20
000a18  2d3e205b
000a1c  454d5054
000a20  595d0d0a
000a24  00      
000a25  00                DCB      0
000a26  00                DCB      0
000a27  00                DCB      0
                  |L1.2600|
                          DCD      ||.constdata||+0x11c
                  |L1.2604|
000a2c  203c2530          DCB      " <%08d> -> [DATA] ERROR\r\n",0
000a30  38643e20
000a34  2d3e205b
000a38  44415441
000a3c  5d204552
000a40  524f520d
000a44  0a00    
000a46  00                DCB      0
000a47  00                DCB      0
                  |L1.2632|
                          DCD      ||.constdata||+0x16c
                  |L1.2636|
000a4c  203c2530          DCB      " <%08d> -> [BACKUP] ERROR\r\n",0
000a50  38643e20
000a54  2d3e205b
000a58  4241434b
000a5c  55505d20
000a60  4552524f
000a64  520d0a00
                  |L1.2664|
000a68  203c2530          DCB      " <%08d> -> [BAD] \r\n",0
000a6c  38643e20
000a70  2d3e205b
000a74  4241445d
000a78  200d0a00
                  |L1.2684|
000a7c  203c2530          DCB      " <%08d> -> [OTHER] \r\n",0
000a80  38643e20
000a84  2d3e205b
000a88  4f544845
000a8c  525d200d
000a90  0a00    
000a92  00                DCB      0
000a93  00                DCB      0
                  |L1.2708|
                          DCD      ||.constdata||+0x1bc
                  |L1.2712|
                          DCD      ||.constdata||+0x224
                  |L1.2716|
                          DCD      ||.constdata||+0x268
                  |L1.2720|
                          DCD      ||.constdata||+0x2d0
                  |L1.2724|
                          DCD      ||.constdata||+0x330
                          ENDP

                  getNextDataRecordAddress PROC
;;;412    
;;;413    static uint32_t getNextDataRecordAddress(void)
000aa8  e92d4010          PUSH     {r4,lr}
;;;414    {
;;;415        if(headerRecordIndex == -1)
000aac  e51f03cc          LDR      r0,|L1.1768|
000ab0  e5900000          LDR      r0,[r0,#0]  ; headerRecordIndex
000ab4  e3700001          CMN      r0,#1
000ab8  1a000001          BNE      |L1.2756|
;;;416        {
;;;417            //sysprintf(" -- getNextDataRecordAddress empty [%d]  \r\n", endRecordIndex);
;;;418            return 0xffffffff;
000abc  e3e00000          MVN      r0,#0
                  |L1.2752|
;;;419        }
;;;420            
;;;421        for(;;)
;;;422        {              
;;;423            //sysprintf(" -- getNextDataRecordAddress Check [%d: %d]:  0X%02X \r\n", endRecordIndex, headerRecordIndex, currentStatus[endRecordIndex]);
;;;424            switch(currentStatus[endRecordIndex]) 
;;;425            {
;;;426                case SFLASH_RECORD_STATUS_EMPTY:
;;;427                    break;
;;;428                
;;;429                case SFLASH_RECORD_STATUS_DATA:  
;;;430                    return recordIndexToStartAddress(endRecordIndex);
;;;431                    
;;;432                case SFLASH_RECORD_STATUS_BACKUP:
;;;433                    break;
;;;434                    
;;;435                case SFLASH_RECORD_STATUS_BAD:
;;;436                    break;
;;;437                    
;;;438                default:
;;;439                    //] scanL io
;;;440                    break;
;;;441            }
;;;442            if(endRecordIndex == headerRecordIndex)
;;;443            {
;;;444                //sysprintf(" -- getNextDataRecordAddress break [%d]  \r\n", endRecordIndex);
;;;445                return 0xffffffff;
;;;446            }
;;;447            ++endRecordIndex;
;;;448            endRecordIndex = endRecordIndex % SFLASH_RECORD_TOTAL_NUM;  
;;;449        }
;;;450    }
000ac0  e8bd8010          POP      {r4,pc}
                  |L1.2756|
000ac4  e1a00000          MOV      r0,r0                 ;421
                  |L1.2760|
000ac8  e51f03f0          LDR      r0,|L1.1760|
000acc  e51f13e8          LDR      r1,|L1.1772|
000ad0  e5911000          LDR      r1,[r1,#0]            ;424  ; endRecordIndex
000ad4  e7d00001          LDRB     r0,[r0,r1]            ;424
000ad8  e3500000          CMP      r0,#0                 ;424
000adc  0a00000d          BEQ      |L1.2840|
000ae0  e35000fc          CMP      r0,#0xfc              ;424
000ae4  0a000009          BEQ      |L1.2832|
000ae8  e35000fe          CMP      r0,#0xfe              ;424
000aec  0a000002          BEQ      |L1.2812|
000af0  e35000ff          CMP      r0,#0xff              ;424
000af4  1a000009          BNE      |L1.2848|
000af8  ea00000a          B        |L1.2856|
                  |L1.2812|
000afc  e1a00000          MOV      r0,r0                 ;429
000b00  e51f041c          LDR      r0,|L1.1772|
000b04  e5900000          LDR      r0,[r0,#0]            ;430  ; endRecordIndex
000b08  ebfffffe          BL       recordIndexToStartAddress
000b0c  eaffffeb          B        |L1.2752|
                  |L1.2832|
000b10  e1a00000          MOV      r0,r0                 ;432
000b14  ea000003          B        |L1.2856|
                  |L1.2840|
000b18  e1a00000          MOV      r0,r0                 ;435
000b1c  ea000001          B        |L1.2856|
                  |L1.2848|
000b20  e1a00000          MOV      r0,r0                 ;438
000b24  e1a00000          MOV      r0,r0                 ;440
                  |L1.2856|
000b28  e1a00000          MOV      r0,r0                 ;427
000b2c  e51f0448          LDR      r0,|L1.1772|
000b30  e5900000          LDR      r0,[r0,#0]            ;442  ; endRecordIndex
000b34  e51f1454          LDR      r1,|L1.1768|
000b38  e5911000          LDR      r1,[r1,#0]            ;442  ; headerRecordIndex
000b3c  e1500001          CMP      r0,r1                 ;442
000b40  1a000001          BNE      |L1.2892|
000b44  e3e00000          MVN      r0,#0                 ;445
000b48  eaffffdc          B        |L1.2752|
                  |L1.2892|
000b4c  e51f0468          LDR      r0,|L1.1772|
000b50  e5900000          LDR      r0,[r0,#0]            ;447  ; endRecordIndex
000b54  e2800001          ADD      r0,r0,#1              ;447
000b58  e51f1474          LDR      r1,|L1.1772|
000b5c  e5810000          STR      r0,[r1,#0]            ;447  ; endRecordIndex
000b60  e5910000          LDR      r0,[r1,#0]            ;448  ; endRecordIndex
000b64  e1a01fc0          ASR      r1,r0,#31             ;448
000b68  e0801b21          ADD      r1,r0,r1,LSR #22      ;448
000b6c  e1a01541          ASR      r1,r1,#10             ;448
000b70  e0401501          SUB      r1,r0,r1,LSL #10      ;448
000b74  e51f2490          LDR      r2,|L1.1772|
000b78  e5821000          STR      r1,[r2,#0]            ;448  ; endRecordIndex
000b7c  eaffffd1          B        |L1.2760|
;;;451    
                          ENDP

                  SFlashRecordInit PROC
;;;454    /*-----------------------------------------*/
;;;455    BOOL SFlashRecordInit(void)
000b80  e92d4010          PUSH     {r4,lr}
;;;456    {
;;;457        sysprintf("SFlashRecordInit!! ( start page = %d, RECORD_SIZE size = %d, sizeof(SFlashRecord) == %d) \r\n", SFLASH_RECORD_START_PAGE, SFLASH_RECORD_SIZE, sizeof(SFlashRecord));
000b84  e3a03b02          MOV      r3,#0x800
000b88  e1a02003          MOV      r2,r3
000b8c  e3a01000          MOV      r1,#0
000b90  e59f02b4          LDR      r0,|L1.3660|
000b94  ebfffffe          BL       sysprintf
;;;458        if(SFLASH_RECORD_SIZE != sizeof(SFlashRecord))
;;;459        {
;;;460            sysprintf("SFlashRecordInit ERROR !! (SFLASH_RECORD_SIZE != sizeof(SFlashRecord)) \r\n");
;;;461            return FALSE;
;;;462        }
;;;463        scanSFlash();
000b98  ebfffffe          BL       scanSFlash
;;;464        return TRUE;
000b9c  e3a00001          MOV      r0,#1
;;;465    }
000ba0  e8bd8010          POP      {r4,pc}
;;;466    void SFlashPrintfRecord(uint8_t* srcData)
                          ENDP

                  SFlashPrintfRecord PROC
000ba4  e92d43f8          PUSH     {r3-r9,lr}
;;;467    {
000ba8  e1a04000          MOV      r4,r0
;;;468        SFlashRecord* pSFlashRecord = (SFlashRecord*)srcData;
000bac  e1a05004          MOV      r5,r4
;;;469        SFlashRecordHeader* pSFlashRecordHeader = (SFlashRecordHeader*)&(pSFlashRecord->header); 
000bb0  e1a06005          MOV      r6,r5
;;;470        SFlashRecordEnd* pSFlashRecordEnd = (SFlashRecordEnd*)(SFlashRecordHeader*)&(pSFlashRecord->end); 
000bb4  e2857b01          ADD      r7,r5,#0x400
000bb8  e2877fff          ADD      r7,r7,#0x3fc
;;;471        
;;;472        sysprintf("SFlashPrintfRecord (%s) Header [0x%02x, 0x%02x] len = %d...\r\n", pSFlashRecord->name,  pSFlashRecordHeader->value[0], pSFlashRecordHeader->value[1], pSFlashRecordHeader->Len);
000bbc  e2860002          ADD      r0,r6,#2
000bc0  ebfffffe          BL       __aeabi_uread4
000bc4  e58d0000          STR      r0,[sp,#0]
000bc8  e5d63001          LDRB     r3,[r6,#1]
000bcc  e5d62000          LDRB     r2,[r6,#0]
000bd0  e2851c07          ADD      r1,r5,#0x700
000bd4  e28110b6          ADD      r1,r1,#0xb6
000bd8  e28f0e27          ADR      r0,|L1.3664|
000bdc  ebfffffe          BL       sysprintf
;;;473        sysprintf("SFlashPrintfRecord (%s) End [0x%02x, 0x%02x] checksum = 0x%04x...\r\n", pSFlashRecord->name, pSFlashRecordEnd->value[0], pSFlashRecordEnd->value[1], pSFlashRecordEnd->checksum);
000be0  e5d70001          LDRB     r0,[r7,#1]
000be4  e5d71000          LDRB     r1,[r7,#0]
000be8  e1810400          ORR      r0,r1,r0,LSL #8
000bec  e58d0000          STR      r0,[sp,#0]
000bf0  e5d73003          LDRB     r3,[r7,#3]
000bf4  e5d72002          LDRB     r2,[r7,#2]
000bf8  e2851c07          ADD      r1,r5,#0x700
000bfc  e28110b6          ADD      r1,r1,#0xb6
000c00  e59f0288          LDR      r0,|L1.3728|
000c04  ebfffffe          BL       sysprintf
;;;474        //printfBuffData(" [ SFlashPrintfRecord ] ", srcData + sizeof(SFlashRecordHeader), pSFlashRecordHeader->Len);
;;;475    }
000c08  e8bd83f8          POP      {r3-r9,pc}
;;;476    void SFlashListRecord(uint8_t flashIndex)
                          ENDP

                  SFlashListRecord PROC
000c0c  e92d4010          PUSH     {r4,lr}
;;;477    {
000c10  e1a04000          MOV      r4,r0
;;;478        setPrintfFlag(TRUE);
000c14  e3a00001          MOV      r0,#1
000c18  ebfffffe          BL       setPrintfFlag
;;;479        listSFlash(flashIndex);
000c1c  e1a00004          MOV      r0,r4
000c20  ebfffffe          BL       listSFlash
;;;480        setPrintfFlag(FALSE);
000c24  e3a00000          MOV      r0,#0
000c28  ebfffffe          BL       setPrintfFlag
;;;481    }
000c2c  e8bd8010          POP      {r4,pc}
;;;482    BOOL SFlashAppendRecord(char* name, uint8_t type, uint8_t* dataSrc, int dataSrcLen)
                          ENDP

                  SFlashAppendRecord PROC
000c30  e92d5fff          PUSH     {r0-r12,lr}
;;;483    {
000c34  e24dde81          SUB      sp,sp,#0x810
000c38  e1a08000          MOV      r8,r0
000c3c  e1a0b001          MOV      r11,r1
000c40  e1a09003          MOV      r9,r3
;;;484        uint32_t targetAddress;
;;;485        uint32_t targetRecordIndex;
;;;486        uint8_t data[SFLASH_RECORD_SIZE];
;;;487        SFlashRecord* pSFlashRecord = (SFlashRecord*)data;
000c44  e28d400c          ADD      r4,sp,#0xc
;;;488        SFlashRecordHeader* pSFlashRecordHeader = (SFlashRecordHeader*)&(pSFlashRecord->header); 
000c48  e1a05004          MOV      r5,r4
;;;489        SFlashRecordEnd* pSFlashRecordEnd = (SFlashRecordEnd*)&(pSFlashRecord->end); 
000c4c  e284ab01          ADD      r10,r4,#0x400
000c50  e28aafff          ADD      r10,r10,#0x3fc
;;;490    
;;;491        memset(data, 0xff, SFLASH_RECORD_SIZE);
000c54  e3a020ff          MOV      r2,#0xff
000c58  e3a01b02          MOV      r1,#0x800
000c5c  e28d000c          ADD      r0,sp,#0xc
000c60  ebfffffe          BL       __aeabi_memset
;;;492        
;;;493        pSFlashRecord->type = type;
000c64  e5c4b7f6          STRB     r11,[r4,#0x7f6]
;;;494    
;;;495        pSFlashRecordHeader->value[0] = SFLASH_HEADER_VALUE;
000c68  e3a000da          MOV      r0,#0xda
000c6c  e5c50000          STRB     r0,[r5,#0]
;;;496        pSFlashRecordHeader->value[1] = SFLASH_HEADER_VALUE2;
000c70  e3a000ad          MOV      r0,#0xad
000c74  e5c50001          STRB     r0,[r5,#1]
;;;497        pSFlashRecordHeader->Len = dataSrcLen;  
000c78  e2851002          ADD      r1,r5,#2
000c7c  e1a00009          MOV      r0,r9
000c80  ebfffffe          BL       __aeabi_uwrite4
;;;498    
;;;499        //memcpy(pSFlashRecord->data + sizeof(SFlashRecordHeader), dataSrc, dataSrcLen);
;;;500        memcpy(pSFlashRecord->data, dataSrc, dataSrcLen);
000c84  e1a02009          MOV      r2,r9
000c88  e2840006          ADD      r0,r4,#6
000c8c  e59d1818          LDR      r1,[sp,#0x818]
000c90  ebfffffe          BL       __aeabi_memcpy
;;;501    
;;;502        
;;;503        pSFlashRecordEnd->value[0] = SFLASH_END_VALUE;
000c94  e3a0001f          MOV      r0,#0x1f
000c98  e5ca0002          STRB     r0,[r10,#2]
;;;504        pSFlashRecordEnd->value[1] = SFLASH_END_VALUE2;
000c9c  e3a000f1          MOV      r0,#0xf1
000ca0  e5ca0003          STRB     r0,[r10,#3]
;;;505        
;;;506        pSFlashRecord->index = ++currentMaxIndex;
000ca4  e51f15c8          LDR      r1,|L1.1764|
000ca8  e5911000          LDR      r1,[r1,#0]  ; currentMaxIndex
000cac  e2811001          ADD      r1,r1,#1
000cb0  e51f25d4          LDR      r2,|L1.1764|
000cb4  e5821000          STR      r1,[r2,#0]  ; currentMaxIndex
000cb8  e1a00001          MOV      r0,r1
000cbc  e2841c07          ADD      r1,r4,#0x700
000cc0  e28110f7          ADD      r1,r1,#0xf7
000cc4  ebfffffe          BL       __aeabi_uwrite4
;;;507        
;;;508        if(strlen(name) > (SFLASH_RECORD_NAME_LEN-1))
000cc8  e1a00008          MOV      r0,r8
000ccc  ebfffffe          BL       strlen
000cd0  e350003f          CMP      r0,#0x3f
000cd4  9a000001          BLS      |L1.3296|
;;;509            name[SFLASH_RECORD_NAME_LEN-1] = 0x0;
000cd8  e3a00000          MOV      r0,#0
000cdc  e5c8003f          STRB     r0,[r8,#0x3f]
                  |L1.3296|
;;;510        
;;;511        strcpy((char*)(pSFlashRecord->name), name);
000ce0  e1a01008          MOV      r1,r8
000ce4  e2840c07          ADD      r0,r4,#0x700
000ce8  e28000b6          ADD      r0,r0,#0xb6
000cec  ebfffffe          BL       strcpy
;;;512    
;;;513        pSFlashRecord->status = SFLASH_RECORD_STATUS_DATA;
000cf0  e3a000fe          MOV      r0,#0xfe
000cf4  e5c407fb          STRB     r0,[r4,#0x7fb]
;;;514        
;;;515        pSFlashRecordEnd->checksum = getChecksum(data + sizeof(SFlashRecordHeader), SFLASH_RECORD_SIZE - sizeof(SFlashRecordHeader) - sizeof(SFlashRecordEnd) - sizeof(uint8_t), "<append>") ;
000cf8  e28f2f65          ADR      r2,|L1.3732|
000cfc  e51f16c0          LDR      r1,|L1.1604|
000d00  e28d0012          ADD      r0,sp,#0x12
000d04  ebfffffe          BL       getChecksum
000d08  e5ca0000          STRB     r0,[r10,#0]
000d0c  e1a00420          LSR      r0,r0,#8
000d10  e5ca0001          STRB     r0,[r10,#1]
;;;516      
;;;517        
;;;518        
;;;519        
;;;520    #if(SFLASH_DEBUG)
;;;521        SFlashPrintfRecord(data);
;;;522        printfBuffData("SFlashAppendRecord", data, SFLASH_RECORD_SIZE);
;;;523    #endif
;;;524        
;;;525        targetAddress = getNextUseableRecordAddress();
000d14  ebfffffe          BL       getNextUseableRecordAddress
000d18  e1a06000          MOV      r6,r0
;;;526        targetRecordIndex = targetAddress/SFLASH_RECORD_SIZE;
000d1c  e1a005a6          LSR      r0,r6,#11
000d20  e58d080c          STR      r0,[sp,#0x80c]
;;;527        //sysprintf(" [!! INFORMATION !!] SFlashAppendRecord targetAddress = 0x%04x, targetRecordIndex = %d \r\n", targetAddress, targetRecordIndex);
;;;528    
;;;529        for(int i = 0; i<SFLASH_RECORD_PAGE_SIZE_PER_RECORD; i++)
000d24  e3a07000          MOV      r7,#0
000d28  ea000006          B        |L1.3400|
                  |L1.3372|
;;;530        {
;;;531            FlashDrvPageProgram(SPI_FLASH_EX_0_INDEX, targetAddress + SPI_FLASH_EX_PAGE_SIZE*i, data + SPI_FLASH_EX_PAGE_SIZE*i, SPI_FLASH_EX_PAGE_SIZE);
000d2c  e28d000c          ADD      r0,sp,#0xc
000d30  e3a03c01          MOV      r3,#0x100
000d34  e0220793          MLA      r2,r3,r7,r0
000d38  e0216793          MLA      r1,r3,r7,r6
000d3c  e3a00001          MOV      r0,#1
000d40  ebfffffe          BL       FlashDrvPageProgram
000d44  e2877001          ADD      r7,r7,#1              ;529
                  |L1.3400|
000d48  e3570008          CMP      r7,#8                 ;529
000d4c  bafffff6          BLT      |L1.3372|
;;;532        }
;;;533        currentStatus[targetRecordIndex] = SFLASH_RECORD_STATUS_DATA;
000d50  e3a010fe          MOV      r1,#0xfe
000d54  e51f267c          LDR      r2,|L1.1760|
000d58  e59d080c          LDR      r0,[sp,#0x80c]
000d5c  e7c21000          STRB     r1,[r2,r0]
;;;534        //sysprintf(" [!! INFORMATION !!]  SFlashAppendRecord [%s](type:%d): record index %d (Data Index = %d) OK [headerRecordIndex = %d : endRecordIndex = %d]\r\n", name, type, targetRecordIndex, pSFlashRecord->index, headerRecordIndex, endRecordIndex);
;;;535        return TRUE;
000d60  e3a00001          MOV      r0,#1
000d64  e28dde82          ADD      sp,sp,#0x820
;;;536    }
000d68  e8bd9ff0          POP      {r4-r12,pc}
;;;537    int SFlashGetRecord(uint8_t** targetData, size_t* targetDataLen, char* fileName, uint8_t* type)
                          ENDP

                  SFlashGetRecord PROC
000d6c  e92d47f0          PUSH     {r4-r10,lr}
;;;538    {
000d70  e24dde81          SUB      sp,sp,#0x810
000d74  e1a05000          MOV      r5,r0
000d78  e1a06001          MOV      r6,r1
000d7c  e1a07002          MOV      r7,r2
000d80  e1a08003          MOV      r8,r3
;;;539        uint32_t targetAddress;
;;;540        uint8_t data[SFLASH_RECORD_SIZE];
;;;541        uint8_t* targetDataTmp;
;;;542        size_t targetDataLenTmp;
;;;543        SFlashRecord* pSFlashRecord = (SFlashRecord*)data;
000d84  e28d9010          ADD      r9,sp,#0x10
;;;544        while(1)
000d88  ea00002b          B        |L1.3644|
                  |L1.3468|
;;;545        {
;;;546            targetAddress = getNextDataRecordAddress();
000d8c  ebfffffe          BL       getNextDataRecordAddress
000d90  e1a04000          MOV      r4,r0
;;;547            //sysprintf("SFlashGetRecord targetAddress = 0x%04x \r\n", targetAddress);
;;;548            if(targetAddress != 0xffffffff)
000d94  e3740001          CMN      r4,#1
000d98  0a000026          BEQ      |L1.3640|
;;;549            {
;;;550                getEntireRecord(SPI_FLASH_EX_0_INDEX, targetAddress/SFLASH_RECORD_SIZE, data, sizeof(data));  
000d9c  e1a015a4          LSR      r1,r4,#11
000da0  e3a03b02          MOV      r3,#0x800
000da4  e28d2010          ADD      r2,sp,#0x10
000da8  e3a00001          MOV      r0,#1
000dac  ebfffffe          BL       getEntireRecord
;;;551                //process
;;;552                SFlashPrintfRecord(data);
000db0  e28d0010          ADD      r0,sp,#0x10
000db4  ebfffffe          BL       SFlashPrintfRecord
;;;553                if(checkEntireRecord(data, &targetDataTmp, &targetDataLenTmp))
000db8  e28d2008          ADD      r2,sp,#8
000dbc  e28d100c          ADD      r1,sp,#0xc
000dc0  e28d0010          ADD      r0,sp,#0x10
000dc4  ebfffffe          BL       checkEntireRecord
000dc8  e3500000          CMP      r0,#0
000dcc  0a000011          BEQ      |L1.3608|
;;;554                {
;;;555                    strcpy(fileName, (char*)pSFlashRecord->name);
000dd0  e2891c07          ADD      r1,r9,#0x700
000dd4  e28110b6          ADD      r1,r1,#0xb6
000dd8  e1a00007          MOV      r0,r7
000ddc  ebfffffe          BL       strcpy
;;;556                    *type = pSFlashRecord->type;
000de0  e5d907f6          LDRB     r0,[r9,#0x7f6]
000de4  e5c80000          STRB     r0,[r8,#0]
;;;557                    *targetData =  pvPortMalloc(targetDataLenTmp);
000de8  e59d0008          LDR      r0,[sp,#8]
000dec  ebfffffe          BL       pvPortMalloc
000df0  e5850000          STR      r0,[r5,#0]
;;;558                    memcpy(*targetData, targetDataTmp, targetDataLenTmp);
000df4  e5950000          LDR      r0,[r5,#0]
000df8  e59d100c          LDR      r1,[sp,#0xc]
000dfc  e59d2008          LDR      r2,[sp,#8]
000e00  ebfffffe          BL       __aeabi_memcpy
;;;559                    *targetDataLen = targetDataLenTmp;
000e04  e59d0008          LDR      r0,[sp,#8]
000e08  e5860000          STR      r0,[r6,#0]
;;;560                    //sysprintf(" [!! INFORMATION !!]  SFlashGetRecord : record index [ %d ] OK\r\n", targetAddress/SFLASH_RECORD_SIZE);
;;;561                    return targetAddress/SFLASH_RECORD_SIZE;
000e0c  e1a005a4          LSR      r0,r4,#11
                  |L1.3600|
000e10  e28dde81          ADD      sp,sp,#0x810
;;;562                }  
;;;563                else
;;;564                {
;;;565                    //sysprintf("SFlashGetRecord checkEntireRecord error [%d:%d]: Mark it to BAD \r\n", headerRecordIndex, endRecordIndex);
;;;566                    makeRecordStatus(SPI_FLASH_EX_0_INDEX, targetAddress/SFLASH_RECORD_SIZE, SFLASH_RECORD_STATUS_BAD);
;;;567                    currentStatus[targetAddress/SFLASH_RECORD_SIZE] = SFLASH_RECORD_STATUS_BAD;
;;;568                }
;;;569            }
;;;570            else
;;;571            {
;;;572                //sysprintf("SFlashGetRecord empty, ignore\r\n");  
;;;573                break;        
;;;574            }
;;;575        }
;;;576        return -1;
;;;577    }
000e14  e8bd87f0          POP      {r4-r10,pc}
                  |L1.3608|
000e18  e1a015a4          LSR      r1,r4,#11             ;566
000e1c  e3a02000          MOV      r2,#0                 ;566
000e20  e3a00001          MOV      r0,#1                 ;566
000e24  ebfffffe          BL       makeRecordStatus
000e28  e3a00000          MOV      r0,#0                 ;567
000e2c  e51f1754          LDR      r1,|L1.1760|
000e30  e7c105a4          STRB     r0,[r1,r4,LSR #11]    ;567
000e34  ea000000          B        |L1.3644|
                  |L1.3640|
000e38  ea000000          B        |L1.3648|
                  |L1.3644|
000e3c  eaffffd2          B        |L1.3468|
                  |L1.3648|
000e40  e1a00000          MOV      r0,r0                 ;573
000e44  e3e00000          MVN      r0,#0                 ;576
000e48  eafffff0          B        |L1.3600|
                  |L1.3660|
                          DCD      ||.constdata||+0x388
                  |L1.3664|
000e50  53466c61          DCB      "SFlashPrintfRecord (%s) Header [0x%02x, 0x%02x] len = %"
000e54  73685072
000e58  696e7466
000e5c  5265636f
000e60  72642028
000e64  25732920
000e68  48656164
000e6c  6572205b
000e70  30782530
000e74  32782c20
000e78  30782530
000e7c  32785d20
000e80  6c656e20
000e84  3d2025  
000e87  642e2e2e          DCB      "d...\r\n",0
000e8b  0d0a00  
000e8e  00                DCB      0
000e8f  00                DCB      0
                  |L1.3728|
                          DCD      ||.constdata||+0x3e4
                  |L1.3732|
000e94  3c617070          DCB      "<append>",0
000e98  656e643e
000e9c  00      
000e9d  00                DCB      0
000e9e  00                DCB      0
000e9f  00                DCB      0
                          ENDP

                  SFlashMarkRecordStatus PROC
;;;578    
;;;579    void SFlashMarkRecordStatus(int recordIndex, uint8_t status)
000ea0  e92d4070          PUSH     {r4-r6,lr}
;;;580    {
000ea4  e1a04000          MOV      r4,r0
000ea8  e1a05001          MOV      r5,r1
;;;581        //sysprintf(" [!! INFORMATION !!]  SFlashMarkRecordStatus : Mark record index [ %d ], status = 0x%02x \r\n", recordIndex, status);
;;;582        endRecordIndex = recordIndex + 1;
000eac  e2840001          ADD      r0,r4,#1
000eb0  e51f17cc          LDR      r1,|L1.1772|
000eb4  e5810000          STR      r0,[r1,#0]  ; endRecordIndex
;;;583        endRecordIndex = endRecordIndex % SFLASH_RECORD_TOTAL_NUM;
000eb8  e5910000          LDR      r0,[r1,#0]  ; endRecordIndex
000ebc  e1a01fc0          ASR      r1,r0,#31
000ec0  e0801b21          ADD      r1,r0,r1,LSR #22
000ec4  e1a01541          ASR      r1,r1,#10
000ec8  e0401501          SUB      r1,r0,r1,LSL #10
000ecc  e51f27e8          LDR      r2,|L1.1772|
000ed0  e5821000          STR      r1,[r2,#0]  ; endRecordIndex
;;;584        
;;;585        currentStatus[recordIndex] = status;
000ed4  e51f07fc          LDR      r0,|L1.1760|
000ed8  e7c05004          STRB     r5,[r0,r4]
;;;586        makeRecordStatus(SPI_FLASH_EX_0_INDEX, recordIndex, status);
000edc  e1a02005          MOV      r2,r5
000ee0  e1a01004          MOV      r1,r4
000ee4  e3a00001          MOV      r0,#1
000ee8  ebfffffe          BL       makeRecordStatus
;;;587    }
000eec  e8bd8070          POP      {r4-r6,pc}
;;;588    
                          ENDP

                  SFlashSaveStorage PROC
;;;589    
;;;590    BOOL SFlashSaveStorage(int storageId, uint8_t* dataSrc, int dataSrcLen)
000ef0  e92d4ff0          PUSH     {r4-r11,lr}
;;;591    {
000ef4  e24dda01          SUB      sp,sp,#0x1000
000ef8  e24dd004          SUB      sp,sp,#4
000efc  e1a04000          MOV      r4,r0
000f00  e1a0b001          MOV      r11,r1
000f04  e1a08002          MOV      r8,r2
;;;592        uint8_t data[SFLASH_STORAGE_SIZE];
;;;593        uint32_t targetAddress = (storageId * SFLASH_STORAGE_SIZE) + SFLASH_STORAGE_START_ADDRESS;
000f08  e3a00602          MOV      r0,#0x200000
000f0c  e0809604          ADD      r9,r0,r4,LSL #12
;;;594        
;;;595        SFlashStorage* pSFlashStorage = (SFlashStorage*)data;
000f10  e28d5004          ADD      r5,sp,#4
;;;596        SFlashStorageHeader* pSFlashStorageHeader = (SFlashStorageHeader*)&(pSFlashStorage->header); 
000f14  e1a06005          MOV      r6,r5
;;;597        SFlashStorageEnd* pSFlashStorageEnd = (SFlashStorageEnd*)&(pSFlashStorage->end); 
000f18  e285ab03          ADD      r10,r5,#0xc00
000f1c  e28aafff          ADD      r10,r10,#0x3fc
;;;598        
;;;599        memset(data, 0x00, SFLASH_STORAGE_SIZE);
000f20  e3a01a01          MOV      r1,#0x1000
000f24  e28d0004          ADD      r0,sp,#4
000f28  ebfffffe          BL       __aeabi_memclr4
;;;600        if(storageId >= SFLASH_STORAGE_TOTAL_NUM)
000f2c  e3540004          CMP      r4,#4
000f30  ba000007          BLT      |L1.3924|
;;;601        {
;;;602            sysprintf(" [!! INFORMATION !!] SFlashSaveStorage exceed storageId (%d >= %d) = 0x%04x \r\n", storageId, SFLASH_STORAGE_TOTAL_NUM);
000f34  e3a02004          MOV      r2,#4
000f38  e1a01004          MOV      r1,r4
000f3c  e59f0234          LDR      r0,|L1.4472|
000f40  ebfffffe          BL       sysprintf
;;;603            return FALSE;
000f44  e3a00000          MOV      r0,#0
                  |L1.3912|
000f48  e28dda01          ADD      sp,sp,#0x1000
000f4c  e28dd004          ADD      sp,sp,#4
;;;604        }
;;;605        if(dataSrcLen > SFLASH_STORAGE_DATA_LEN)
;;;606        {
;;;607            dataSrcLen = SFLASH_STORAGE_DATA_LEN;
;;;608        }
;;;609        
;;;610        pSFlashStorageHeader->value[0] = SFLASH_STORAGE_HEADER_VALUE;
;;;611        pSFlashStorageHeader->value[1] = SFLASH_STORAGE_HEADER_VALUE2;
;;;612        pSFlashStorageHeader->Len = dataSrcLen;  
;;;613    
;;;614        //memcpy(pSFlashRecord->data + sizeof(SFlashRecordHeader), dataSrc, dataSrcLen);
;;;615        memcpy(pSFlashStorage->data, dataSrc, dataSrcLen);
;;;616    
;;;617        
;;;618        pSFlashStorageEnd->value[0] = SFLASH_STORAGE_END_VALUE;
;;;619        pSFlashStorageEnd->value[1] = SFLASH_STORAGE_END_VALUE2;    
;;;620        pSFlashStorageEnd->checksum = getChecksum(data + sizeof(SFlashStorageHeader), SFLASH_STORAGE_SIZE - sizeof(SFlashStorageHeader) - sizeof(SFlashStorageEnd) - sizeof(uint8_t), "<SaveStorage>") ;
;;;621        
;;;622        
;;;623        //sysprintf(" [!! INFORMATION !!] SFlashSaveStorage(storageId = %d, dataSrcLen = %d) targetAddress = 0x%04x \r\n", storageId, dataSrcLen, targetAddress);
;;;624        FlashDrvSectorErase(SPI_FLASH_EX_0_INDEX, targetAddress);
;;;625        for(int i = 0; i<SFLASH_STORAGE_PAGE_SIZE_PER_RECORD; i++)
;;;626        {
;;;627            FlashDrvPageProgram(SPI_FLASH_EX_0_INDEX, targetAddress + SPI_FLASH_EX_PAGE_SIZE*i, data + SPI_FLASH_EX_PAGE_SIZE*i, SPI_FLASH_EX_PAGE_SIZE);
;;;628        }
;;;629        memset(data, 0x00, SFLASH_STORAGE_SIZE);
;;;630        FlashDrvNormalRead(SPI_FLASH_EX_0_INDEX, targetAddress, data, SFLASH_STORAGE_SIZE);
;;;631        if(memcmp(pSFlashStorage->data, dataSrc, dataSrcLen) == 0)
;;;632        {
;;;633            sysprintf(" [!! INFORMATION !!] SFlashSaveStorage(storageId = %d)  targetAddress = 0x%04x SUCCESS \r\n", storageId, targetAddress);
;;;634            return TRUE;
;;;635        }
;;;636        else
;;;637        {
;;;638            sysprintf(" [!! INFORMATION !!] SFlashSaveStorage(storageId = %d)  targetAddress = 0x%04x ERROR \r\n", storageId, targetAddress);
;;;639            return FALSE;
;;;640        }
;;;641        
;;;642        
;;;643    }
000f50  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.3924|
000f54  e59f0220          LDR      r0,|L1.4476|
000f58  e1580000          CMP      r8,r0                 ;605
000f5c  9a000000          BLS      |L1.3940|
000f60  e1a08000          MOV      r8,r0                 ;607
                  |L1.3940|
000f64  e3a000db          MOV      r0,#0xdb              ;610
000f68  e5c60000          STRB     r0,[r6,#0]            ;610
000f6c  e3a000bd          MOV      r0,#0xbd              ;611
000f70  e5c60001          STRB     r0,[r6,#1]            ;611
000f74  e2861002          ADD      r1,r6,#2              ;612
000f78  e1a00008          MOV      r0,r8                 ;612
000f7c  ebfffffe          BL       __aeabi_uwrite4
000f80  e1a02008          MOV      r2,r8                 ;615
000f84  e1a0100b          MOV      r1,r11                ;615
000f88  e2850006          ADD      r0,r5,#6              ;615
000f8c  ebfffffe          BL       __aeabi_memcpy
000f90  e3a0002f          MOV      r0,#0x2f              ;618
000f94  e5ca0002          STRB     r0,[r10,#2]           ;618
000f98  e3a000f2          MOV      r0,#0xf2              ;619
000f9c  e5ca0003          STRB     r0,[r10,#3]           ;619
000fa0  e28f2f76          ADR      r2,|L1.4480|
000fa4  e59f11e4          LDR      r1,|L1.4496|
000fa8  e28d000a          ADD      r0,sp,#0xa            ;620
000fac  ebfffffe          BL       getChecksum
000fb0  e5ca0000          STRB     r0,[r10,#0]           ;620
000fb4  e1a00420          LSR      r0,r0,#8              ;620
000fb8  e5ca0001          STRB     r0,[r10,#1]           ;620
000fbc  e1a01009          MOV      r1,r9                 ;624
000fc0  e3a00001          MOV      r0,#1                 ;624
000fc4  ebfffffe          BL       FlashDrvSectorErase
000fc8  e3a07000          MOV      r7,#0                 ;625
000fcc  ea000006          B        |L1.4076|
                  |L1.4048|
000fd0  e28d0004          ADD      r0,sp,#4              ;627
000fd4  e3a03c01          MOV      r3,#0x100             ;627
000fd8  e0220793          MLA      r2,r3,r7,r0           ;627
000fdc  e0219793          MLA      r1,r3,r7,r9           ;627
000fe0  e3a00001          MOV      r0,#1                 ;627
000fe4  ebfffffe          BL       FlashDrvPageProgram
000fe8  e2877001          ADD      r7,r7,#1              ;625
                  |L1.4076|
000fec  e3570010          CMP      r7,#0x10              ;625
000ff0  bafffff6          BLT      |L1.4048|
000ff4  e3a01a01          MOV      r1,#0x1000            ;629
000ff8  e28d0004          ADD      r0,sp,#4              ;629
000ffc  ebfffffe          BL       __aeabi_memclr4
001000  e3a03a01          MOV      r3,#0x1000            ;630
001004  e28d2004          ADD      r2,sp,#4              ;630
001008  e1a01009          MOV      r1,r9                 ;630
00100c  e3a00001          MOV      r0,#1                 ;630
001010  ebfffffe          BL       FlashDrvNormalRead
001014  e1a02008          MOV      r2,r8                 ;631
001018  e1a0100b          MOV      r1,r11                ;631
00101c  e2850006          ADD      r0,r5,#6              ;631
001020  ebfffffe          BL       memcmp
001024  e3500000          CMP      r0,#0                 ;631
001028  1a000005          BNE      |L1.4164|
00102c  e1a02009          MOV      r2,r9                 ;633
001030  e1a01004          MOV      r1,r4                 ;633
001034  e59f0158          LDR      r0,|L1.4500|
001038  ebfffffe          BL       sysprintf
00103c  e3a00001          MOV      r0,#1                 ;634
001040  eaffffc0          B        |L1.3912|
                  |L1.4164|
001044  e1a02009          MOV      r2,r9                 ;638
001048  e1a01004          MOV      r1,r4                 ;638
00104c  e59f0144          LDR      r0,|L1.4504|
001050  ebfffffe          BL       sysprintf
001054  e3a00000          MOV      r0,#0                 ;639
001058  eaffffba          B        |L1.3912|
;;;644    
                          ENDP

                  SFlashLoadStorage PROC
;;;645    BOOL SFlashLoadStorage(int storageId, uint8_t* dataSrc, int dataSrcLen)
00105c  e92d5ff0          PUSH     {r4-r12,lr}
;;;646    {
001060  e24ddd41          SUB      sp,sp,#0x1040
001064  e1a06000          MOV      r6,r0
001068  e1a08001          MOV      r8,r1
00106c  e1a09002          MOV      r9,r2
;;;647        uint8_t data[SFLASH_STORAGE_SIZE];
;;;648        uint32_t targetAddress = (storageId * SFLASH_STORAGE_SIZE) + SFLASH_STORAGE_START_ADDRESS;
001070  e3a00602          MOV      r0,#0x200000
001074  e080b606          ADD      r11,r0,r6,LSL #12
;;;649        
;;;650        SFlashStorage* pSFlashStorage = (SFlashStorage*)data;
001078  e28d7040          ADD      r7,sp,#0x40
;;;651        SFlashStorageHeader* pSFlashStorageHeader = (SFlashStorageHeader*)&(pSFlashStorage->header); 
00107c  e1a05007          MOV      r5,r7
;;;652        SFlashStorageEnd* pSFlashStorageEnd = (SFlashStorageEnd*)&(pSFlashStorage->end); 
001080  e2874b03          ADD      r4,r7,#0xc00
001084  e2844fff          ADD      r4,r4,#0x3fc
;;;653        
;;;654        memset(data, 0x00, SFLASH_STORAGE_SIZE);
001088  e3a01a01          MOV      r1,#0x1000
00108c  e28d0040          ADD      r0,sp,#0x40
001090  ebfffffe          BL       __aeabi_memclr4
;;;655            
;;;656        //sysprintf(" [!! INFORMATION !!] SFlashLoadStorage(storageId = %d, dataSrcLen = %d) targetAddress = 0x%04x \r\n", storageId, dataSrcLen, targetAddress);
;;;657        
;;;658        FlashDrvNormalRead(SPI_FLASH_EX_0_INDEX, targetAddress, data, SFLASH_STORAGE_SIZE);
001094  e3a03a01          MOV      r3,#0x1000
001098  e28d2040          ADD      r2,sp,#0x40
00109c  e1a0100b          MOV      r1,r11
0010a0  e3a00001          MOV      r0,#1
0010a4  ebfffffe          BL       FlashDrvNormalRead
;;;659        
;;;660        if(dataSrcLen > SFLASH_STORAGE_DATA_LEN)
0010a8  e59f00cc          LDR      r0,|L1.4476|
0010ac  e1590000          CMP      r9,r0
0010b0  9a000000          BLS      |L1.4280|
;;;661        {
;;;662            dataSrcLen = SFLASH_STORAGE_DATA_LEN;
0010b4  e1a09000          MOV      r9,r0
                  |L1.4280|
;;;663        }
;;;664        
;;;665        if((pSFlashStorageHeader->value[0] == SFLASH_STORAGE_HEADER_VALUE) && 
0010b8  e5d50000          LDRB     r0,[r5,#0]
0010bc  e35000db          CMP      r0,#0xdb
0010c0  1a000022          BNE      |L1.4432|
;;;666            (pSFlashStorageHeader->value[1] == SFLASH_STORAGE_HEADER_VALUE2))
0010c4  e5d50001          LDRB     r0,[r5,#1]
0010c8  e35000bd          CMP      r0,#0xbd
0010cc  1a00001f          BNE      |L1.4432|
;;;667                //&& pSFlashStorageHeader->Len == (srcDataLen-sizeof(SFlashStorageHeader) - sizeof(SFlashStorageEnd))) )       
;;;668        {
;;;669                //uint16_t checkSum = getChecksum(srcData + sizeof(SFlashStorageHeader), pSFlashStorageHeader->Len, "<parser>") ; 
;;;670                uint16_t checkSum = getChecksum(data + sizeof(SFlashStorageHeader), SFLASH_STORAGE_SIZE - sizeof(SFlashStorageHeader) - sizeof(SFlashStorageEnd) - sizeof(uint8_t), "<LoadStorage>") ; 
0010d0  e28f20c4          ADR      r2,|L1.4508|
0010d4  e59f10b4          LDR      r1,|L1.4496|
0010d8  e28d0046          ADD      r0,sp,#0x46
0010dc  ebfffffe          BL       getChecksum
0010e0  e1a0a000          MOV      r10,r0
;;;671                
;;;672                if((checkSum == pSFlashStorageEnd->checksum)  &&
0010e4  e5d40001          LDRB     r0,[r4,#1]
0010e8  e5d41000          LDRB     r1,[r4,#0]
0010ec  e1810400          ORR      r0,r1,r0,LSL #8
0010f0  e150000a          CMP      r0,r10
0010f4  1a00000c          BNE      |L1.4396|
;;;673                    (pSFlashStorageEnd->value[0] == SFLASH_STORAGE_END_VALUE) && 
0010f8  e5d40002          LDRB     r0,[r4,#2]
0010fc  e350002f          CMP      r0,#0x2f
001100  1a000009          BNE      |L1.4396|
;;;674                    (pSFlashStorageEnd->value[1] == SFLASH_STORAGE_END_VALUE2))
001104  e5d40003          LDRB     r0,[r4,#3]
001108  e35000f2          CMP      r0,#0xf2
00110c  1a000006          BNE      |L1.4396|
;;;675                {
;;;676                    memcpy(dataSrc, pSFlashStorage->data, dataSrcLen);
001110  e1a02009          MOV      r2,r9
001114  e2871006          ADD      r1,r7,#6
001118  e1a00008          MOV      r0,r8
00111c  ebfffffe          BL       __aeabi_memcpy
;;;677                    return TRUE;
001120  e3a00001          MOV      r0,#1
                  |L1.4388|
001124  e28ddd41          ADD      sp,sp,#0x1040
;;;678                }
;;;679                else
;;;680                {
;;;681                    terninalPrintf("\r\n checkEntireStorage End ERROR [0x%02x, 0x%02x] checkSum = %d (%d)...\r\n", pSFlashStorageEnd->value[0], pSFlashStorageEnd->value[1], pSFlashStorageEnd->checksum, checkSum);
;;;682                    #if(0)
;;;683                    printfBuffData("checkEntireStorage", dataSrc, SFLASH_STORAGE_SIZE);
;;;684                    #endif
;;;685                }
;;;686        }
;;;687        else
;;;688        {
;;;689            terninalPrintf("\r\n checkEntireStorage Header ERROR [0x%02x, 0x%02x] ...\r\n", pSFlashStorageHeader->value[0], pSFlashStorageHeader->value[1]);
;;;690            printfBuffData("checkEntireStorage", dataSrc, SFLASH_STORAGE_SIZE);
;;;691        }
;;;692        
;;;693        
;;;694        
;;;695        
;;;696        
;;;697        return FALSE;
;;;698    }
001128  e8bd9ff0          POP      {r4-r12,pc}
                  |L1.4396|
00112c  e58da000          STR      r10,[sp,#0]           ;681
001130  e5d40001          LDRB     r0,[r4,#1]            ;681
001134  e5d4c000          LDRB     r12,[r4,#0]           ;681
001138  e18c3400          ORR      r3,r12,r0,LSL #8      ;681
00113c  e5d42003          LDRB     r2,[r4,#3]            ;681
001140  e5d41002          LDRB     r1,[r4,#2]            ;681
001144  e59f0060          LDR      r0,|L1.4524|
001148  ebfffffe          BL       terninalPrintf
00114c  ea000007          B        |L1.4464|
                  |L1.4432|
001150  e5d52001          LDRB     r2,[r5,#1]            ;689
001154  e5d51000          LDRB     r1,[r5,#0]            ;689
001158  e28f0050          ADR      r0,|L1.4528|
00115c  ebfffffe          BL       terninalPrintf
001160  e3a02a01          MOV      r2,#0x1000            ;690
001164  e1a01008          MOV      r1,r8                 ;690
001168  e28f007c          ADR      r0,|L1.4588|
00116c  ebfffffe          BL       printfBuffData
                  |L1.4464|
001170  e3a00000          MOV      r0,#0                 ;697
001174  eaffffea          B        |L1.4388|
                  |L1.4472|
                          DCD      ||.constdata||+0x428
                  |L1.4476|
                          DCD      0x00000ff6
                  |L1.4480|
001180  3c536176          DCB      "<SaveStorage>",0
001184  6553746f
001188  72616765
00118c  3e00    
00118e  00                DCB      0
00118f  00                DCB      0
                  |L1.4496|
                          DCD      0x00000ff5
                  |L1.4500|
                          DCD      ||.constdata||+0x478
                  |L1.4504|
                          DCD      ||.constdata||+0x4d4
                  |L1.4508|
00119c  3c4c6f61          DCB      "<LoadStorage>",0
0011a0  6453746f
0011a4  72616765
0011a8  3e00    
0011aa  00                DCB      0
0011ab  00                DCB      0
                  |L1.4524|
                          DCD      ||.constdata||+0x52c
                  |L1.4528|
0011b0  0d0a2063          DCB      "\r\n checkEntireStorage Header ERROR [0x%02x, 0x%02x] ."
0011b4  6865636b
0011b8  456e7469
0011bc  72655374
0011c0  6f726167
0011c4  65204865
0011c8  61646572
0011cc  20455252
0011d0  4f52205b
0011d4  30782530
0011d8  32782c20
0011dc  30782530
0011e0  32785d20
0011e4  2e      
0011e5  2e2e0d0a          DCB      "..\r\n",0
0011e9  00      
0011ea  00                DCB      0
0011eb  00                DCB      0
                  |L1.4588|
0011ec  63686563          DCB      "checkEntireStorage",0
0011f0  6b456e74
0011f4  69726553
0011f8  746f7261
0011fc  676500  
0011ff  00                DCB      0
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  currentStatus
                          %        1024

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

000000  203e3e20          DCB      0x20,0x3e,0x3e,0x20
000004  67657445          DCB      0x67,0x65,0x74,0x45
000008  6e746972          DCB      0x6e,0x74,0x69,0x72
00000c  65526563          DCB      0x65,0x52,0x65,0x63
000010  6f726445          DCB      0x6f,0x72,0x64,0x45
000014  78204c65          DCB      0x78,0x20,0x4c,0x65
000018  6e206572          DCB      0x6e,0x20,0x65,0x72
00001c  726f7220          DCB      0x72,0x6f,0x72,0x20
000020  3a206461          DCB      0x3a,0x20,0x64,0x61
000024  74614c65          DCB      0x74,0x61,0x4c,0x65
000028  6e203d20          DCB      0x6e,0x20,0x3d,0x20
00002c  25642c20          DCB      0x25,0x64,0x2c,0x20
000030  53464c41          DCB      0x53,0x46,0x4c,0x41
000034  53485f52          DCB      0x53,0x48,0x5f,0x52
000038  45434f52          DCB      0x45,0x43,0x4f,0x52
00003c  445f5349          DCB      0x44,0x5f,0x53,0x49
000040  5a452a72          DCB      0x5a,0x45,0x2a,0x72
000044  65636f72          DCB      0x65,0x63,0x6f,0x72
000048  644e756d          DCB      0x64,0x4e,0x75,0x6d
00004c  203d2025          DCB      0x20,0x3d,0x20,0x25
000050  64200d0a          DCB      0x64,0x20,0x0d,0x0a
000054  00000000          DCB      0x00,0x00,0x00,0x00
000058  0d0a2063          DCB      0x0d,0x0a,0x20,0x63
00005c  6865636b          DCB      0x68,0x65,0x63,0x6b
000060  456e7469          DCB      0x45,0x6e,0x74,0x69
000064  72655265          DCB      0x72,0x65,0x52,0x65
000068  636f7264          DCB      0x63,0x6f,0x72,0x64
00006c  20456e64          DCB      0x20,0x45,0x6e,0x64
000070  20455252          DCB      0x20,0x45,0x52,0x52
000074  4f52205b          DCB      0x4f,0x52,0x20,0x5b
000078  30782530          DCB      0x30,0x78,0x25,0x30
00007c  32782c20          DCB      0x32,0x78,0x2c,0x20
000080  30782530          DCB      0x30,0x78,0x25,0x30
000084  32785d20          DCB      0x32,0x78,0x5d,0x20
000088  63686563          DCB      0x63,0x68,0x65,0x63
00008c  6b53756d          DCB      0x6b,0x53,0x75,0x6d
000090  203d2025          DCB      0x20,0x3d,0x20,0x25
000094  64202825          DCB      0x64,0x20,0x28,0x25
000098  64292e2e          DCB      0x64,0x29,0x2e,0x2e
00009c  2e0d0a00          DCB      0x2e,0x0d,0x0a,0x00
0000a0  0d0a2023          DCB      0x0d,0x0a,0x20,0x23
0000a4  21212123          DCB      0x21,0x21,0x21,0x23
0000a8  20736361          DCB      0x20,0x73,0x63,0x61
0000ac  6e53466c          DCB      0x6e,0x53,0x46,0x6c
0000b0  61736820          DCB      0x61,0x73,0x68,0x20
0000b4  454e443a          DCB      0x45,0x4e,0x44,0x3a
0000b8  20746f74          DCB      0x20,0x74,0x6f,0x74
0000bc  616c2072          DCB      0x61,0x6c,0x20,0x72
0000c0  65636f72          DCB      0x65,0x63,0x6f,0x72
0000c4  64206e75          DCB      0x64,0x20,0x6e,0x75
0000c8  6d626572          DCB      0x6d,0x62,0x65,0x72
0000cc  203d2025          DCB      0x20,0x3d,0x20,0x25
0000d0  642c2063          DCB      0x64,0x2c,0x20,0x63
0000d4  75727265          DCB      0x75,0x72,0x72,0x65
0000d8  6e744d61          DCB      0x6e,0x74,0x4d,0x61
0000dc  78496e64          DCB      0x78,0x49,0x6e,0x64
0000e0  6578203d          DCB      0x65,0x78,0x20,0x3d
0000e4  2025642c          DCB      0x20,0x25,0x64,0x2c
0000e8  20686561          DCB      0x20,0x68,0x65,0x61
0000ec  64657252          DCB      0x64,0x65,0x72,0x52
0000f0  65636f72          DCB      0x65,0x63,0x6f,0x72
0000f4  64496e64          DCB      0x64,0x49,0x6e,0x64
0000f8  6578203d          DCB      0x65,0x78,0x20,0x3d
0000fc  2025642c          DCB      0x20,0x25,0x64,0x2c
000100  20656e64          DCB      0x20,0x65,0x6e,0x64
000104  5265636f          DCB      0x52,0x65,0x63,0x6f
000108  7264496e          DCB      0x72,0x64,0x49,0x6e
00010c  64657820          DCB      0x64,0x65,0x78,0x20
000110  3d202564          DCB      0x3d,0x20,0x25,0x64
000114  202d2d20          DCB      0x20,0x2d,0x2d,0x20
000118  0d0a0000          DCB      0x0d,0x0a,0x00,0x00
00011c  203c2530          DCB      0x20,0x3c,0x25,0x30
000120  38643e20          DCB      0x38,0x64,0x3e,0x20
000124  2d3e205b          DCB      0x2d,0x3e,0x20,0x5b
000128  44415441          DCB      0x44,0x41,0x54,0x41
00012c  5d203a20          DCB      0x5d,0x20,0x3a,0x20
000130  696e6465          DCB      0x69,0x6e,0x64,0x65
000134  78203d20          DCB      0x78,0x20,0x3d,0x20
000138  25642c20          DCB      0x25,0x64,0x2c,0x20
00013c  6c656e20          DCB      0x6c,0x65,0x6e,0x20
000140  3d202564          DCB      0x3d,0x20,0x25,0x64
000144  2c206e61          DCB      0x2c,0x20,0x6e,0x61
000148  6d65203d          DCB      0x6d,0x65,0x20,0x3d
00014c  205b2573          DCB      0x20,0x5b,0x25,0x73
000150  5d200d0a          DCB      0x5d,0x20,0x0d,0x0a
000154  20202020          DCB      0x20,0x20,0x20,0x20
000158  20206461          DCB      0x20,0x20,0x64,0x61
00015c  7461203d          DCB      0x74,0x61,0x20,0x3d
000160  205b2573          DCB      0x20,0x5b,0x25,0x73
000164  5d200d0a          DCB      0x5d,0x20,0x0d,0x0a
000168  00000000          DCB      0x00,0x00,0x00,0x00
00016c  203c2530          DCB      0x20,0x3c,0x25,0x30
000170  38643e20          DCB      0x38,0x64,0x3e,0x20
000174  2d3e205b          DCB      0x2d,0x3e,0x20,0x5b
000178  4241434b          DCB      0x42,0x41,0x43,0x4b
00017c  55505d20          DCB      0x55,0x50,0x5d,0x20
000180  3a20696e          DCB      0x3a,0x20,0x69,0x6e
000184  64657820          DCB      0x64,0x65,0x78,0x20
000188  3d202564          DCB      0x3d,0x20,0x25,0x64
00018c  2c206c65          DCB      0x2c,0x20,0x6c,0x65
000190  6e203d20          DCB      0x6e,0x20,0x3d,0x20
000194  25642c20          DCB      0x25,0x64,0x2c,0x20
000198  6e616d65          DCB      0x6e,0x61,0x6d,0x65
00019c  203d205b          DCB      0x20,0x3d,0x20,0x5b
0001a0  25735d20          DCB      0x25,0x73,0x5d,0x20
0001a4  0d0a2020          DCB      0x0d,0x0a,0x20,0x20
0001a8  20202020          DCB      0x20,0x20,0x20,0x20
0001ac  64617461          DCB      0x64,0x61,0x74,0x61
0001b0  203d205b          DCB      0x20,0x3d,0x20,0x5b
0001b4  25735d20          DCB      0x25,0x73,0x5d,0x20
0001b8  0d0a0000          DCB      0x0d,0x0a,0x00,0x00
0001bc  20232320          DCB      0x20,0x23,0x23,0x20
0001c0  20746f74          DCB      0x20,0x74,0x6f,0x74
0001c4  616c2072          DCB      0x61,0x6c,0x20,0x72
0001c8  65636f72          DCB      0x65,0x63,0x6f,0x72
0001cc  64206e75          DCB      0x64,0x20,0x6e,0x75
0001d0  6d626572          DCB      0x6d,0x62,0x65,0x72
0001d4  203d2025          DCB      0x20,0x3d,0x20,0x25
0001d8  642c2063          DCB      0x64,0x2c,0x20,0x63
0001dc  75727265          DCB      0x75,0x72,0x72,0x65
0001e0  6e744d61          DCB      0x6e,0x74,0x4d,0x61
0001e4  78496e64          DCB      0x78,0x49,0x6e,0x64
0001e8  6578203d          DCB      0x65,0x78,0x20,0x3d
0001ec  2025642c          DCB      0x20,0x25,0x64,0x2c
0001f0  20686561          DCB      0x20,0x68,0x65,0x61
0001f4  64657252          DCB      0x64,0x65,0x72,0x52
0001f8  65636f72          DCB      0x65,0x63,0x6f,0x72
0001fc  64496e64          DCB      0x64,0x49,0x6e,0x64
000200  6578203d          DCB      0x65,0x78,0x20,0x3d
000204  2025642c          DCB      0x20,0x25,0x64,0x2c
000208  20656e64          DCB      0x20,0x65,0x6e,0x64
00020c  5265636f          DCB      0x52,0x65,0x63,0x6f
000210  7264496e          DCB      0x72,0x64,0x49,0x6e
000214  64657820          DCB      0x64,0x65,0x78,0x20
000218  3d202564          DCB      0x3d,0x20,0x25,0x64
00021c  202d2d20          DCB      0x20,0x2d,0x2d,0x20
000220  0d0a0000          DCB      0x0d,0x0a,0x00,0x00
000224  202d5b20          DCB      0x20,0x2d,0x5b,0x20
000228  494e464f          DCB      0x49,0x4e,0x46,0x4f
00022c  524d4154          DCB      0x52,0x4d,0x41,0x54
000230  494f4e20          DCB      0x49,0x4f,0x4e,0x20
000234  5d2d2067          DCB      0x5d,0x2d,0x20,0x67
000238  65744e65          DCB      0x65,0x74,0x4e,0x65
00023c  78745573          DCB      0x78,0x74,0x55,0x73
000240  6561626c          DCB      0x65,0x61,0x62,0x6c
000244  65526563          DCB      0x65,0x52,0x65,0x63
000248  6f726441          DCB      0x6f,0x72,0x64,0x41
00024c  64647265          DCB      0x64,0x64,0x72,0x65
000250  7373205b          DCB      0x73,0x73,0x20,0x5b
000254  25645d20          DCB      0x25,0x64,0x5d,0x20
000258  6e656564          DCB      0x6e,0x65,0x65,0x64
00025c  20657261          DCB      0x20,0x65,0x72,0x61
000260  7365200d          DCB      0x73,0x65,0x20,0x0d
000264  0a000000          DCB      0x0a,0x00,0x00,0x00
000268  202d5b20          DCB      0x20,0x2d,0x5b,0x20
00026c  494e464f          DCB      0x49,0x4e,0x46,0x4f
000270  524d4154          DCB      0x52,0x4d,0x41,0x54
000274  494f4e20          DCB      0x49,0x4f,0x4e,0x20
000278  5d2d2067          DCB      0x5d,0x2d,0x20,0x67
00027c  65744e65          DCB      0x65,0x74,0x4e,0x65
000280  78745573          DCB      0x78,0x74,0x55,0x73
000284  6561626c          DCB      0x65,0x61,0x62,0x6c
000288  65526563          DCB      0x65,0x52,0x65,0x63
00028c  6f726441          DCB      0x6f,0x72,0x64,0x41
000290  64647265          DCB      0x64,0x64,0x72,0x65
000294  73732053          DCB      0x73,0x73,0x20,0x53
000298  65742063          DCB      0x65,0x74,0x20,0x63
00029c  75727265          DCB      0x75,0x72,0x72,0x65
0002a0  6e745374          DCB      0x6e,0x74,0x53,0x74
0002a4  61747573          DCB      0x61,0x74,0x75,0x73
0002a8  5b25645d          DCB      0x5b,0x25,0x64,0x5d
0002ac  203d2053          DCB      0x20,0x3d,0x20,0x53
0002b0  464c4153          DCB      0x46,0x4c,0x41,0x53
0002b4  485f5245          DCB      0x48,0x5f,0x52,0x45
0002b8  434f5244          DCB      0x43,0x4f,0x52,0x44
0002bc  5f535441          DCB      0x5f,0x53,0x54,0x41
0002c0  5455535f          DCB      0x54,0x55,0x53,0x5f
0002c4  454d5054          DCB      0x45,0x4d,0x50,0x54
0002c8  5920200d          DCB      0x59,0x20,0x20,0x0d
0002cc  0a000000          DCB      0x0a,0x00,0x00,0x00
0002d0  2a2a2120          DCB      0x2a,0x2a,0x21,0x20
0002d4  494e464f          DCB      0x49,0x4e,0x46,0x4f
0002d8  524d4154          DCB      0x52,0x4d,0x41,0x54
0002dc  494f4e20          DCB      0x49,0x4f,0x4e,0x20
0002e0  212a2a20          DCB      0x21,0x2a,0x2a,0x20
0002e4  532d466c          DCB      0x53,0x2d,0x46,0x6c
0002e8  61736820          DCB      0x61,0x73,0x68,0x20
0002ec  6765744e          DCB      0x67,0x65,0x74,0x4e
0002f0  65787455          DCB      0x65,0x78,0x74,0x55
0002f4  73656162          DCB      0x73,0x65,0x61,0x62
0002f8  6c655265          DCB      0x6c,0x65,0x52,0x65
0002fc  636f7264          DCB      0x63,0x6f,0x72,0x64
000300  41646472          DCB      0x41,0x64,0x64,0x72
000304  65737320          DCB      0x65,0x73,0x73,0x20
000308  4552524f          DCB      0x45,0x52,0x52,0x4f
00030c  52202868          DCB      0x52,0x20,0x28,0x68
000310  65616465          DCB      0x65,0x61,0x64,0x65
000314  72526563          DCB      0x72,0x52,0x65,0x63
000318  6f726449          DCB      0x6f,0x72,0x64,0x49
00031c  6e646578          DCB      0x6e,0x64,0x65,0x78
000320  546d7020          DCB      0x54,0x6d,0x70,0x20
000324  3d202564          DCB      0x3d,0x20,0x25,0x64
000328  292e2e2e          DCB      0x29,0x2e,0x2e,0x2e
00032c  0d0a0000          DCB      0x0d,0x0a,0x00,0x00
000330  202d5b20          DCB      0x20,0x2d,0x5b,0x20
000334  494e464f          DCB      0x49,0x4e,0x46,0x4f
000338  524d4154          DCB      0x52,0x4d,0x41,0x54
00033c  494f4e20          DCB      0x49,0x4f,0x4e,0x20
000340  5d2d2067          DCB      0x5d,0x2d,0x20,0x67
000344  65744e65          DCB      0x65,0x74,0x4e,0x65
000348  78745573          DCB      0x78,0x74,0x55,0x73
00034c  6561626c          DCB      0x65,0x61,0x62,0x6c
000350  65526563          DCB      0x65,0x52,0x65,0x63
000354  6f726441          DCB      0x6f,0x72,0x64,0x41
000358  64647265          DCB      0x64,0x64,0x72,0x65
00035c  73732047          DCB      0x73,0x73,0x20,0x47
000360  65742054          DCB      0x65,0x74,0x20,0x54
000364  61726765          DCB      0x61,0x72,0x67,0x65
000368  74205265          DCB      0x74,0x20,0x52,0x65
00036c  636f7264          DCB      0x63,0x6f,0x72,0x64
000370  20496e64          DCB      0x20,0x49,0x6e,0x64
000374  6578205b          DCB      0x65,0x78,0x20,0x5b
000378  25645d5b          DCB      0x25,0x64,0x5d,0x5b
00037c  30782530          DCB      0x30,0x78,0x25,0x30
000380  34785d20          DCB      0x34,0x78,0x5d,0x20
000384  0d0a0000          DCB      0x0d,0x0a,0x00,0x00
000388  53466c61          DCB      0x53,0x46,0x6c,0x61
00038c  73685265          DCB      0x73,0x68,0x52,0x65
000390  636f7264          DCB      0x63,0x6f,0x72,0x64
000394  496e6974          DCB      0x49,0x6e,0x69,0x74
000398  21212028          DCB      0x21,0x21,0x20,0x28
00039c  20737461          DCB      0x20,0x73,0x74,0x61
0003a0  72742070          DCB      0x72,0x74,0x20,0x70
0003a4  61676520          DCB      0x61,0x67,0x65,0x20
0003a8  3d202564          DCB      0x3d,0x20,0x25,0x64
0003ac  2c205245          DCB      0x2c,0x20,0x52,0x45
0003b0  434f5244          DCB      0x43,0x4f,0x52,0x44
0003b4  5f53495a          DCB      0x5f,0x53,0x49,0x5a
0003b8  45207369          DCB      0x45,0x20,0x73,0x69
0003bc  7a65203d          DCB      0x7a,0x65,0x20,0x3d
0003c0  2025642c          DCB      0x20,0x25,0x64,0x2c
0003c4  2073697a          DCB      0x20,0x73,0x69,0x7a
0003c8  656f6628          DCB      0x65,0x6f,0x66,0x28
0003cc  53466c61          DCB      0x53,0x46,0x6c,0x61
0003d0  73685265          DCB      0x73,0x68,0x52,0x65
0003d4  636f7264          DCB      0x63,0x6f,0x72,0x64
0003d8  29203d3d          DCB      0x29,0x20,0x3d,0x3d
0003dc  20256429          DCB      0x20,0x25,0x64,0x29
0003e0  200d0a00          DCB      0x20,0x0d,0x0a,0x00
0003e4  53466c61          DCB      0x53,0x46,0x6c,0x61
0003e8  73685072          DCB      0x73,0x68,0x50,0x72
0003ec  696e7466          DCB      0x69,0x6e,0x74,0x66
0003f0  5265636f          DCB      0x52,0x65,0x63,0x6f
0003f4  72642028          DCB      0x72,0x64,0x20,0x28
0003f8  25732920          DCB      0x25,0x73,0x29,0x20
0003fc  456e6420          DCB      0x45,0x6e,0x64,0x20
000400  5b307825          DCB      0x5b,0x30,0x78,0x25
000404  3032782c          DCB      0x30,0x32,0x78,0x2c
000408  20307825          DCB      0x20,0x30,0x78,0x25
00040c  3032785d          DCB      0x30,0x32,0x78,0x5d
000410  20636865          DCB      0x20,0x63,0x68,0x65
000414  636b7375          DCB      0x63,0x6b,0x73,0x75
000418  6d203d20          DCB      0x6d,0x20,0x3d,0x20
00041c  30782530          DCB      0x30,0x78,0x25,0x30
000420  34782e2e          DCB      0x34,0x78,0x2e,0x2e
000424  2e0d0a00          DCB      0x2e,0x0d,0x0a,0x00
000428  205b2121          DCB      0x20,0x5b,0x21,0x21
00042c  20494e46          DCB      0x20,0x49,0x4e,0x46
000430  4f524d41          DCB      0x4f,0x52,0x4d,0x41
000434  54494f4e          DCB      0x54,0x49,0x4f,0x4e
000438  2021215d          DCB      0x20,0x21,0x21,0x5d
00043c  2053466c          DCB      0x20,0x53,0x46,0x6c
000440  61736853          DCB      0x61,0x73,0x68,0x53
000444  61766553          DCB      0x61,0x76,0x65,0x53
000448  746f7261          DCB      0x74,0x6f,0x72,0x61
00044c  67652065          DCB      0x67,0x65,0x20,0x65
000450  78636565          DCB      0x78,0x63,0x65,0x65
000454  64207374          DCB      0x64,0x20,0x73,0x74
000458  6f726167          DCB      0x6f,0x72,0x61,0x67
00045c  65496420          DCB      0x65,0x49,0x64,0x20
000460  28256420          DCB      0x28,0x25,0x64,0x20
000464  3e3d2025          DCB      0x3e,0x3d,0x20,0x25
000468  6429203d          DCB      0x64,0x29,0x20,0x3d
00046c  20307825          DCB      0x20,0x30,0x78,0x25
000470  30347820          DCB      0x30,0x34,0x78,0x20
000474  0d0a0000          DCB      0x0d,0x0a,0x00,0x00
000478  205b2121          DCB      0x20,0x5b,0x21,0x21
00047c  20494e46          DCB      0x20,0x49,0x4e,0x46
000480  4f524d41          DCB      0x4f,0x52,0x4d,0x41
000484  54494f4e          DCB      0x54,0x49,0x4f,0x4e
000488  2021215d          DCB      0x20,0x21,0x21,0x5d
00048c  2053466c          DCB      0x20,0x53,0x46,0x6c
000490  61736853          DCB      0x61,0x73,0x68,0x53
000494  61766553          DCB      0x61,0x76,0x65,0x53
000498  746f7261          DCB      0x74,0x6f,0x72,0x61
00049c  67652873          DCB      0x67,0x65,0x28,0x73
0004a0  746f7261          DCB      0x74,0x6f,0x72,0x61
0004a4  67654964          DCB      0x67,0x65,0x49,0x64
0004a8  203d2025          DCB      0x20,0x3d,0x20,0x25
0004ac  64292020          DCB      0x64,0x29,0x20,0x20
0004b0  74617267          DCB      0x74,0x61,0x72,0x67
0004b4  65744164          DCB      0x65,0x74,0x41,0x64
0004b8  64726573          DCB      0x64,0x72,0x65,0x73
0004bc  73203d20          DCB      0x73,0x20,0x3d,0x20
0004c0  30782530          DCB      0x30,0x78,0x25,0x30
0004c4  34782053          DCB      0x34,0x78,0x20,0x53
0004c8  55434345          DCB      0x55,0x43,0x43,0x45
0004cc  5353200d          DCB      0x53,0x53,0x20,0x0d
0004d0  0a000000          DCB      0x0a,0x00,0x00,0x00
0004d4  205b2121          DCB      0x20,0x5b,0x21,0x21
0004d8  20494e46          DCB      0x20,0x49,0x4e,0x46
0004dc  4f524d41          DCB      0x4f,0x52,0x4d,0x41
0004e0  54494f4e          DCB      0x54,0x49,0x4f,0x4e
0004e4  2021215d          DCB      0x20,0x21,0x21,0x5d
0004e8  2053466c          DCB      0x20,0x53,0x46,0x6c
0004ec  61736853          DCB      0x61,0x73,0x68,0x53
0004f0  61766553          DCB      0x61,0x76,0x65,0x53
0004f4  746f7261          DCB      0x74,0x6f,0x72,0x61
0004f8  67652873          DCB      0x67,0x65,0x28,0x73
0004fc  746f7261          DCB      0x74,0x6f,0x72,0x61
000500  67654964          DCB      0x67,0x65,0x49,0x64
000504  203d2025          DCB      0x20,0x3d,0x20,0x25
000508  64292020          DCB      0x64,0x29,0x20,0x20
00050c  74617267          DCB      0x74,0x61,0x72,0x67
000510  65744164          DCB      0x65,0x74,0x41,0x64
000514  64726573          DCB      0x64,0x72,0x65,0x73
000518  73203d20          DCB      0x73,0x20,0x3d,0x20
00051c  30782530          DCB      0x30,0x78,0x25,0x30
000520  34782045          DCB      0x34,0x78,0x20,0x45
000524  52524f52          DCB      0x52,0x52,0x4f,0x52
000528  200d0a00          DCB      0x20,0x0d,0x0a,0x00
00052c  0d0a2063          DCB      0x0d,0x0a,0x20,0x63
000530  6865636b          DCB      0x68,0x65,0x63,0x6b
000534  456e7469          DCB      0x45,0x6e,0x74,0x69
000538  72655374          DCB      0x72,0x65,0x53,0x74
00053c  6f726167          DCB      0x6f,0x72,0x61,0x67
000540  6520456e          DCB      0x65,0x20,0x45,0x6e
000544  64204552          DCB      0x64,0x20,0x45,0x52
000548  524f5220          DCB      0x52,0x4f,0x52,0x20
00054c  5b307825          DCB      0x5b,0x30,0x78,0x25
000550  3032782c          DCB      0x30,0x32,0x78,0x2c
000554  20307825          DCB      0x20,0x30,0x78,0x25
000558  3032785d          DCB      0x30,0x32,0x78,0x5d
00055c  20636865          DCB      0x20,0x63,0x68,0x65
000560  636b5375          DCB      0x63,0x6b,0x53,0x75
000564  6d203d20          DCB      0x6d,0x20,0x3d,0x20
000568  25642028          DCB      0x25,0x64,0x20,0x28
00056c  2564292e          DCB      0x25,0x64,0x29,0x2e
000570  2e2e0d0a          DCB      0x2e,0x2e,0x0d,0x0a
000574  00                DCB      0x00

                          AREA ||.data||, DATA, ALIGN=2

                  currentMaxIndex
                          DCD      0x00000000
                  headerRecordIndex
                          DCD      0x00000000
                  endRecordIndex
                          DCD      0xffffffff
