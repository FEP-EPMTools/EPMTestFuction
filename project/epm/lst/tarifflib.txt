; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--c99 --list --debug -c --asm --interleave -o.\obj\tarifflib.o --asm_dir=.\lst\ --list_dir=.\lst\ --depend=.\obj\tarifflib.d --cpu=ARM926EJ-S --apcs=interwork -O0 -I.\src -I..\..\common\src\BSP\Driver\Include -I..\..\common\src\FreeRTOS -I..\..\common\src\FreeRTOS\Source\include -I..\..\common\src\FreeRTOS\Source\portable\RVDS\ARM926EJ-S -I..\..\common\src\BSP\ThirdParty\FATFS\src -I.\src\userdrv -I.\src\syshal -I.\src\user -I.\src\userdrv\vl53l0x\core\inc -I.\src\userdrv\vl53l0x\platform\inc -I.\src\syshal\json -I.\src\syshal\modemlib -I..\..\common\src\BSP\ThirdParty\yaffs2 -I..\..\common\src\BSP\ThirdParty\yaffs2\include -I..\..\common\src\BSP\ThirdParty\yaffs2\include\asm -I..\..\common\src\BSP\ThirdParty\yaffs2\include\linux -I.\src\syshal\yaffs2 -I..\..\common\src\BSP\Library\SmartcardLib\Include -I.\src\syshal\cardlib -I.\src\syshal\cardlog -I.\src\syshal\blk -I..\..\common\src\BSP\Library\USB_HOST\Inc -I..\..\common\src\BSP\Library\USB_HOST\Inc\usb_uvc -IC:\Keil\ARM\RV31\INC -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\Inc\Toshiba -DEPM_PROJECT -DCONFIG_YAFFS_DIRECT -DCONFIG_YAFFS_SHORT_NAMES_IN_RAM -DCONFIG_YAFFS_YAFFS2 -DNO_Y_INLINE -DCONFIG_YAFFS_PROVIDE_DEFS -DCONFIG_YAFFSFS_PROVIDE_VALUES --omf_browse=.\obj\tarifflib.crf src\syshal\tarifflib.c]
                          ARM

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  compare PROC
;;;48     /*-----------------------------------------*/
;;;49     static int compare(const void *arg1, const void *arg2) 
000000  e1a02000          MOV      r2,r0
;;;50     {
;;;51         
;;;52         return  (*(int *)arg1 - *(int *)arg2);
000004  e5920000          LDR      r0,[r2,#0]
000008  e5913000          LDR      r3,[r1,#0]
00000c  e0400003          SUB      r0,r0,r3
;;;53     }
000010  e12fff1e          BX       lr
;;;54     
                          ENDP

                  sortTariffFile PROC
;;;55     
;;;56     static void sortTariffFile(void)
000014  e92d4010          PUSH     {r4,lr}
;;;57     {
;;;58         //int i;
;;;59         //for(i = 0; i<TARIFF_FILE_NUM; i++)
;;;60         //{
;;;61         //    sysprintf(" > sortTariffFile before [%d]: [%d] \r\n", i, tariffEffectiveDate[i]);
;;;62         //}
;;;63         qsort((void *)tariffEffectiveDate, TARIFF_FILE_NUM, sizeof(int), compare);
000018  e59f31d8          LDR      r3,|L1.504|
00001c  e3a02004          MOV      r2,#4
000020  e3a01003          MOV      r1,#3
000024  e59f01d0          LDR      r0,|L1.508|
000028  ebfffffe          BL       qsort
;;;64         //for(i = 0; i<TARIFF_FILE_NUM; i++)
;;;65         //{
;;;66         //    sysprintf(" > sortTariffFile after [%d]: [%d] \r\n", i, tariffEffectiveDate[i]);
;;;67         //}
;;;68     }
00002c  e8bd8010          POP      {r4,pc}
;;;69     
                          ENDP

                  selectTariffFile PROC
;;;70     static BOOL selectTariffFile(void)
000030  e92d4070          PUSH     {r4-r6,lr}
;;;71     {
000034  e24dd038          SUB      sp,sp,#0x38
;;;72         int i;
;;;73         RTC_TIME_DATA_T pt;
;;;74         currentTariffFileIndex = 0xff;
000038  e3a000ff          MOV      r0,#0xff
00003c  e59f11bc          LDR      r1,|L1.512|
000040  e5810000          STR      r0,[r1,#0]  ; currentTariffFileIndex
;;;75         if(E_RTC_SUCCESS == RTC_Read(RTC_CURRENT_TIME, &pt))
000044  e28d1008          ADD      r1,sp,#8
000048  e3a00000          MOV      r0,#0
00004c  ebfffffe          BL       RTC_Read
000050  e3500000          CMP      r0,#0
000054  1a000054          BNE      |L1.428|
;;;76         {
;;;77             int targetDate = pt.u32Year * 10000 + pt.u32cMonth * 100 + pt.u32cDay;
000058  e59d0024          LDR      r0,[sp,#0x24]
00005c  e59f11a0          LDR      r1,|L1.516|
000060  e0010190          MUL      r1,r0,r1
000064  e59d0020          LDR      r0,[sp,#0x20]
000068  e0802180          ADD      r2,r0,r0,LSL #3
00006c  e0820200          ADD      r0,r2,r0,LSL #4
000070  e0810100          ADD      r0,r1,r0,LSL #2
000074  e59d101c          LDR      r1,[sp,#0x1c]
000078  e0806001          ADD      r6,r0,r1
;;;78             int targetDateTmp = 0;;
00007c  e3a05000          MOV      r5,#0
;;;79             for(i = 0; i<TARIFF_FILE_NUM; i++)
000080  e3a04000          MOV      r4,#0
000084  ea00001d          B        |L1.256|
                  |L1.136|
;;;80             {
;;;81                 sysprintf(" > selectTariffFile check [%d]: [%d:%d] \r\n", i, tariffEffectiveDate[i], targetDate);
000088  e59f016c          LDR      r0,|L1.508|
00008c  e7902104          LDR      r2,[r0,r4,LSL #2]
000090  e1a03006          MOV      r3,r6
000094  e1a01004          MOV      r1,r4
000098  e28f0f5a          ADR      r0,|L1.520|
00009c  ebfffffe          BL       sysprintf
;;;82                 if(targetDate < tariffEffectiveDate[i])
0000a0  e59f0154          LDR      r0,|L1.508|
0000a4  e7900104          LDR      r0,[r0,r4,LSL #2]
0000a8  e1500006          CMP      r0,r6
0000ac  da000012          BLE      |L1.252|
;;;83                 {
;;;84                     if(i == 0)
0000b0  e3540000          CMP      r4,#0
0000b4  1a000008          BNE      |L1.220|
;;;85                     {
;;;86                         sysprintf(" > selectTariffFile ERROR [%d]: [%d:%d] \r\n", i, tariffEffectiveDate[i], targetDate);
0000b8  e59f013c          LDR      r0,|L1.508|
0000bc  e7902104          LDR      r2,[r0,r4,LSL #2]
0000c0  e1a03006          MOV      r3,r6
0000c4  e1a01004          MOV      r1,r4
0000c8  e28f0f59          ADR      r0,|L1.564|
0000cc  ebfffffe          BL       sysprintf
;;;87                         return FALSE;
0000d0  e3a00000          MOV      r0,#0
                  |L1.212|
0000d4  e28dd038          ADD      sp,sp,#0x38
;;;88                     }
;;;89                     else
;;;90                     {
;;;91                         targetDateTmp = tariffEffectiveDate[i-1];
;;;92                         sysprintf(" > selectTariffFile get date [%d]: [%d] \r\n", i, targetDateTmp);
;;;93                         break;
;;;94                     }
;;;95                 }
;;;96             }
;;;97             if((i == TARIFF_FILE_NUM) || (targetDateTmp == 0))
;;;98             {
;;;99                 sysprintf(" > selectTariffFile get date_2 [%d]: [%d] \r\n", i, targetDateTmp);
;;;100                targetDateTmp = tariffEffectiveDate[i-1];
;;;101            }
;;;102            for(i = 0; i<TARIFF_FILE_NUM; i++)
;;;103            {
;;;104                //sysprintf(" > selectTariffFile compare [%d]: [%d:%d] \r\n", i, jsonTariff[i].effectivetime, targetDateTmp);
;;;105                if(targetDateTmp == jsonTariff[i].effectivetime)
;;;106                {
;;;107                    sysprintf(" > selectTariffFile get it [%d][%s]: [%d:%d] \r\n", i, jsonTariff[i].name, jsonTariff[i].effectivetime, targetDateTmp);
;;;108                    currentTariffFileIndex = i;
;;;109                    return TRUE;
;;;110                }
;;;111            }
;;;112            
;;;113        }
;;;114        return FALSE;
;;;115    }
0000d8  e8bd8070          POP      {r4-r6,pc}
                  |L1.220|
0000dc  e2440001          SUB      r0,r4,#1              ;91
0000e0  e59f1114          LDR      r1,|L1.508|
0000e4  e7915100          LDR      r5,[r1,r0,LSL #2]     ;91
0000e8  e1a02005          MOV      r2,r5                 ;92
0000ec  e1a01004          MOV      r1,r4                 ;92
0000f0  e28f0f5a          ADR      r0,|L1.608|
0000f4  ebfffffe          BL       sysprintf
0000f8  ea000002          B        |L1.264|
                  |L1.252|
0000fc  e2844001          ADD      r4,r4,#1              ;79
                  |L1.256|
000100  e3540003          CMP      r4,#3                 ;79
000104  baffffdf          BLT      |L1.136|
                  |L1.264|
000108  e1a00000          MOV      r0,r0                 ;93
00010c  e3540003          CMP      r4,#3                 ;97
000110  0a000001          BEQ      |L1.284|
000114  e3550000          CMP      r5,#0                 ;97
000118  1a000006          BNE      |L1.312|
                  |L1.284|
00011c  e1a02005          MOV      r2,r5                 ;99
000120  e1a01004          MOV      r1,r4                 ;99
000124  e28f0e16          ADR      r0,|L1.652|
000128  ebfffffe          BL       sysprintf
00012c  e2440001          SUB      r0,r4,#1              ;100
000130  e59f10c4          LDR      r1,|L1.508|
000134  e7915100          LDR      r5,[r1,r0,LSL #2]     ;100
                  |L1.312|
000138  e3a04000          MOV      r4,#0                 ;102
00013c  ea000017          B        |L1.416|
                  |L1.320|
000140  e59f0174          LDR      r0,|L1.700|
000144  e0000094          MUL      r0,r4,r0              ;105
000148  e59f1170          LDR      r1,|L1.704|
00014c  e0810100          ADD      r0,r1,r0,LSL #2       ;105
000150  e5900024          LDR      r0,[r0,#0x24]         ;105
000154  e1500005          CMP      r0,r5                 ;105
000158  1a00000f          BNE      |L1.412|
00015c  e58d5000          STR      r5,[sp,#0]            ;107
000160  e59f0154          LDR      r0,|L1.700|
000164  e0000094          MUL      r0,r4,r0              ;107
000168  e0810100          ADD      r0,r1,r0,LSL #2       ;107
00016c  e5903024          LDR      r3,[r0,#0x24]         ;107
000170  e59f0144          LDR      r0,|L1.700|
000174  e0000094          MUL      r0,r4,r0              ;107
000178  e0810100          ADD      r0,r1,r0,LSL #2       ;107
00017c  e2802004          ADD      r2,r0,#4              ;107
000180  e1a01004          MOV      r1,r4                 ;107
000184  e28f0f4e          ADR      r0,|L1.708|
000188  ebfffffe          BL       sysprintf
00018c  e59f006c          LDR      r0,|L1.512|
000190  e5804000          STR      r4,[r0,#0]            ;108  ; currentTariffFileIndex
000194  e3a00001          MOV      r0,#1                 ;109
000198  eaffffcd          B        |L1.212|
                  |L1.412|
00019c  e2844001          ADD      r4,r4,#1              ;102
                  |L1.416|
0001a0  e3540003          CMP      r4,#3                 ;102
0001a4  baffffe5          BLT      |L1.320|
0001a8  e1a00000          MOV      r0,r0                 ;113
                  |L1.428|
0001ac  e3a00000          MOV      r0,#0                 ;114
0001b0  eaffffc7          B        |L1.212|
;;;116    static int tariffIndex = 0;
                          ENDP

                  checkTariffName PROC
;;;117    static BOOL checkTariffName(char* filename)
0001b4  e92d4070          PUSH     {r4-r6,lr}
;;;118    {
0001b8  e1a05000          MOV      r5,r0
;;;119        for(int i = 0; i < tariffIndex; i++)
0001bc  e3a04000          MOV      r4,#0
0001c0  ea000057          B        |L1.804|
                  |L1.452|
;;;120        {
;;;121            if(strcmp(tariffFileName[i], filename) == 0)
0001c4  e0641404          RSB      r1,r4,r4,LSL #8
0001c8  e59f2124          LDR      r2,|L1.756|
0001cc  e0810002          ADD      r0,r1,r2
0001d0  e1a01005          MOV      r1,r5
0001d4  ebfffffe          BL       strcmp
0001d8  e3500000          CMP      r0,#0
0001dc  1a00004f          BNE      |L1.800|
;;;122            {
;;;123                sysprintf(" - checkTariffName exist [%d] [%s]!!\n", i, filename);
0001e0  e1a02005          MOV      r2,r5
0001e4  e1a01004          MOV      r1,r4
0001e8  e28f0f42          ADR      r0,|L1.760|
0001ec  ebfffffe          BL       sysprintf
;;;124                return TRUE;
0001f0  e3a00001          MOV      r0,#1
                  |L1.500|
;;;125            }
;;;126            else
;;;127            {
;;;128                //sysprintf(" - checkTariffName not exist [%d] [%s : %s]!!\n", i, tariffFileName[i], filename);
;;;129            }
;;;130        }
;;;131        return FALSE;
;;;132    }
0001f4  e8bd8070          POP      {r4-r6,pc}
                  |L1.504|
                          DCD      compare
                  |L1.508|
                          DCD      tariffEffectiveDate
                  |L1.512|
                          DCD      currentTariffFileIndex
                  |L1.516|
                          DCD      0x00002710
                  |L1.520|
000208  203e2073          DCB      " > selectTariffFile check [%d]: [%d:%d] \r\n",0
00020c  656c6563
000210  74546172
000214  69666646
000218  696c6520
00021c  63686563
000220  6b205b25
000224  645d3a20
000228  5b25643a
00022c  25645d20
000230  0d0a00  
000233  00                DCB      0
                  |L1.564|
000234  203e2073          DCB      " > selectTariffFile ERROR [%d]: [%d:%d] \r\n",0
000238  656c6563
00023c  74546172
000240  69666646
000244  696c6520
000248  4552524f
00024c  52205b25
000250  645d3a20
000254  5b25643a
000258  25645d20
00025c  0d0a00  
00025f  00                DCB      0
                  |L1.608|
000260  203e2073          DCB      " > selectTariffFile get date [%d]: [%d] \r\n",0
000264  656c6563
000268  74546172
00026c  69666646
000270  696c6520
000274  67657420
000278  64617465
00027c  205b2564
000280  5d3a205b
000284  25645d20
000288  0d0a00  
00028b  00                DCB      0
                  |L1.652|
00028c  203e2073          DCB      " > selectTariffFile get date_2 [%d]: [%d] \r\n",0
000290  656c6563
000294  74546172
000298  69666646
00029c  696c6520
0002a0  67657420
0002a4  64617465
0002a8  5f32205b
0002ac  25645d3a
0002b0  205b2564
0002b4  5d200d0a
0002b8  00      
0002b9  00                DCB      0
0002ba  00                DCB      0
0002bb  00                DCB      0
                  |L1.700|
                          DCD      0x00000119
                  |L1.704|
                          DCD      jsonTariff
                  |L1.708|
0002c4  203e2073          DCB      " > selectTariffFile get it [%d][%s]: [%d:%d] \r\n",0
0002c8  656c6563
0002cc  74546172
0002d0  69666646
0002d4  696c6520
0002d8  67657420
0002dc  6974205b
0002e0  25645d5b
0002e4  25735d3a
0002e8  205b2564
0002ec  3a25645d
0002f0  200d0a00
                  |L1.756|
                          DCD      tariffFileName
                  |L1.760|
0002f8  202d2063          DCB      " - checkTariffName exist [%d] [%s]!!\n",0
0002fc  6865636b
000300  54617269
000304  66664e61
000308  6d652065
00030c  78697374
000310  205b2564
000314  5d205b25
000318  735d2121
00031c  0a00    
00031e  00                DCB      0
00031f  00                DCB      0
                  |L1.800|
000320  e2844001          ADD      r4,r4,#1              ;119
                  |L1.804|
000324  e59f040c          LDR      r0,|L1.1848|
000328  e5900000          LDR      r0,[r0,#0]            ;119  ; tariffIndex
00032c  e1540000          CMP      r4,r0                 ;119
000330  baffffa3          BLT      |L1.452|
000334  e3a00000          MOV      r0,#0                 ;131
000338  eaffffad          B        |L1.500|
;;;133    static BOOL tariffCallback(char* dir, char* filename, int fileLen, void* para1, void* para2, void* para3, void* para4)
                          ENDP

                  tariffCallback PROC
00033c  e92d47f0          PUSH     {r4-r10,lr}
;;;134    {    
000340  e1a08000          MOV      r8,r0
000344  e1a04001          MOV      r4,r1
000348  e1a09002          MOV      r9,r2
00034c  e1a0a003          MOV      r10,r3
000350  e28d7020          ADD      r7,sp,#0x20
000354  e89700e0          LDM      r7,{r5-r7}
;;;135        if(tariffIndex < TARIFF_FILE_NUM)
000358  e59f03d8          LDR      r0,|L1.1848|
00035c  e5900000          LDR      r0,[r0,#0]  ; tariffIndex
000360  e3500003          CMP      r0,#3
000364  aa00000f          BGE      |L1.936|
;;;136        {        
;;;137            if(checkTariffName(filename) == FALSE)
000368  e1a00004          MOV      r0,r4
00036c  ebfffffe          BL       checkTariffName
000370  e3500000          CMP      r0,#0
000374  1a00000b          BNE      |L1.936|
;;;138            {
;;;139                //sysprintf(" - tariffCallback copy [%d] [%s %s]!!\n", tariffIndex, dir, filename);
;;;140                strcpy(tariffFileName[tariffIndex], filename);
000378  e59f13b8          LDR      r1,|L1.1848|
00037c  e5911000          LDR      r1,[r1,#0]  ; tariffIndex
000380  e0611401          RSB      r1,r1,r1,LSL #8
000384  e51f2098          LDR      r2,|L1.756|
000388  e0810002          ADD      r0,r1,r2
00038c  e1a01004          MOV      r1,r4
000390  ebfffffe          BL       strcpy
;;;141                tariffIndex++;
000394  e59f039c          LDR      r0,|L1.1848|
000398  e5900000          LDR      r0,[r0,#0]  ; tariffIndex
00039c  e2800001          ADD      r0,r0,#1
0003a0  e59f1390          LDR      r1,|L1.1848|
0003a4  e5810000          STR      r0,[r1,#0]  ; tariffIndex
                  |L1.936|
;;;142            }
;;;143        }
;;;144        else
;;;145        {
;;;146            //sysprintf(" - tariffCallback ignore [%d] [%s %s]!!\n", tariffIndex, dir, filename);
;;;147        }
;;;148        return TRUE;
0003a8  e3a00001          MOV      r0,#1
;;;149    }
0003ac  e8bd87f0          POP      {r4-r10,pc}
;;;150    
                          ENDP

                  loadTariffFileName PROC
;;;151    
;;;152    static BOOL loadTariffFileName ()
0003b0  e52de004          PUSH     {lr}
;;;153    {
0003b4  e24dd014          SUB      sp,sp,#0x14
;;;154        tariffIndex = 0;
0003b8  e3a00000          MOV      r0,#0
0003bc  e59f1374          LDR      r1,|L1.1848|
0003c0  e5810000          STR      r0,[r1,#0]  ; tariffIndex
;;;155        memset(tariffFileName, 0x0, TARIFF_FILE_NUM*_MAX_LFN);
0003c4  e59f1370          LDR      r1,|L1.1852|
0003c8  e51f00dc          LDR      r0,|L1.756|
0003cc  ebfffffe          BL       __aeabi_memclr4
;;;156    
;;;157        FileAgentGetList(TARIFF_FILE_SAVE_POSITION, TARIFF_FILE_DIR, FILE_EXTENSION_EX(TARIFF_FILE_EXTENSION), NULL, tariffCallback, NULL, NULL, NULL, NULL);
0003d0  e3a00000          MOV      r0,#0
0003d4  e58d0004          STR      r0,[sp,#4]
0003d8  e58d0008          STR      r0,[sp,#8]
0003dc  e58d000c          STR      r0,[sp,#0xc]
0003e0  e58d0010          STR      r0,[sp,#0x10]
0003e4  e59f0354          LDR      r0,|L1.1856|
0003e8  e3a03000          MOV      r3,#0
0003ec  e28f2e35          ADR      r2,|L1.1860|
0003f0  e28f1fd5          ADR      r1,|L1.1868|
0003f4  e58d0000          STR      r0,[sp,#0]
0003f8  e1a00003          MOV      r0,r3
0003fc  ebfffffe          BL       FileAgentGetList
;;;158        
;;;159        sysprintf(" -->> INFO >> Tariff File Name[%d] [%s] \r\n", 0, tariffFileName[0]);
000400  e51f2114          LDR      r2,|L1.756|
000404  e3a01000          MOV      r1,#0
000408  e28f0d0d          ADR      r0,|L1.1872|
00040c  ebfffffe          BL       sysprintf
;;;160        sysprintf(" -->> INFO >> Tariff File Name[%d] [%s] \r\n", 1, tariffFileName[1]);
000410  e59f2364          LDR      r2,|L1.1916|
000414  e3a01001          MOV      r1,#1
000418  e28f0e33          ADR      r0,|L1.1872|
00041c  ebfffffe          BL       sysprintf
;;;161        sysprintf(" -->> INFO >> Tariff File Name[%d] [%s] \r\n", 2, tariffFileName[2]);
000420  e59f2358          LDR      r2,|L1.1920|
000424  e3a01002          MOV      r1,#2
000428  e28f0e32          ADR      r0,|L1.1872|
00042c  ebfffffe          BL       sysprintf
;;;162        return TRUE;
000430  e3a00001          MOV      r0,#1
000434  e28dd014          ADD      sp,sp,#0x14
;;;163    }
000438  e49df004          POP      {pc}
;;;164    static void resetJsonTariff(int index)
                          ENDP

                  resetJsonTariff PROC
00043c  e92d4010          PUSH     {r4,lr}
;;;165    {
000440  e1a04000          MOV      r4,r0
;;;166        memset(&jsonTariff[index], 0x0, sizeof(JsonTariff));
000444  e51f1190          LDR      r1,|L1.700|
000448  e0010194          MUL      r1,r4,r1
00044c  e51f2194          LDR      r2,|L1.704|
000450  e0820101          ADD      r0,r2,r1,LSL #2
000454  e59f1328          LDR      r1,|L1.1924|
000458  ebfffffe          BL       __aeabi_memclr4
;;;167    
;;;168    }
00045c  e8bd8010          POP      {r4,pc}
;;;169    static void printJsonTariff(int index)
                          ENDP

                  printJsonTariff PROC
000460  e92d4038          PUSH     {r3-r5,lr}
;;;170    {
000464  e1a04000          MOV      r4,r0
;;;171        sysprintf("\r\n ---------- jsonver: %d (%s, %s)(effective : %d) -----------\r\n", jsonTariff[index].jsonver, jsonTariff[index].createTime, jsonTariff[index].modifyTime, jsonTariff[index].effectivetime);
000468  e51f01b4          LDR      r0,|L1.700|
00046c  e0000094          MUL      r0,r4,r0
000470  e51f11b8          LDR      r1,|L1.704|
000474  e0810100          ADD      r0,r1,r0,LSL #2
000478  e5900024          LDR      r0,[r0,#0x24]
00047c  e58d0000          STR      r0,[sp,#0]
000480  e51f01cc          LDR      r0,|L1.700|
000484  e0000094          MUL      r0,r4,r0
000488  e281c000          ADD      r12,r1,#0
00048c  e08c0100          ADD      r0,r12,r0,LSL #2
000490  e2803048          ADD      r3,r0,#0x48
000494  e51f01e0          LDR      r0,|L1.700|
000498  e0000094          MUL      r0,r4,r0
00049c  e281c000          ADD      r12,r1,#0
0004a0  e08c0100          ADD      r0,r12,r0,LSL #2
0004a4  e2802028          ADD      r2,r0,#0x28
0004a8  e51f01f4          LDR      r0,|L1.700|
0004ac  e0000094          MUL      r0,r4,r0
0004b0  e281c000          ADD      r12,r1,#0
0004b4  e79c1100          LDR      r1,[r12,r0,LSL #2]
0004b8  e59f02c8          LDR      r0,|L1.1928|
0004bc  ebfffffe          BL       sysprintf
;;;172    #if(0)
;;;173        sysprintf(" > week: ");     
;;;174        for(i = 0; i<TARIFF_WEEK_NUM; i++)
;;;175        {
;;;176            sysprintf("[%d]:%d, ", i, jsonTariff[index].week[i]); 
;;;177        }
;;;178        sysprintf("\r\n"); 
;;;179        sysprintf(" > JsonTariffDayType: \r\n");     
;;;180        for(i = 0; i<TARIFF_DAY_TYPE_NUM; i++)
;;;181        {        
;;;182            for(j = 0; j<TARIFF_DAY_TYPE_ITEM_NUM; j++)
;;;183            {
;;;184                sysprintf("   >> [%d, %d]:", i, j); 
;;;185                sysprintf(" tariffsetting: %d, hour / minute: %02d / %02d, continued: %d\r\n", 
;;;186                                    jsonTariff[index].dayType[i].dayTypeItem[j].tariffsetting, 
;;;187                                    jsonTariff[index].dayType[i].dayTypeItem[j].hour, jsonTariff[index].dayType[i].dayTypeItem[j].minute,
;;;188                                    jsonTariff[index].dayType[i].dayTypeItem[j].continued); 
;;;189            }
;;;190        }
;;;191        sysprintf(" > JsonTariffSetting: \r\n");
;;;192        for(i = 0; i<TARIFF_TARIFF_SETTING_NUM; i++)
;;;193        {
;;;194            sysprintf("   >> [%d]: ", i); 
;;;195            sysprintf("type: %d, timeunit: %d, basecost: %d, costunit: %d, maxcost: %d, maxtime: %d, continuedtime: %d\r\n", 
;;;196                                            jsonTariff[index].tariffSetting[i].type, jsonTariff[index].tariffSetting[i].timeunit, jsonTariff[index].tariffSetting[i].basecost,  
;;;197                                            jsonTariff[index].tariffSetting[i].costunit, jsonTariff[index].tariffSetting[i].maxcost, jsonTariff[index].tariffSetting[i].maxtime,
;;;198                                            jsonTariff[index].tariffSetting[i].continuedtime); 
;;;199        }
;;;200        sysprintf(" ----------------------------------------\r\n");
;;;201    #endif
;;;202    }
0004c0  e8bd8038          POP      {r3-r5,pc}
;;;203    
                          ENDP

                  updateCurrentTariffData PROC
;;;204    static BOOL updateCurrentTariffData(int index)
0004c4  e92d47f0          PUSH     {r4-r10,lr}
;;;205    {    
0004c8  e24dd040          SUB      sp,sp,#0x40
0004cc  e1a06000          MOV      r6,r0
;;;206        RTC_TIME_DATA_T pt;
;;;207        int targetIndex = -1;
0004d0  e3e04000          MVN      r4,#0
;;;208        BOOL getTargetFlag = FALSE;
0004d4  e3a0a000          MOV      r10,#0
;;;209        int j;
;;;210        if(index >= TARIFF_FILE_NUM)
0004d8  e3560003          CMP      r6,#3
0004dc  ba000005          BLT      |L1.1272|
;;;211        {
;;;212            sysprintf(" updateCurrentTariffData error: index = %d...\r\n", index);
0004e0  e1a01006          MOV      r1,r6
0004e4  e28f0e2a          ADR      r0,|L1.1932|
0004e8  ebfffffe          BL       sysprintf
;;;213            return FALSE;
0004ec  e3a00000          MOV      r0,#0
                  |L1.1264|
0004f0  e28dd040          ADD      sp,sp,#0x40
;;;214        }        
;;;215        if(E_RTC_SUCCESS == RTC_Read(RTC_CURRENT_TIME, &pt))
;;;216        {
;;;217            /*
;;;218            typedef enum {
;;;219                RTC_SUNDAY         =   0,   //!< Sunday    
;;;220                RTC_MONDAY         =   1,   //!< Monday    
;;;221                RTC_TUESDAY        =   2,   //!< Tuesday   
;;;222                RTC_WEDNESDAY      =   3,   //!< Wednesday 
;;;223                RTC_THURSDAY       =   4,   //!< Thursday  
;;;224                RTC_FRIDAY         =   5,   //!< Friday    
;;;225                RTC_SATURDAY       =   6    //!< Saturday  
;;;226            } E_RTC_DWR_PARAMETER;
;;;227            */
;;;228            
;;;229    
;;;230            int targetHourMinute = pt.u32cHour * 100 + pt.u32cMinute;
;;;231            int tmpHourMinute = pt.u32cHour * 100 + pt.u32cMinute;
;;;232            int targetDay = pt.u32cDayOfWeek;
;;;233    
;;;234            sysprintf(" updateCurrentTariffData get dayofweek: %d...\r\n", targetDay);
;;;235            currentJsonTariffDayType = &jsonTariff[index].dayType[jsonTariff[index].week[targetDay]];
;;;236            for(j = 0; j<TARIFF_DAY_TYPE_ITEM_NUM; j++)
;;;237            {  
;;;238                tmpHourMinute = currentJsonTariffDayType->dayTypeItem[j].hour * 100 + currentJsonTariffDayType->dayTypeItem[j].minute;
;;;239                sysprintf("   >check> [%d]: %d vs %d \r\n ", j, targetHourMinute, tmpHourMinute); 
;;;240                
;;;241                if((tmpHourMinute == 0)&&(j!=0))
;;;242                {
;;;243                    getTargetFlag = TRUE;
;;;244                    break;
;;;245                }            
;;;246                else
;;;247                {
;;;248                    if(targetHourMinute >= tmpHourMinute)
;;;249                    {               
;;;250                        targetIndex = j;
;;;251                    }
;;;252                    else
;;;253                    {
;;;254                        getTargetFlag = TRUE;
;;;255                        break;
;;;256                    }
;;;257                }
;;;258                
;;;259                
;;;260            }        
;;;261        }
;;;262        
;;;263        if((getTargetFlag) || (j == TARIFF_DAY_TYPE_ITEM_NUM))
;;;264        {
;;;265            if(targetIndex >= 0)
;;;266            {
;;;267                sysprintf("   !!! Get it [%d] -->", targetIndex); 
;;;268                sysprintf(" tariffsetting: %d, hour / minute: %02d / %02d, continued: %d\r\n", 
;;;269                                currentJsonTariffDayType->dayTypeItem[targetIndex].tariffsetting, 
;;;270                                currentJsonTariffDayType->dayTypeItem[targetIndex].hour, currentJsonTariffDayType->dayTypeItem[targetIndex].minute,
;;;271                                currentJsonTariffDayType->dayTypeItem[targetIndex].continued); 
;;;272                if((currentJsonTariffDayType->dayTypeItem[targetIndex].tariffsetting >= 0) &&
;;;273                    (currentJsonTariffDayType->dayTypeItem[targetIndex].tariffsetting < TARIFF_TARIFF_SETTING_NUM))
;;;274                {
;;;275                    currentJsonTariffType = &jsonTariff[index].tariffSetting[currentJsonTariffDayType->dayTypeItem[targetIndex].tariffsetting];
;;;276                    sysprintf("     Tariff Type--> type: %d, timeunit: %d, basecost: %d, costunit: %d, maxcost: %d, maxtime: %d, continuedtime: %d\r\n", 
;;;277                                            currentJsonTariffType->type, currentJsonTariffType->timeunit, currentJsonTariffType->basecost,  
;;;278                                            currentJsonTariffType->costunit, currentJsonTariffType->maxcost, currentJsonTariffType->maxtime,
;;;279                                            currentJsonTariffType->continuedtime); 
;;;280                    return TRUE;
;;;281                }
;;;282            }
;;;283        }
;;;284        currentJsonTariffDayType = NULL;
;;;285        currentJsonTariffType = NULL;
;;;286        sysprintf(" updateCurrentTariffData error\r\n");
;;;287        MeterSetErrorCode(METER_ERROR_CODE_TARIFF_FILE);  
;;;288        return FALSE;
;;;289    
;;;290    }
0004f4  e8bd87f0          POP      {r4-r10,pc}
                  |L1.1272|
0004f8  e28d1010          ADD      r1,sp,#0x10           ;215
0004fc  e3a00000          MOV      r0,#0                 ;215
000500  ebfffffe          BL       RTC_Read
000504  e3500000          CMP      r0,#0                 ;215
000508  1a00003e          BNE      |L1.1544|
00050c  e1cd01d8          LDRD     r0,r1,[sp,#0x18]      ;230
000510  e0812181          ADD      r2,r1,r1,LSL #3       ;230
000514  e0821201          ADD      r1,r2,r1,LSL #4       ;230
000518  e0808101          ADD      r8,r0,r1,LSL #2       ;230
00051c  e59d001c          LDR      r0,[sp,#0x1c]         ;231
000520  e0802180          ADD      r2,r0,r0,LSL #3       ;231
000524  e0820200          ADD      r0,r2,r0,LSL #4       ;231
000528  e59d1018          LDR      r1,[sp,#0x18]         ;231
00052c  e0817100          ADD      r7,r1,r0,LSL #2       ;231
000530  e59d9020          LDR      r9,[sp,#0x20]         ;232
000534  e1a01009          MOV      r1,r9                 ;234
000538  e28f0f9f          ADR      r0,|L1.1980|
00053c  ebfffffe          BL       sysprintf
000540  e51f028c          LDR      r0,|L1.700|
000544  e0000096          MUL      r0,r6,r0              ;235
000548  e51f1290          LDR      r1,|L1.704|
00054c  e0810100          ADD      r0,r1,r0,LSL #2       ;235
000550  e2800068          ADD      r0,r0,#0x68           ;235
000554  e7900109          LDR      r0,[r0,r9,LSL #2]     ;235
000558  e0800080          ADD      r0,r0,r0,LSL #1       ;235
00055c  e51f12a8          LDR      r1,|L1.700|
000560  e0010196          MUL      r1,r6,r1              ;235
000564  e51f22ac          LDR      r2,|L1.704|
000568  e0821101          ADD      r1,r2,r1,LSL #2       ;235
00056c  e2811084          ADD      r1,r1,#0x84           ;235
000570  e0810280          ADD      r0,r1,r0,LSL #5       ;235
000574  e59f1270          LDR      r1,|L1.2028|
000578  e5810000          STR      r0,[r1,#0]            ;235  ; currentJsonTariffDayType
00057c  e3a05000          MOV      r5,#0                 ;236
000580  ea00001c          B        |L1.1528|
                  |L1.1412|
000584  e59f0260          LDR      r0,|L1.2028|
000588  e5900000          LDR      r0,[r0,#0]            ;238  ; currentJsonTariffDayType
00058c  e0800205          ADD      r0,r0,r5,LSL #4       ;238
000590  e5900008          LDR      r0,[r0,#8]            ;238
000594  e59f1250          LDR      r1,|L1.2028|
000598  e5911000          LDR      r1,[r1,#0]            ;238  ; currentJsonTariffDayType
00059c  e0811205          ADD      r1,r1,r5,LSL #4       ;238
0005a0  e5911004          LDR      r1,[r1,#4]            ;238
0005a4  e0812181          ADD      r2,r1,r1,LSL #3       ;238
0005a8  e0821201          ADD      r1,r2,r1,LSL #4       ;238
0005ac  e0807101          ADD      r7,r0,r1,LSL #2       ;238
0005b0  e1a03007          MOV      r3,r7                 ;239
0005b4  e1a02008          MOV      r2,r8                 ;239
0005b8  e1a01005          MOV      r1,r5                 ;239
0005bc  e28f0f8b          ADR      r0,|L1.2032|
0005c0  ebfffffe          BL       sysprintf
0005c4  e3570000          CMP      r7,#0                 ;241
0005c8  1a000003          BNE      |L1.1500|
0005cc  e3550000          CMP      r5,#0                 ;241
0005d0  0a000001          BEQ      |L1.1500|
0005d4  e3a0a001          MOV      r10,#1                ;243
0005d8  ea000008          B        |L1.1536|
                  |L1.1500|
0005dc  e1580007          CMP      r8,r7                 ;248
0005e0  ba000001          BLT      |L1.1516|
0005e4  e1a04005          MOV      r4,r5                 ;250
0005e8  ea000001          B        |L1.1524|
                  |L1.1516|
0005ec  e3a0a001          MOV      r10,#1                ;254
0005f0  ea000002          B        |L1.1536|
                  |L1.1524|
0005f4  e2855001          ADD      r5,r5,#1              ;236
                  |L1.1528|
0005f8  e3550006          CMP      r5,#6                 ;236
0005fc  baffffe0          BLT      |L1.1412|
                  |L1.1536|
000600  e1a00000          MOV      r0,r0                 ;244
000604  e1a00000          MOV      r0,r0                 ;261
                  |L1.1544|
000608  e35a0000          CMP      r10,#0                ;263
00060c  1a000001          BNE      |L1.1560|
000610  e3550006          CMP      r5,#6                 ;263
000614  1a000095          BNE      |L1.2160|
                  |L1.1560|
000618  e3540000          CMP      r4,#0                 ;265
00061c  ba000093          BLT      |L1.2160|
000620  e1a01004          MOV      r1,r4                 ;267
000624  e28f0f79          ADR      r0,|L1.2064|
000628  ebfffffe          BL       sysprintf
00062c  e59f01b8          LDR      r0,|L1.2028|
000630  e5900000          LDR      r0,[r0,#0]            ;268  ; currentJsonTariffDayType
000634  e0800204          ADD      r0,r0,r4,LSL #4       ;268
000638  e5d0000c          LDRB     r0,[r0,#0xc]          ;268
00063c  e58d0000          STR      r0,[sp,#0]            ;268
000640  e59f01a4          LDR      r0,|L1.2028|
000644  e5900000          LDR      r0,[r0,#0]            ;268  ; currentJsonTariffDayType
000648  e0800204          ADD      r0,r0,r4,LSL #4       ;268
00064c  e5903008          LDR      r3,[r0,#8]            ;268
000650  e59f0194          LDR      r0,|L1.2028|
000654  e5900000          LDR      r0,[r0,#0]            ;268  ; currentJsonTariffDayType
000658  e0800204          ADD      r0,r0,r4,LSL #4       ;268
00065c  e5902004          LDR      r2,[r0,#4]            ;268
000660  e59f0184          LDR      r0,|L1.2028|
000664  e5900000          LDR      r0,[r0,#0]            ;268  ; currentJsonTariffDayType
000668  e7901204          LDR      r1,[r0,r4,LSL #4]     ;268
00066c  e28f0f6d          ADR      r0,|L1.2088|
000670  ebfffffe          BL       sysprintf
000674  e59f0170          LDR      r0,|L1.2028|
000678  e5900000          LDR      r0,[r0,#0]            ;272  ; currentJsonTariffDayType
00067c  e7900204          LDR      r0,[r0,r4,LSL #4]     ;272
000680  e3500000          CMP      r0,#0                 ;272
000684  ba000079          BLT      |L1.2160|
000688  e59f015c          LDR      r0,|L1.2028|
00068c  e5900000          LDR      r0,[r0,#0]            ;273  ; currentJsonTariffDayType
000690  e7900204          LDR      r0,[r0,r4,LSL #4]     ;273
000694  e350000a          CMP      r0,#0xa               ;273
000698  aa000074          BGE      |L1.2160|
00069c  e51f03e8          LDR      r0,|L1.700|
0006a0  e0000096          MUL      r0,r6,r0              ;275
0006a4  e51f13ec          LDR      r1,|L1.704|
0006a8  e0810100          ADD      r0,r1,r0,LSL #2       ;275
0006ac  e2800fc9          ADD      r0,r0,#0x324          ;275
0006b0  e59f1134          LDR      r1,|L1.2028|
0006b4  e5911000          LDR      r1,[r1,#0]            ;275  ; currentJsonTariffDayType
0006b8  e7911204          LDR      r1,[r1,r4,LSL #4]     ;275
0006bc  e0800281          ADD      r0,r0,r1,LSL #5       ;275
0006c0  e59f11a0          LDR      r1,|L1.2152|
0006c4  e5810000          STR      r0,[r1,#0]            ;275  ; currentJsonTariffType
0006c8  e2810000          ADD      r0,r1,#0              ;276
0006cc  e5900000          LDR      r0,[r0,#0]            ;276  ; currentJsonTariffType
0006d0  e590101c          LDR      r1,[r0,#0x1c]         ;276
0006d4  e59f018c          LDR      r0,|L1.2152|
0006d8  e5900000          LDR      r0,[r0,#0]            ;276  ; currentJsonTariffType
0006dc  e5900018          LDR      r0,[r0,#0x18]         ;276
0006e0  e59f2180          LDR      r2,|L1.2152|
0006e4  e5922000          LDR      r2,[r2,#0]            ;276  ; currentJsonTariffType
0006e8  e5922014          LDR      r2,[r2,#0x14]         ;276
0006ec  e59f3174          LDR      r3,|L1.2152|
0006f0  e5933000          LDR      r3,[r3,#0]            ;276  ; currentJsonTariffType
0006f4  e5933010          LDR      r3,[r3,#0x10]         ;276
0006f8  e1cd00f8          STRD     r0,r1,[sp,#8]         ;276
0006fc  e59f0164          LDR      r0,|L1.2152|
000700  e58d2004          STR      r2,[sp,#4]            ;276
000704  e58d3000          STR      r3,[sp,#0]            ;276
000708  e5900000          LDR      r0,[r0,#0]            ;276  ; currentJsonTariffType
00070c  e590300c          LDR      r3,[r0,#0xc]          ;276
000710  e59f0150          LDR      r0,|L1.2152|
000714  e5900000          LDR      r0,[r0,#0]            ;276  ; currentJsonTariffType
000718  e5902008          LDR      r2,[r0,#8]            ;276
00071c  e59f0144          LDR      r0,|L1.2152|
000720  e5900000          LDR      r0,[r0,#0]            ;276  ; currentJsonTariffType
000724  e5901000          LDR      r1,[r0,#0]            ;276
000728  e59f013c          LDR      r0,|L1.2156|
00072c  ebfffffe          BL       sysprintf
000730  e3a00001          MOV      r0,#1                 ;280
000734  eaffff6d          B        |L1.1264|
                  |L1.1848|
                          DCD      tariffIndex
                  |L1.1852|
                          DCD      0x000002fd
                  |L1.1856|
                          DCD      tariffCallback
                  |L1.1860|
000744  2a2e7472          DCB      "*.tre",0
000748  6500    
00074a  00                DCB      0
00074b  00                DCB      0
                  |L1.1868|
00074c  313a00            DCB      "1:",0
00074f  00                DCB      0
                  |L1.1872|
000750  202d2d3e          DCB      " -->> INFO >> Tariff File Name[%d] [%s] \r\n",0
000754  3e20494e
000758  464f203e
00075c  3e205461
000760  72696666
000764  2046696c
000768  65204e61
00076c  6d655b25
000770  645d205b
000774  25735d20
000778  0d0a00  
00077b  00                DCB      0
                  |L1.1916|
                          DCD      tariffFileName+0xff
                  |L1.1920|
                          DCD      tariffFileName+0x1fe
                  |L1.1924|
                          DCD      0x00000464
                  |L1.1928|
                          DCD      ||.constdata||
                  |L1.1932|
00078c  20757064          DCB      " updateCurrentTariffData error: index = %d...\r\n",0
000790  61746543
000794  75727265
000798  6e745461
00079c  72696666
0007a0  44617461
0007a4  20657272
0007a8  6f723a20
0007ac  696e6465
0007b0  78203d20
0007b4  25642e2e
0007b8  2e0d0a00
                  |L1.1980|
0007bc  20757064          DCB      " updateCurrentTariffData get dayofweek: %d...\r\n",0
0007c0  61746543
0007c4  75727265
0007c8  6e745461
0007cc  72696666
0007d0  44617461
0007d4  20676574
0007d8  20646179
0007dc  6f667765
0007e0  656b3a20
0007e4  25642e2e
0007e8  2e0d0a00
                  |L1.2028|
                          DCD      currentJsonTariffDayType
                  |L1.2032|
0007f0  2020203e          DCB      "   >check> [%d]: %d vs %d \r\n ",0
0007f4  63686563
0007f8  6b3e205b
0007fc  25645d3a
000800  20256420
000804  76732025
000808  64200d0a
00080c  2000    
00080e  00                DCB      0
00080f  00                DCB      0
                  |L1.2064|
000810  20202021          DCB      "   !!! Get it [%d] -->",0
000814  21212047
000818  65742069
00081c  74205b25
000820  645d202d
000824  2d3e00  
000827  00                DCB      0
                  |L1.2088|
000828  20746172          DCB      " tariffsetting: %d, hour / minute: %02d / %02d, continu"
00082c  69666673
000830  65747469
000834  6e673a20
000838  25642c20
00083c  686f7572
000840  202f206d
000844  696e7574
000848  653a2025
00084c  30326420
000850  2f202530
000854  32642c20
000858  636f6e74
00085c  696e75  
00085f  65643a20          DCB      "ed: %d\r\n",0
000863  25640d0a
000867  00      
                  |L1.2152|
                          DCD      currentJsonTariffType
                  |L1.2156|
                          DCD      ||.constdata||+0x44
                  |L1.2160|
000870  e3a00000          MOV      r0,#0                 ;284
000874  e51f1090          LDR      r1,|L1.2028|
000878  e5810000          STR      r0,[r1,#0]            ;284  ; currentJsonTariffDayType
00087c  e51f101c          LDR      r1,|L1.2152|
000880  e5810000          STR      r0,[r1,#0]            ;285  ; currentJsonTariffType
000884  e28f0e2a          ADR      r0,|L1.2860|
000888  ebfffffe          BL       sysprintf
00088c  e3a00b02          MOV      r0,#0x800             ;287
000890  ebfffffe          BL       MeterSetErrorCode
000894  e3a00000          MOV      r0,#0                 ;288
000898  eaffff14          B        |L1.1264|
;;;291    
                          ENDP

                  loadJsonTariff PROC
;;;292    #define ENABLE_LOAD_JSON_DEBUG  0
;;;293    static BOOL loadJsonTariff(int index, char* fileName)
00089c  e92d4ff3          PUSH     {r0,r1,r4-r11,lr}
;;;294    {
0008a0  e24dd02c          SUB      sp,sp,#0x2c
0008a4  e1a04000          MOV      r4,r0
;;;295        sysprintf("     load loadJsonTariff [%d] [%s]>>\r\n", index, fileName); 
0008a8  e1a01004          MOV      r1,r4
0008ac  e28f0fa7          ADR      r0,|L1.2896|
0008b0  e59d2030          LDR      r2,[sp,#0x30]
0008b4  ebfffffe          BL       sysprintf
;;;296        uint8_t* dataTmp;
;;;297        size_t dataTmpLen;
;;;298        BOOL needFree;
;;;299        FileAgentReturn reVal; 
;;;300        cJSON *root_json = NULL;
0008b8  e3a0a000          MOV      r10,#0
;;;301        cJSON *tmp_json = NULL;
0008bc  e3a06000          MOV      r6,#0
;;;302        cJSON *tmp_json2 = NULL;
0008c0  e3a09000          MOV      r9,#0
;;;303        cJSON *tmp_json3 = NULL;
0008c4  e3a05000          MOV      r5,#0
;;;304        cJSON *tmp_json4 = NULL;
0008c8  e3a08000          MOV      r8,#0
;;;305        int errorCode = 0;
0008cc  e3a00000          MOV      r0,#0
0008d0  e58d0018          STR      r0,[sp,#0x18]
;;;306        
;;;307         //__SHOW_FREE_HEAP_SIZE__
;;;308        reVal = FileAgentGetData(TARIFF_FILE_SAVE_POSITION, TARIFF_FILE_DIR, fileName, &dataTmp, &dataTmpLen, &needFree, TRUE);
0008d4  e3a00001          MOV      r0,#1
0008d8  e28d1020          ADD      r1,sp,#0x20
0008dc  e28d2024          ADD      r2,sp,#0x24
0008e0  e58d0008          STR      r0,[sp,#8]
0008e4  e58d1004          STR      r1,[sp,#4]
0008e8  e58d2000          STR      r2,[sp,#0]
0008ec  e28d3028          ADD      r3,sp,#0x28
0008f0  e24f1f6b          ADR      r1,|L1.1868|
0008f4  e3a00000          MOV      r0,#0
0008f8  e59d2030          LDR      r2,[sp,#0x30]
0008fc  ebfffffe          BL       FileAgentGetData
000900  e58d001c          STR      r0,[sp,#0x1c]
;;;309        if(reVal != FILE_AGENT_RETURN_ERROR)
000904  e59d001c          LDR      r0,[sp,#0x1c]
000908  e3500000          CMP      r0,#0
00090c  0a000303          BEQ      |L1.5408|
;;;310        {
;;;311             //為了在其他DISK備份
;;;312            FileAgentAddData(TARIFF_FILE_SAVE_POSITION, TARIFF_FILE_DIR, fileName, dataTmp, dataTmpLen, FILE_AGENT_ADD_DATA_TYPE_OVERWRITE, FALSE, TRUE, TRUE); 
000910  e3a00001          MOV      r0,#1
000914  e3a02000          MOV      r2,#0
000918  e58d2004          STR      r2,[sp,#4]
00091c  e58d000c          STR      r0,[sp,#0xc]
000920  e58d2008          STR      r2,[sp,#8]
000924  e58d0010          STR      r0,[sp,#0x10]
000928  e59d0024          LDR      r0,[sp,#0x24]
00092c  e58d0000          STR      r0,[sp,#0]
000930  e24f1f7b          ADR      r1,|L1.1868|
000934  e3a00000          MOV      r0,#0
000938  e59d2030          LDR      r2,[sp,#0x30]
00093c  e59d3028          LDR      r3,[sp,#0x28]
000940  ebfffffe          BL       FileAgentAddData
;;;313            
;;;314            root_json = cJSON_Parse((char*)dataTmp);                    
000944  e59d0028          LDR      r0,[sp,#0x28]
000948  ebfffffe          BL       cJSON_Parse
00094c  e1a0a000          MOV      r10,r0
;;;315            
;;;316            resetJsonTariff(index);
000950  e1a00004          MOV      r0,r4
000954  ebfffffe          BL       resetJsonTariff
;;;317            
;;;318            if (NULL == root_json)
000958  e35a0000          CMP      r10,#0
00095c  1a000007          BNE      |L1.2432|
;;;319            {
;;;320                sysprintf("error():%s\n", cJSON_GetErrorPtr());   
000960  ebfffffe          BL       cJSON_GetErrorPtr
000964  e1a07000          MOV      r7,r0
000968  e1a01007          MOV      r1,r7
00096c  e28f0f81          ADR      r0,|L1.2936|
000970  ebfffffe          BL       sysprintf
;;;321                errorCode = 1;
000974  e3a00001          MOV      r0,#1
000978  e58d0018          STR      r0,[sp,#0x18]
;;;322                goto jsonExit;
00097c  ea0002e8          B        |L1.5412|
                  |L1.2432|
;;;323            }
;;;324            
;;;325            tmp_json = cJSON_GetObjectItem(root_json, "jsonver");
000980  e28f1f7f          ADR      r1,|L1.2948|
000984  e1a0000a          MOV      r0,r10
000988  ebfffffe          BL       cJSON_GetObjectItem
00098c  e1a06000          MOV      r6,r0
;;;326            if (tmp_json != NULL)
000990  e3560000          CMP      r6,#0
000994  0a000005          BEQ      |L1.2480|
;;;327            {
;;;328                jsonTariff[index].jsonver = tmp_json->valueint;
000998  e5960014          LDR      r0,[r6,#0x14]
00099c  e51f16e8          LDR      r1,|L1.700|
0009a0  e0010194          MUL      r1,r4,r1
0009a4  e51f26ec          LDR      r2,|L1.704|
0009a8  e7820101          STR      r0,[r2,r1,LSL #2]
0009ac  ea000007          B        |L1.2512|
                  |L1.2480|
;;;329                #if(ENABLE_LOAD_JSON_DEBUG)
;;;330                sysprintf(" >> jsonTariff[index].jsonver:%d\n", jsonTariff[index].jsonver);
;;;331                #endif
;;;332            }
;;;333            else
;;;334            {
;;;335                sysprintf("error(jsonver):%s\n", cJSON_GetErrorPtr()); 
0009b0  ebfffffe          BL       cJSON_GetErrorPtr
0009b4  e1a07000          MOV      r7,r0
0009b8  e1a01007          MOV      r1,r7
0009bc  e28f0f72          ADR      r0,|L1.2956|
0009c0  ebfffffe          BL       sysprintf
;;;336                errorCode = 2;                        
0009c4  e3a00002          MOV      r0,#2
0009c8  e58d0018          STR      r0,[sp,#0x18]
;;;337                goto jsonExit;
0009cc  ea0002d4          B        |L1.5412|
                  |L1.2512|
;;;338            }
;;;339            
;;;340            tmp_json = cJSON_GetObjectItem(root_json, "name");
0009d0  e28f1f72          ADR      r1,|L1.2976|
0009d4  e1a0000a          MOV      r0,r10
0009d8  ebfffffe          BL       cJSON_GetObjectItem
0009dc  e1a06000          MOV      r6,r0
;;;341            if (tmp_json != NULL)
0009e0  e3560000          CMP      r6,#0
0009e4  0a000007          BEQ      |L1.2568|
;;;342            {
;;;343                strcpy((char*)jsonTariff[index].name, (const char*)(tmp_json->valuestring));
0009e8  e5961010          LDR      r1,[r6,#0x10]
0009ec  e51f2738          LDR      r2,|L1.700|
0009f0  e0020294          MUL      r2,r4,r2
0009f4  e51f373c          LDR      r3,|L1.704|
0009f8  e0832102          ADD      r2,r3,r2,LSL #2
0009fc  e2820004          ADD      r0,r2,#4
000a00  ebfffffe          BL       strcpy
000a04  ea000007          B        |L1.2600|
                  |L1.2568|
;;;344                #if(ENABLE_LOAD_JSON_DEBUG)
;;;345                sysprintf(" >> jsonTariff[index].name:[%s]\n", jsonTariff[index].name);
;;;346                #endif
;;;347            }
;;;348            else
;;;349            {
;;;350                sysprintf("error(name):%s\n", cJSON_GetErrorPtr());    
000a08  ebfffffe          BL       cJSON_GetErrorPtr
000a0c  e1a07000          MOV      r7,r0
000a10  e1a01007          MOV      r1,r7
000a14  e28f0f63          ADR      r0,|L1.2984|
000a18  ebfffffe          BL       sysprintf
;;;351                errorCode = 3;                            
000a1c  e3a00003          MOV      r0,#3
000a20  e58d0018          STR      r0,[sp,#0x18]
;;;352                goto jsonExit;
000a24  ea0002be          B        |L1.5412|
                  |L1.2600|
;;;353            }
;;;354            
;;;355            
;;;356            tmp_json = cJSON_GetObjectItem(root_json, "effectivetime");
000a28  e28f1f62          ADR      r1,|L1.3000|
000a2c  e1a0000a          MOV      r0,r10
000a30  ebfffffe          BL       cJSON_GetObjectItem
000a34  e1a06000          MOV      r6,r0
;;;357            if (tmp_json != NULL)
000a38  e3560000          CMP      r6,#0
000a3c  0a000006          BEQ      |L1.2652|
;;;358            {
;;;359                jsonTariff[index].effectivetime = tmp_json->valueint;
000a40  e5960014          LDR      r0,[r6,#0x14]
000a44  e51f1790          LDR      r1,|L1.700|
000a48  e0010194          MUL      r1,r4,r1
000a4c  e51f2794          LDR      r2,|L1.704|
000a50  e0821101          ADD      r1,r2,r1,LSL #2
000a54  e5810024          STR      r0,[r1,#0x24]
000a58  ea000007          B        |L1.2684|
                  |L1.2652|
;;;360                #if(ENABLE_LOAD_JSON_DEBUG)
;;;361                sysprintf(" >> jsonTariff[index].effectivetime:%d\n", jsonTariff[index].effectivetime);
;;;362                #endif
;;;363            }
;;;364            else
;;;365            {
;;;366                sysprintf("error(effectivetime):%s\n", cJSON_GetErrorPtr()); 
000a5c  ebfffffe          BL       cJSON_GetErrorPtr
000a60  e1a07000          MOV      r7,r0
000a64  e1a01007          MOV      r1,r7
000a68  e28f0f56          ADR      r0,|L1.3016|
000a6c  ebfffffe          BL       sysprintf
;;;367                errorCode = 4;                            
000a70  e3a00004          MOV      r0,#4
000a74  e58d0018          STR      r0,[sp,#0x18]
;;;368                goto jsonExit;
000a78  ea0002a9          B        |L1.5412|
                  |L1.2684|
;;;369            }
;;;370            
;;;371            tmp_json = cJSON_GetObjectItem(root_json, "createtime");
000a7c  e28f1e16          ADR      r1,|L1.3044|
000a80  e1a0000a          MOV      r0,r10
000a84  ebfffffe          BL       cJSON_GetObjectItem
000a88  e1a06000          MOV      r6,r0
;;;372            if (tmp_json != NULL)
000a8c  e3560000          CMP      r6,#0
000a90  0a000007          BEQ      |L1.2740|
;;;373            {
;;;374                strcpy(jsonTariff[index].createTime, tmp_json->valuestring);
000a94  e5961010          LDR      r1,[r6,#0x10]
000a98  e51f27e4          LDR      r2,|L1.700|
000a9c  e0020294          MUL      r2,r4,r2
000aa0  e51f37e8          LDR      r3,|L1.704|
000aa4  e0832102          ADD      r2,r3,r2,LSL #2
000aa8  e2820028          ADD      r0,r2,#0x28
000aac  ebfffffe          BL       strcpy
000ab0  ea000007          B        |L1.2772|
                  |L1.2740|
;;;375                #if(ENABLE_LOAD_JSON_DEBUG)
;;;376                sysprintf(" >> jsonTariff[index].createTime:[%s]\n", jsonTariff[index].createTime);
;;;377                #endif
;;;378            }
;;;379            else
;;;380            {
;;;381                sysprintf("error(createtime):%s\n", cJSON_GetErrorPtr()); 
000ab4  ebfffffe          BL       cJSON_GetErrorPtr
000ab8  e1a07000          MOV      r7,r0
000abc  e1a01007          MOV      r1,r7
000ac0  e28f0f4a          ADR      r0,|L1.3056|
000ac4  ebfffffe          BL       sysprintf
;;;382                errorCode = 4;                            
000ac8  e3a00004          MOV      r0,#4
000acc  e58d0018          STR      r0,[sp,#0x18]
;;;383                goto jsonExit;
000ad0  ea000293          B        |L1.5412|
                  |L1.2772|
;;;384            }
;;;385            
;;;386            tmp_json = cJSON_GetObjectItem(root_json, "modifytime");
000ad4  e28f1f4b          ADR      r1,|L1.3080|
000ad8  e1a0000a          MOV      r0,r10
000adc  ebfffffe          BL       cJSON_GetObjectItem
000ae0  e1a06000          MOV      r6,r0
;;;387            if (tmp_json != NULL)
000ae4  e3560000          CMP      r6,#0
000ae8  0a000007          BEQ      |L1.2828|
;;;388            {
;;;389                strcpy(jsonTariff[index].modifyTime, tmp_json->valuestring);
000aec  e5961010          LDR      r1,[r6,#0x10]
000af0  e51f283c          LDR      r2,|L1.700|
000af4  e0020294          MUL      r2,r4,r2
000af8  e51f3840          LDR      r3,|L1.704|
000afc  e0832102          ADD      r2,r3,r2,LSL #2
000b00  e2820048          ADD      r0,r2,#0x48
000b04  ebfffffe          BL       strcpy
000b08  ea000047          B        |L1.3116|
                  |L1.2828|
;;;390                #if(ENABLE_LOAD_JSON_DEBUG)
;;;391                sysprintf(" >> jsonTariff[index].modifyTime:[%s]\n", jsonTariff[index].modifyTime);
;;;392                #endif
;;;393            }
;;;394            else
;;;395            {
;;;396                sysprintf("error(modifytime):%s\n", cJSON_GetErrorPtr());     
000b0c  ebfffffe          BL       cJSON_GetErrorPtr
000b10  e1a07000          MOV      r7,r0
000b14  e1a01007          MOV      r1,r7
000b18  e28f00f4          ADR      r0,|L1.3092|
000b1c  ebfffffe          BL       sysprintf
;;;397                errorCode = 5;                            
000b20  e3a00005          MOV      r0,#5
000b24  e58d0018          STR      r0,[sp,#0x18]
;;;398                goto jsonExit;
000b28  ea00027d          B        |L1.5412|
                  |L1.2860|
000b2c  20757064          DCB      " updateCurrentTariffData error\r\n",0
000b30  61746543
000b34  75727265
000b38  6e745461
000b3c  72696666
000b40  44617461
000b44  20657272
000b48  6f720d0a
000b4c  00      
000b4d  00                DCB      0
000b4e  00                DCB      0
000b4f  00                DCB      0
                  |L1.2896|
000b50  20202020          DCB      "     load loadJsonTariff [%d] [%s]>>\r\n",0
000b54  206c6f61
000b58  64206c6f
000b5c  61644a73
000b60  6f6e5461
000b64  72696666
000b68  205b2564
000b6c  5d205b25
000b70  735d3e3e
000b74  0d0a00  
000b77  00                DCB      0
                  |L1.2936|
000b78  6572726f          DCB      "error():%s\n",0
000b7c  7228293a
000b80  25730a00
                  |L1.2948|
000b84  6a736f6e          DCB      "jsonver",0
000b88  76657200
                  |L1.2956|
000b8c  6572726f          DCB      "error(jsonver):%s\n",0
000b90  72286a73
000b94  6f6e7665
000b98  72293a25
000b9c  730a00  
000b9f  00                DCB      0
                  |L1.2976|
000ba0  6e616d65          DCB      "name",0
000ba4  00      
000ba5  00                DCB      0
000ba6  00                DCB      0
000ba7  00                DCB      0
                  |L1.2984|
000ba8  6572726f          DCB      "error(name):%s\n",0
000bac  72286e61
000bb0  6d65293a
000bb4  25730a00
                  |L1.3000|
000bb8  65666665          DCB      "effectivetime",0
000bbc  63746976
000bc0  6574696d
000bc4  6500    
000bc6  00                DCB      0
000bc7  00                DCB      0
                  |L1.3016|
000bc8  6572726f          DCB      "error(effectivetime):%s\n",0
000bcc  72286566
000bd0  66656374
000bd4  69766574
000bd8  696d6529
000bdc  3a25730a
000be0  00      
000be1  00                DCB      0
000be2  00                DCB      0
000be3  00                DCB      0
                  |L1.3044|
000be4  63726561          DCB      "createtime",0
000be8  74657469
000bec  6d6500  
000bef  00                DCB      0
                  |L1.3056|
000bf0  6572726f          DCB      "error(createtime):%s\n",0
000bf4  72286372
000bf8  65617465
000bfc  74696d65
000c00  293a2573
000c04  0a00    
000c06  00                DCB      0
000c07  00                DCB      0
                  |L1.3080|
000c08  6d6f6469          DCB      "modifytime",0
000c0c  66797469
000c10  6d6500  
000c13  00                DCB      0
                  |L1.3092|
000c14  6572726f          DCB      "error(modifytime):%s\n",0
000c18  72286d6f
000c1c  64696679
000c20  74696d65
000c24  293a2573
000c28  0a00    
000c2a  00                DCB      0
000c2b  00                DCB      0
                  |L1.3116|
;;;399            }
;;;400            //week
;;;401            tmp_json = cJSON_GetObjectItem(root_json, "week");
000c2c  e28f1c03          ADR      r1,|L1.3892|
000c30  e1a0000a          MOV      r0,r10
000c34  ebfffffe          BL       cJSON_GetObjectItem
000c38  e1a06000          MOV      r6,r0
;;;402            if (tmp_json != NULL)
000c3c  e3560000          CMP      r6,#0
000c40  0a000021          BEQ      |L1.3276|
;;;403            {
;;;404                int i;
;;;405                int arrarSize = cJSON_GetArraySize(tmp_json);
000c44  e1a00006          MOV      r0,r6
000c48  ebfffffe          BL       cJSON_GetArraySize
000c4c  e1a0b000          MOV      r11,r0
;;;406                #if(ENABLE_LOAD_JSON_DEBUG)
;;;407                sysprintf(" >> jsonTariff[index].week: arrar size = %d\n", arrarSize);
;;;408                #endif
;;;409                if(arrarSize > TARIFF_WEEK_NUM)
000c50  e35b0007          CMP      r11,#7
000c54  da000000          BLE      |L1.3164|
;;;410                    arrarSize = TARIFF_WEEK_NUM;
000c58  e3a0b007          MOV      r11,#7
                  |L1.3164|
;;;411                for(i = 0; i < arrarSize; i++)
000c5c  e3a07000          MOV      r7,#0
000c60  ea000016          B        |L1.3264|
                  |L1.3172|
;;;412                {                       
;;;413                    tmp_json2 = cJSON_GetArrayItem(tmp_json, i);    
000c64  e1a01007          MOV      r1,r7
000c68  e1a00006          MOV      r0,r6
000c6c  ebfffffe          BL       cJSON_GetArrayItem
000c70  e1a09000          MOV      r9,r0
;;;414                    if(tmp_json2 != NULL)
000c74  e3590000          CMP      r9,#0
000c78  0a000007          BEQ      |L1.3228|
;;;415                    {                                
;;;416                        jsonTariff[index].week[i] = tmp_json2->valueint;
000c7c  e5990014          LDR      r0,[r9,#0x14]
000c80  e51f19cc          LDR      r1,|L1.700|
000c84  e0010194          MUL      r1,r4,r1
000c88  e51f29d0          LDR      r2,|L1.704|
000c8c  e0821101          ADD      r1,r2,r1,LSL #2
000c90  e2811068          ADD      r1,r1,#0x68
000c94  e7810107          STR      r0,[r1,r7,LSL #2]
000c98  ea000007          B        |L1.3260|
                  |L1.3228|
;;;417                        #if(ENABLE_LOAD_JSON_DEBUG)
;;;418                        sysprintf("     >> jsonTariff[index].week[%d]:%d\n", i, jsonTariff[index].week[i]);
;;;419                        #endif
;;;420                    }
;;;421                    else
;;;422                    {
;;;423                        sysprintf("error(week array):%s\n", cJSON_GetErrorPtr());   
000c9c  ebfffffe          BL       cJSON_GetErrorPtr
000ca0  e58d0014          STR      r0,[sp,#0x14]
000ca4  e1a01000          MOV      r1,r0
000ca8  e28f0fa3          ADR      r0,|L1.3900|
000cac  ebfffffe          BL       sysprintf
;;;424                        errorCode = 6;                                    
000cb0  e3a00006          MOV      r0,#6
000cb4  e58d0018          STR      r0,[sp,#0x18]
;;;425                        goto jsonExit;
000cb8  ea000219          B        |L1.5412|
                  |L1.3260|
000cbc  e2877001          ADD      r7,r7,#1              ;411
                  |L1.3264|
000cc0  e157000b          CMP      r7,r11                ;411
000cc4  baffffe6          BLT      |L1.3172|
;;;426                    }
;;;427                }
;;;428            }
000cc8  ea000007          B        |L1.3308|
                  |L1.3276|
;;;429            else
;;;430            {
;;;431                sysprintf("error(week):%s\n", cJSON_GetErrorPtr()); 
000ccc  ebfffffe          BL       cJSON_GetErrorPtr
000cd0  e1a07000          MOV      r7,r0
000cd4  e1a01007          MOV      r1,r7
000cd8  e28f0f9d          ADR      r0,|L1.3924|
000cdc  ebfffffe          BL       sysprintf
;;;432                errorCode = 7;                            
000ce0  e3a00007          MOV      r0,#7
000ce4  e58d0018          STR      r0,[sp,#0x18]
;;;433                goto jsonExit;
000ce8  ea00020d          B        |L1.5412|
                  |L1.3308|
;;;434            }
;;;435            
;;;436            //day type
;;;437            tmp_json = cJSON_GetObjectItem(root_json, "daytype");
000cec  e28f1e27          ADR      r1,|L1.3940|
000cf0  e1a0000a          MOV      r0,r10
000cf4  ebfffffe          BL       cJSON_GetObjectItem
000cf8  e1a06000          MOV      r6,r0
;;;438            if (tmp_json != NULL)
000cfc  e3560000          CMP      r6,#0
000d00  0a0000d6          BEQ      |L1.4192|
;;;439            {
;;;440                int i, j;
;;;441                int arrarSize = cJSON_GetArraySize(tmp_json);
000d04  e1a00006          MOV      r0,r6
000d08  ebfffffe          BL       cJSON_GetArraySize
000d0c  e58d0014          STR      r0,[sp,#0x14]
;;;442                #if(ENABLE_LOAD_JSON_DEBUG)
;;;443                sysprintf(" >> jsonTariff[index].daytype: arrar size = %d\n", arrarSize);
;;;444                #endif
;;;445                if(arrarSize > TARIFF_DAY_TYPE_NUM)
000d10  e59d0014          LDR      r0,[sp,#0x14]
000d14  e3500007          CMP      r0,#7
000d18  da000001          BLE      |L1.3364|
;;;446                    arrarSize = TARIFF_DAY_TYPE_NUM;
000d1c  e3a00007          MOV      r0,#7
000d20  e58d0014          STR      r0,[sp,#0x14]
                  |L1.3364|
;;;447                for(i = 0; i < arrarSize; i++)
000d24  e3a07000          MOV      r7,#0
000d28  ea0000c8          B        |L1.4176|
                  |L1.3372|
;;;448                {                       
;;;449                    tmp_json2 = cJSON_GetArrayItem(tmp_json, i);   
000d2c  e1a01007          MOV      r1,r7
000d30  e1a00006          MOV      r0,r6
000d34  ebfffffe          BL       cJSON_GetArrayItem
000d38  e1a09000          MOV      r9,r0
;;;450                    if (tmp_json2 != NULL)
000d3c  e3590000          CMP      r9,#0
000d40  0a0000b9          BEQ      |L1.4140|
;;;451                    {
;;;452                        int arrarSize = cJSON_GetArraySize(tmp_json2);
000d44  e1a00009          MOV      r0,r9
000d48  ebfffffe          BL       cJSON_GetArraySize
000d4c  e58d0010          STR      r0,[sp,#0x10]
;;;453                        #if(ENABLE_LOAD_JSON_DEBUG)
;;;454                        sysprintf("     >> jsonTariff[index].daytypeitem: arrar size = %d\n", arrarSize);
;;;455                        #endif
;;;456                        if(arrarSize > TARIFF_DAY_TYPE_ITEM_NUM)
000d50  e59d0010          LDR      r0,[sp,#0x10]
000d54  e3500006          CMP      r0,#6
000d58  da000001          BLE      |L1.3428|
;;;457                            arrarSize = TARIFF_DAY_TYPE_ITEM_NUM;
000d5c  e3a00006          MOV      r0,#6
000d60  e58d0010          STR      r0,[sp,#0x10]
                  |L1.3428|
;;;458                        for(j = 0; j < arrarSize; j++)
000d64  e3a0b000          MOV      r11,#0
000d68  ea0000ab          B        |L1.4124|
                  |L1.3436|
;;;459                        {                       
;;;460                            tmp_json3 = cJSON_GetArrayItem(tmp_json2, j);    
000d6c  e1a0100b          MOV      r1,r11
000d70  e1a00009          MOV      r0,r9
000d74  ebfffffe          BL       cJSON_GetArrayItem
000d78  e1a05000          MOV      r5,r0
;;;461                            if(tmp_json3 != NULL)
000d7c  e3550000          CMP      r5,#0
000d80  0a00009c          BEQ      |L1.4088|
;;;462                            {
;;;463                                tmp_json4 = cJSON_GetObjectItem(tmp_json3, "tariffsetting");
000d84  e28f1e1e          ADR      r1,|L1.3948|
000d88  e1a00005          MOV      r0,r5
000d8c  ebfffffe          BL       cJSON_GetObjectItem
000d90  e1a08000          MOV      r8,r0
;;;464                                if (tmp_json4 != NULL)
000d94  e3580000          CMP      r8,#0
000d98  0a000009          BEQ      |L1.3524|
;;;465                                {
;;;466                                    jsonTariff[index].dayType[i].dayTypeItem[j].tariffsetting = tmp_json4->valueint;
000d9c  e5980014          LDR      r0,[r8,#0x14]
000da0  e51f1aec          LDR      r1,|L1.700|
000da4  e0010194          MUL      r1,r4,r1
000da8  e51f2af0          LDR      r2,|L1.704|
000dac  e0821101          ADD      r1,r2,r1,LSL #2
000db0  e2811084          ADD      r1,r1,#0x84
000db4  e0872087          ADD      r2,r7,r7,LSL #1
000db8  e0811282          ADD      r1,r1,r2,LSL #5
000dbc  e781020b          STR      r0,[r1,r11,LSL #4]
000dc0  ea000007          B        |L1.3556|
                  |L1.3524|
;;;467                                    #if(ENABLE_LOAD_JSON_DEBUG)
;;;468                                    sysprintf("         >> jsonTariff[index].dayType[%d].dayTypeItem[%d].tariffsetting: %d\n", i, j, jsonTariff[index].dayType[i].dayTypeItem[j].tariffsetting);
;;;469                                    #endif
;;;470                                }
;;;471                                else
;;;472                                {
;;;473                                    sysprintf("error(tariffsetting):%s\n", cJSON_GetErrorPtr());   
000dc4  ebfffffe          BL       cJSON_GetErrorPtr
000dc8  e58d000c          STR      r0,[sp,#0xc]
000dcc  e1a01000          MOV      r1,r0
000dd0  e28f0f69          ADR      r0,|L1.3964|
000dd4  ebfffffe          BL       sysprintf
;;;474                                    errorCode = 8;                                                
000dd8  e3a00008          MOV      r0,#8
000ddc  e58d0018          STR      r0,[sp,#0x18]
;;;475                                    goto jsonExit;
000de0  ea0001cf          B        |L1.5412|
                  |L1.3556|
;;;476                                }
;;;477                                
;;;478                                tmp_json4 = cJSON_GetObjectItem(tmp_json3, "hour");
000de4  e28f1f6b          ADR      r1,|L1.3992|
000de8  e1a00005          MOV      r0,r5
000dec  ebfffffe          BL       cJSON_GetObjectItem
000df0  e1a08000          MOV      r8,r0
;;;479                                if (tmp_json4 != NULL)
000df4  e3580000          CMP      r8,#0
000df8  0a00000a          BEQ      |L1.3624|
;;;480                                {
;;;481                                    jsonTariff[index].dayType[i].dayTypeItem[j].hour = tmp_json4->valueint;
000dfc  e5980014          LDR      r0,[r8,#0x14]
000e00  e51f1b4c          LDR      r1,|L1.700|
000e04  e0010194          MUL      r1,r4,r1
000e08  e51f2b50          LDR      r2,|L1.704|
000e0c  e0821101          ADD      r1,r2,r1,LSL #2
000e10  e2811084          ADD      r1,r1,#0x84
000e14  e0872087          ADD      r2,r7,r7,LSL #1
000e18  e0811282          ADD      r1,r1,r2,LSL #5
000e1c  e081120b          ADD      r1,r1,r11,LSL #4
000e20  e5810004          STR      r0,[r1,#4]
000e24  ea000007          B        |L1.3656|
                  |L1.3624|
;;;482                                    #if(ENABLE_LOAD_JSON_DEBUG)
;;;483                                    sysprintf("         >> jsonTariff[index].dayType[%d].dayTypeItem[%d].hour: %d\n", i, j, jsonTariff[index].dayType[i].dayTypeItem[j].hour);
;;;484                                    #endif
;;;485                                }
;;;486                                else
;;;487                                {
;;;488                                    sysprintf("error(hour):%s\n", cJSON_GetErrorPtr());  
000e28  ebfffffe          BL       cJSON_GetErrorPtr
000e2c  e58d000c          STR      r0,[sp,#0xc]
000e30  e1a01000          MOV      r1,r0
000e34  e28f0f59          ADR      r0,|L1.4000|
000e38  ebfffffe          BL       sysprintf
;;;489                                    errorCode = 9;                                                
000e3c  e3a00009          MOV      r0,#9
000e40  e58d0018          STR      r0,[sp,#0x18]
;;;490                                    goto jsonExit;
000e44  ea0001b6          B        |L1.5412|
                  |L1.3656|
;;;491                                }
;;;492                                
;;;493                                tmp_json4 = cJSON_GetObjectItem(tmp_json3, "minute");
000e48  e28f1e16          ADR      r1,|L1.4016|
000e4c  e1a00005          MOV      r0,r5
000e50  ebfffffe          BL       cJSON_GetObjectItem
000e54  e1a08000          MOV      r8,r0
;;;494                                if (tmp_json4 != NULL)
000e58  e3580000          CMP      r8,#0
000e5c  0a00000a          BEQ      |L1.3724|
;;;495                                {
;;;496                                    jsonTariff[index].dayType[i].dayTypeItem[j].minute = tmp_json4->valueint;
000e60  e5980014          LDR      r0,[r8,#0x14]
000e64  e51f1bb0          LDR      r1,|L1.700|
000e68  e0010194          MUL      r1,r4,r1
000e6c  e51f2bb4          LDR      r2,|L1.704|
000e70  e0821101          ADD      r1,r2,r1,LSL #2
000e74  e2811084          ADD      r1,r1,#0x84
000e78  e0872087          ADD      r2,r7,r7,LSL #1
000e7c  e0811282          ADD      r1,r1,r2,LSL #5
000e80  e081120b          ADD      r1,r1,r11,LSL #4
000e84  e5810008          STR      r0,[r1,#8]
000e88  ea000007          B        |L1.3756|
                  |L1.3724|
;;;497                                    #if(ENABLE_LOAD_JSON_DEBUG)
;;;498                                    sysprintf("         >> jsonTariff[index].dayType[%d].dayTypeItem[%d].minute: %d\n", i, j, jsonTariff[index].dayType[i].dayTypeItem[j].minute);
;;;499                                    #endif
;;;500                                }   
;;;501                                else
;;;502                                {
;;;503                                    sysprintf("error(minute):%s\n", cJSON_GetErrorPtr());  
000e8c  ebfffffe          BL       cJSON_GetErrorPtr
000e90  e58d000c          STR      r0,[sp,#0xc]
000e94  e1a01000          MOV      r1,r0
000e98  e28f0f46          ADR      r0,|L1.4024|
000e9c  ebfffffe          BL       sysprintf
;;;504                                    errorCode = 10;                                             
000ea0  e3a0000a          MOV      r0,#0xa
000ea4  e58d0018          STR      r0,[sp,#0x18]
;;;505                                    goto jsonExit;
000ea8  ea00019d          B        |L1.5412|
                  |L1.3756|
;;;506                                }
;;;507            
;;;508                                tmp_json4 = cJSON_GetObjectItem(tmp_json3, "continued");
000eac  e28f1f46          ADR      r1,|L1.4044|
000eb0  e1a00005          MOV      r0,r5
000eb4  ebfffffe          BL       cJSON_GetObjectItem
000eb8  e1a08000          MOV      r8,r0
;;;509                                if (tmp_json4 != NULL)
000ebc  e3580000          CMP      r8,#0
000ec0  0a000044          BEQ      |L1.4056|
;;;510                                {
;;;511                                    if(tmp_json4->type == cJSON_True)
000ec4  e598000c          LDR      r0,[r8,#0xc]
000ec8  e3500002          CMP      r0,#2
000ecc  1a00000a          BNE      |L1.3836|
;;;512                                    {
;;;513                                        jsonTariff[index].dayType[i].dayTypeItem[j].continued = TRUE;
000ed0  e3a00001          MOV      r0,#1
000ed4  e2801f46          ADD      r1,r0,#0x118
000ed8  e0010194          MUL      r1,r4,r1
000edc  e51f2c24          LDR      r2,|L1.704|
000ee0  e0821101          ADD      r1,r2,r1,LSL #2
000ee4  e2811084          ADD      r1,r1,#0x84
000ee8  e0872087          ADD      r2,r7,r7,LSL #1
000eec  e0811282          ADD      r1,r1,r2,LSL #5
000ef0  e081120b          ADD      r1,r1,r11,LSL #4
000ef4  e5c1000c          STRB     r0,[r1,#0xc]
000ef8  ea000046          B        |L1.4120|
                  |L1.3836|
;;;514                                        #if(ENABLE_LOAD_JSON_DEBUG)
;;;515                                        sysprintf("         >> jsonTariff[index].dayType[%d].dayTypeItem[%d].continued: %d (TRUE)\n", i, j, jsonTariff[index].dayType[i].dayTypeItem[j].continued);
;;;516                                        #endif
;;;517                                    }
;;;518                                    else if(tmp_json4->type == cJSON_False)
000efc  e598000c          LDR      r0,[r8,#0xc]
000f00  e3500001          CMP      r0,#1
000f04  1a000043          BNE      |L1.4120|
;;;519                                    {
;;;520                                        jsonTariff[index].dayType[i].dayTypeItem[j].continued = FALSE;
000f08  e3a00000          MOV      r0,#0
000f0c  e51f1c58          LDR      r1,|L1.700|
000f10  e0010194          MUL      r1,r4,r1
000f14  e51f2c5c          LDR      r2,|L1.704|
000f18  e0821101          ADD      r1,r2,r1,LSL #2
000f1c  e2811084          ADD      r1,r1,#0x84
000f20  e0872087          ADD      r2,r7,r7,LSL #1
000f24  e0811282          ADD      r1,r1,r2,LSL #5
000f28  e081120b          ADD      r1,r1,r11,LSL #4
000f2c  e5c1000c          STRB     r0,[r1,#0xc]
000f30  ea000038          B        |L1.4120|
                  |L1.3892|
000f34  7765656b          DCB      "week",0
000f38  00      
000f39  00                DCB      0
000f3a  00                DCB      0
000f3b  00                DCB      0
                  |L1.3900|
000f3c  6572726f          DCB      "error(week array):%s\n",0
000f40  72287765
000f44  656b2061
000f48  72726179
000f4c  293a2573
000f50  0a00    
000f52  00                DCB      0
000f53  00                DCB      0
                  |L1.3924|
000f54  6572726f          DCB      "error(week):%s\n",0
000f58  72287765
000f5c  656b293a
000f60  25730a00
                  |L1.3940|
000f64  64617974          DCB      "daytype",0
000f68  79706500
                  |L1.3948|
000f6c  74617269          DCB      "tariffsetting",0
000f70  66667365
000f74  7474696e
000f78  6700    
000f7a  00                DCB      0
000f7b  00                DCB      0
                  |L1.3964|
000f7c  6572726f          DCB      "error(tariffsetting):%s\n",0
000f80  72287461
000f84  72696666
000f88  73657474
000f8c  696e6729
000f90  3a25730a
000f94  00      
000f95  00                DCB      0
000f96  00                DCB      0
000f97  00                DCB      0
                  |L1.3992|
000f98  686f7572          DCB      "hour",0
000f9c  00      
000f9d  00                DCB      0
000f9e  00                DCB      0
000f9f  00                DCB      0
                  |L1.4000|
000fa0  6572726f          DCB      "error(hour):%s\n",0
000fa4  7228686f
000fa8  7572293a
000fac  25730a00
                  |L1.4016|
000fb0  6d696e75          DCB      "minute",0
000fb4  746500  
000fb7  00                DCB      0
                  |L1.4024|
000fb8  6572726f          DCB      "error(minute):%s\n",0
000fbc  72286d69
000fc0  6e757465
000fc4  293a2573
000fc8  0a00    
000fca  00                DCB      0
000fcb  00                DCB      0
                  |L1.4044|
000fcc  636f6e74          DCB      "continued",0
000fd0  696e7565
000fd4  6400    
000fd6  00                DCB      0
000fd7  00                DCB      0
                  |L1.4056|
;;;521                                        #if(ENABLE_LOAD_JSON_DEBUG)
;;;522                                        sysprintf("         >> jsonTariff[index].dayType[%d].dayTypeItem[%d].continued: %d (FALSE)\n", i, j, jsonTariff[index].dayType[i].dayTypeItem[j].continued);
;;;523                                        #endif
;;;524                                    }
;;;525    
;;;526                                }  
;;;527                                else
;;;528                                {
;;;529                                    sysprintf("error(continued):%s\n", cJSON_GetErrorPtr());   
000fd8  ebfffffe          BL       cJSON_GetErrorPtr
000fdc  e58d000c          STR      r0,[sp,#0xc]
000fe0  e1a01000          MOV      r1,r0
000fe4  e28f0fad          ADR      r0,|L1.4768|
000fe8  ebfffffe          BL       sysprintf
;;;530                                    errorCode = 11;                                             
000fec  e3a0000b          MOV      r0,#0xb
000ff0  e58d0018          STR      r0,[sp,#0x18]
;;;531                                    goto jsonExit;
000ff4  ea00014a          B        |L1.5412|
                  |L1.4088|
;;;532                                }                                        
;;;533                                
;;;534                            }
;;;535                            else
;;;536                            {
;;;537                                sysprintf("error(tariffsetting array 2):%s\n", cJSON_GetErrorPtr());     
000ff8  ebfffffe          BL       cJSON_GetErrorPtr
000ffc  e58d000c          STR      r0,[sp,#0xc]
001000  e1a01000          MOV      r1,r0
001004  e28f0fab          ADR      r0,|L1.4792|
001008  ebfffffe          BL       sysprintf
;;;538                                errorCode = 12;                                         
00100c  e3a0000c          MOV      r0,#0xc
001010  e58d0018          STR      r0,[sp,#0x18]
;;;539                                goto jsonExit;
001014  ea000142          B        |L1.5412|
                  |L1.4120|
001018  e28bb001          ADD      r11,r11,#1            ;458
                  |L1.4124|
00101c  e59d0010          LDR      r0,[sp,#0x10]         ;458
001020  e15b0000          CMP      r11,r0                ;458
001024  baffff50          BLT      |L1.3436|
;;;540                            }
;;;541                        }
;;;542                    }  
001028  ea000007          B        |L1.4172|
                  |L1.4140|
;;;543                    else
;;;544                    {
;;;545                        sysprintf("error(tariffsetting array 1):%s\n", cJSON_GetErrorPtr());  
00102c  ebfffffe          BL       cJSON_GetErrorPtr
001030  e58d0010          STR      r0,[sp,#0x10]
001034  e1a01000          MOV      r1,r0
001038  e28f0fa7          ADR      r0,|L1.4828|
00103c  ebfffffe          BL       sysprintf
;;;546                        errorCode = 13;                                 
001040  e3a0000d          MOV      r0,#0xd
001044  e58d0018          STR      r0,[sp,#0x18]
;;;547                        goto jsonExit;
001048  ea000135          B        |L1.5412|
                  |L1.4172|
00104c  e2877001          ADD      r7,r7,#1              ;447
                  |L1.4176|
001050  e59d0014          LDR      r0,[sp,#0x14]         ;447
001054  e1570000          CMP      r7,r0                 ;447
001058  baffff33          BLT      |L1.3372|
;;;548                    }                            
;;;549                }
;;;550                
;;;551            }
00105c  ea000007          B        |L1.4224|
                  |L1.4192|
;;;552            else
;;;553            {
;;;554                sysprintf("error(daytype):%s\n", cJSON_GetErrorPtr());  
001060  ebfffffe          BL       cJSON_GetErrorPtr
001064  e1a07000          MOV      r7,r0
001068  e1a01007          MOV      r1,r7
00106c  e28f0fa3          ADR      r0,|L1.4864|
001070  ebfffffe          BL       sysprintf
;;;555                errorCode = 14;                         
001074  e3a0000e          MOV      r0,#0xe
001078  e58d0018          STR      r0,[sp,#0x18]
;;;556                goto jsonExit;
00107c  ea000128          B        |L1.5412|
                  |L1.4224|
;;;557            }
;;;558            
;;;559            //tariff type
;;;560            tmp_json = cJSON_GetObjectItem(root_json, "tariffsetting");
001080  e24f1f47          ADR      r1,|L1.3948|
001084  e1a0000a          MOV      r0,r10
001088  ebfffffe          BL       cJSON_GetObjectItem
00108c  e1a06000          MOV      r6,r0
;;;561            if (tmp_json != NULL)
001090  e3560000          CMP      r6,#0
001094  0a00010f          BEQ      |L1.5336|
;;;562            {
;;;563                int i;
;;;564                int arrarSize = cJSON_GetArraySize(tmp_json);
001098  e1a00006          MOV      r0,r6
00109c  ebfffffe          BL       cJSON_GetArraySize
0010a0  e1a0b000          MOV      r11,r0
;;;565                #if(ENABLE_LOAD_JSON_DEBUG)
;;;566                sysprintf(" >> jsonTariff[index].tariffsetting: arrar size = %d\n", arrarSize);
;;;567                #endif
;;;568                if(arrarSize > TARIFF_TARIFF_SETTING_NUM)
0010a4  e35b000a          CMP      r11,#0xa
0010a8  da000000          BLE      |L1.4272|
;;;569                    arrarSize = TARIFF_TARIFF_SETTING_NUM;
0010ac  e3a0b00a          MOV      r11,#0xa
                  |L1.4272|
;;;570                for(i = 0; i < arrarSize; i++)
0010b0  e3a07000          MOV      r7,#0
0010b4  ea000104          B        |L1.5324|
                  |L1.4280|
;;;571                {                       
;;;572                    tmp_json2 = cJSON_GetArrayItem(tmp_json, i);   
0010b8  e1a01007          MOV      r1,r7
0010bc  e1a00006          MOV      r0,r6
0010c0  ebfffffe          BL       cJSON_GetArrayItem
0010c4  e1a09000          MOV      r9,r0
;;;573                    if (tmp_json2 != NULL)
0010c8  e3590000          CMP      r9,#0
0010cc  0a0000fd          BEQ      |L1.5320|
;;;574                    {
;;;575                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "type");
0010d0  e28f1f8f          ADR      r1,|L1.4884|
0010d4  e1a00009          MOV      r0,r9
0010d8  ebfffffe          BL       cJSON_GetObjectItem
0010dc  e1a05000          MOV      r5,r0
;;;576                        if (tmp_json3 != NULL)
0010e0  e3550000          CMP      r5,#0
0010e4  0a000007          BEQ      |L1.4360|
;;;577                        {
;;;578                            jsonTariff[index].tariffSetting[i].type = tmp_json3->valueint;
0010e8  e5950014          LDR      r0,[r5,#0x14]
0010ec  e51f1e38          LDR      r1,|L1.700|
0010f0  e0010194          MUL      r1,r4,r1
0010f4  e51f2e3c          LDR      r2,|L1.704|
0010f8  e0821101          ADD      r1,r2,r1,LSL #2
0010fc  e2811fc9          ADD      r1,r1,#0x324
001100  e7810287          STR      r0,[r1,r7,LSL #5]
001104  ea000007          B        |L1.4392|
                  |L1.4360|
;;;579                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;580                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].type: %d\n", i, jsonTariff[index].tariffSetting[i].type);
;;;581                            #endif
;;;582                        }
;;;583                        else
;;;584                        {
;;;585                            sysprintf("error(type):%s\n", cJSON_GetErrorPtr());  
001108  ebfffffe          BL       cJSON_GetErrorPtr
00110c  e58d0014          STR      r0,[sp,#0x14]
001110  e1a01000          MOV      r1,r0
001114  e28f0c02          ADR      r0,|L1.4892|
001118  ebfffffe          BL       sysprintf
;;;586                            errorCode = 15;                                    
00111c  e3a0000f          MOV      r0,#0xf
001120  e58d0018          STR      r0,[sp,#0x18]
;;;587                            goto jsonExit;
001124  ea0000fe          B        |L1.5412|
                  |L1.4392|
;;;588                        }
;;;589                        
;;;590                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "cost");
001128  e28f1f7f          ADR      r1,|L1.4908|
00112c  e1a00009          MOV      r0,r9
001130  ebfffffe          BL       cJSON_GetObjectItem
001134  e1a05000          MOV      r5,r0
;;;591                        if (tmp_json3 != NULL)
001138  e3550000          CMP      r5,#0
00113c  0a000008          BEQ      |L1.4452|
;;;592                        {
;;;593                            jsonTariff[index].tariffSetting[i].cost = tmp_json3->valueint;
001140  e5950014          LDR      r0,[r5,#0x14]
001144  e51f1e90          LDR      r1,|L1.700|
001148  e0010194          MUL      r1,r4,r1
00114c  e51f2e94          LDR      r2,|L1.704|
001150  e0821101          ADD      r1,r2,r1,LSL #2
001154  e2811fc9          ADD      r1,r1,#0x324
001158  e0811287          ADD      r1,r1,r7,LSL #5
00115c  e5810004          STR      r0,[r1,#4]
001160  ea000007          B        |L1.4484|
                  |L1.4452|
;;;594                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;595                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].cost: %d\n", i, jsonTariff[index].tariffSetting[i].cost);
;;;596                            #endif
;;;597                        }
;;;598                        else
;;;599                        {
;;;600                            sysprintf("error(cost):%s\n", cJSON_GetErrorPtr());  
001164  ebfffffe          BL       cJSON_GetErrorPtr
001168  e58d0014          STR      r0,[sp,#0x14]
00116c  e1a01000          MOV      r1,r0
001170  e28f0f6f          ADR      r0,|L1.4916|
001174  ebfffffe          BL       sysprintf
;;;601                            errorCode = 16;   
001178  e3a00010          MOV      r0,#0x10
00117c  e58d0018          STR      r0,[sp,#0x18]
;;;602                            goto jsonExit;
001180  ea0000e7          B        |L1.5412|
                  |L1.4484|
;;;603                        }
;;;604                        
;;;605                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "timeunit");
001184  e28f1f6e          ADR      r1,|L1.4932|
001188  e1a00009          MOV      r0,r9
00118c  ebfffffe          BL       cJSON_GetObjectItem
001190  e1a05000          MOV      r5,r0
;;;606                        if (tmp_json3 != NULL)
001194  e3550000          CMP      r5,#0
001198  0a00000a          BEQ      |L1.4552|
;;;607                        {
;;;608                            jsonTariff[index].tariffSetting[i].timeunit = tmp_json3->valueint * 60;
00119c  e5950014          LDR      r0,[r5,#0x14]
0011a0  e0600200          RSB      r0,r0,r0,LSL #4
0011a4  e1a00100          LSL      r0,r0,#2
0011a8  e51f1ef4          LDR      r1,|L1.700|
0011ac  e0010194          MUL      r1,r4,r1
0011b0  e51f2ef8          LDR      r2,|L1.704|
0011b4  e0821101          ADD      r1,r2,r1,LSL #2
0011b8  e2811fc9          ADD      r1,r1,#0x324
0011bc  e0811287          ADD      r1,r1,r7,LSL #5
0011c0  e5810008          STR      r0,[r1,#8]
0011c4  ea000007          B        |L1.4584|
                  |L1.4552|
;;;609                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;610                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].timeunit: %d\n", i, jsonTariff[index].tariffSetting[i].timeunit);
;;;611                            #endif
;;;612                        }
;;;613                        else
;;;614                        {
;;;615                            sysprintf("error(timeunit):%s\n", cJSON_GetErrorPtr());   
0011c8  ebfffffe          BL       cJSON_GetErrorPtr
0011cc  e58d0014          STR      r0,[sp,#0x14]
0011d0  e1a01000          MOV      r1,r0
0011d4  e28f0f5d          ADR      r0,|L1.4944|
0011d8  ebfffffe          BL       sysprintf
;;;616                            errorCode = 17;   
0011dc  e3a00011          MOV      r0,#0x11
0011e0  e58d0018          STR      r0,[sp,#0x18]
;;;617                            goto jsonExit;
0011e4  ea0000ce          B        |L1.5412|
                  |L1.4584|
;;;618                        }
;;;619                        
;;;620                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "basecost");
0011e8  e28f1f5d          ADR      r1,|L1.4964|
0011ec  e1a00009          MOV      r0,r9
0011f0  ebfffffe          BL       cJSON_GetObjectItem
0011f4  e1a05000          MOV      r5,r0
;;;621                        if (tmp_json3 != NULL)
0011f8  e3550000          CMP      r5,#0
0011fc  0a000008          BEQ      |L1.4644|
;;;622                        {
;;;623                            jsonTariff[index].tariffSetting[i].basecost = tmp_json3->valueint;
001200  e5950014          LDR      r0,[r5,#0x14]
001204  e51f1f50          LDR      r1,|L1.700|
001208  e0010194          MUL      r1,r4,r1
00120c  e51f2f54          LDR      r2,|L1.704|
001210  e0821101          ADD      r1,r2,r1,LSL #2
001214  e2811fc9          ADD      r1,r1,#0x324
001218  e0811287          ADD      r1,r1,r7,LSL #5
00121c  e581000c          STR      r0,[r1,#0xc]
001220  ea000007          B        |L1.4676|
                  |L1.4644|
;;;624                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;625                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].basecost: %d\n", i, jsonTariff[index].tariffSetting[i].basecost);
;;;626                            #endif
;;;627                        }
;;;628                        else
;;;629                        {
;;;630                            sysprintf("error(basecost):%s\n", cJSON_GetErrorPtr());   
001224  ebfffffe          BL       cJSON_GetErrorPtr
001228  e58d0014          STR      r0,[sp,#0x14]
00122c  e1a01000          MOV      r1,r0
001230  e28f0f4e          ADR      r0,|L1.4976|
001234  ebfffffe          BL       sysprintf
;;;631                            errorCode = 18;   
001238  e3a00012          MOV      r0,#0x12
00123c  e58d0018          STR      r0,[sp,#0x18]
;;;632                            goto jsonExit;
001240  ea0000b7          B        |L1.5412|
                  |L1.4676|
;;;633                        }
;;;634                        
;;;635                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "costunit");
001244  e28f1f4e          ADR      r1,|L1.4996|
001248  e1a00009          MOV      r0,r9
00124c  ebfffffe          BL       cJSON_GetObjectItem
001250  e1a05000          MOV      r5,r0
;;;636                        if (tmp_json3 != NULL)
001254  e3550000          CMP      r5,#0
001258  0a000008          BEQ      |L1.4736|
;;;637                        {
;;;638                            jsonTariff[index].tariffSetting[i].costunit = tmp_json3->valueint;
00125c  e5950014          LDR      r0,[r5,#0x14]
001260  e51f1fac          LDR      r1,|L1.700|
001264  e0010194          MUL      r1,r4,r1
001268  e51f2fb0          LDR      r2,|L1.704|
00126c  e0821101          ADD      r1,r2,r1,LSL #2
001270  e2811fc9          ADD      r1,r1,#0x324
001274  e0811287          ADD      r1,r1,r7,LSL #5
001278  e5810010          STR      r0,[r1,#0x10]
00127c  ea000048          B        |L1.5028|
                  |L1.4736|
;;;639                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;640                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].costunit: %d\n", i, jsonTariff[index].tariffSetting[i].costunit);
;;;641                            #endif
;;;642                        }
;;;643                        else
;;;644                        {
;;;645                            sysprintf("error(costunit):%s\n", cJSON_GetErrorPtr());   
001280  ebfffffe          BL       cJSON_GetErrorPtr
001284  e58d0014          STR      r0,[sp,#0x14]
001288  e1a01000          MOV      r1,r0
00128c  e28f00fc          ADR      r0,|L1.5008|
001290  ebfffffe          BL       sysprintf
;;;646                            errorCode = 19;                                       
001294  e3a00013          MOV      r0,#0x13
001298  e58d0018          STR      r0,[sp,#0x18]
;;;647                            goto jsonExit;
00129c  ea0000a0          B        |L1.5412|
                  |L1.4768|
0012a0  6572726f          DCB      "error(continued):%s\n",0
0012a4  7228636f
0012a8  6e74696e
0012ac  75656429
0012b0  3a25730a
0012b4  00      
0012b5  00                DCB      0
0012b6  00                DCB      0
0012b7  00                DCB      0
                  |L1.4792|
0012b8  6572726f          DCB      "error(tariffsetting array 2):%s\n",0
0012bc  72287461
0012c0  72696666
0012c4  73657474
0012c8  696e6720
0012cc  61727261
0012d0  79203229
0012d4  3a25730a
0012d8  00      
0012d9  00                DCB      0
0012da  00                DCB      0
0012db  00                DCB      0
                  |L1.4828|
0012dc  6572726f          DCB      "error(tariffsetting array 1):%s\n",0
0012e0  72287461
0012e4  72696666
0012e8  73657474
0012ec  696e6720
0012f0  61727261
0012f4  79203129
0012f8  3a25730a
0012fc  00      
0012fd  00                DCB      0
0012fe  00                DCB      0
0012ff  00                DCB      0
                  |L1.4864|
001300  6572726f          DCB      "error(daytype):%s\n",0
001304  72286461
001308  79747970
00130c  65293a25
001310  730a00  
001313  00                DCB      0
                  |L1.4884|
001314  74797065          DCB      "type",0
001318  00      
001319  00                DCB      0
00131a  00                DCB      0
00131b  00                DCB      0
                  |L1.4892|
00131c  6572726f          DCB      "error(type):%s\n",0
001320  72287479
001324  7065293a
001328  25730a00
                  |L1.4908|
00132c  636f7374          DCB      "cost",0
001330  00      
001331  00                DCB      0
001332  00                DCB      0
001333  00                DCB      0
                  |L1.4916|
001334  6572726f          DCB      "error(cost):%s\n",0
001338  7228636f
00133c  7374293a
001340  25730a00
                  |L1.4932|
001344  74696d65          DCB      "timeunit",0
001348  756e6974
00134c  00      
00134d  00                DCB      0
00134e  00                DCB      0
00134f  00                DCB      0
                  |L1.4944|
001350  6572726f          DCB      "error(timeunit):%s\n",0
001354  72287469
001358  6d65756e
00135c  6974293a
001360  25730a00
                  |L1.4964|
001364  62617365          DCB      "basecost",0
001368  636f7374
00136c  00      
00136d  00                DCB      0
00136e  00                DCB      0
00136f  00                DCB      0
                  |L1.4976|
001370  6572726f          DCB      "error(basecost):%s\n",0
001374  72286261
001378  7365636f
00137c  7374293a
001380  25730a00
                  |L1.4996|
001384  636f7374          DCB      "costunit",0
001388  756e6974
00138c  00      
00138d  00                DCB      0
00138e  00                DCB      0
00138f  00                DCB      0
                  |L1.5008|
001390  6572726f          DCB      "error(costunit):%s\n",0
001394  7228636f
001398  7374756e
00139c  6974293a
0013a0  25730a00
                  |L1.5028|
;;;648                        }
;;;649                        
;;;650                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "maxcost");
0013a4  e28f1fa1          ADR      r1,|L1.5680|
0013a8  e1a00009          MOV      r0,r9
0013ac  ebfffffe          BL       cJSON_GetObjectItem
0013b0  e1a05000          MOV      r5,r0
;;;651                        if (tmp_json3 != NULL)
0013b4  e3550000          CMP      r5,#0
0013b8  0a000008          BEQ      |L1.5088|
;;;652                        {
;;;653                            jsonTariff[index].tariffSetting[i].maxcost = tmp_json3->valueint;
0013bc  e5950014          LDR      r0,[r5,#0x14]
0013c0  e59f1270          LDR      r1,|L1.5688|
0013c4  e0010194          MUL      r1,r4,r1
0013c8  e59f226c          LDR      r2,|L1.5692|
0013cc  e0821101          ADD      r1,r2,r1,LSL #2
0013d0  e2811fc9          ADD      r1,r1,#0x324
0013d4  e0811287          ADD      r1,r1,r7,LSL #5
0013d8  e5810014          STR      r0,[r1,#0x14]
0013dc  ea000007          B        |L1.5120|
                  |L1.5088|
;;;654                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;655                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].maxcost: %d\n", i, jsonTariff[index].tariffSetting[i].maxcost);
;;;656                            #endif
;;;657                        }
;;;658                        else
;;;659                        {
;;;660                            sysprintf("error(maxcost):%s\n", cJSON_GetErrorPtr());   
0013e0  ebfffffe          BL       cJSON_GetErrorPtr
0013e4  e58d0014          STR      r0,[sp,#0x14]
0013e8  e1a01000          MOV      r1,r0
0013ec  e28f0f93          ADR      r0,|L1.5696|
0013f0  ebfffffe          BL       sysprintf
;;;661                            errorCode = 20;                                     
0013f4  e3a00014          MOV      r0,#0x14
0013f8  e58d0018          STR      r0,[sp,#0x18]
;;;662                            goto jsonExit;
0013fc  ea000048          B        |L1.5412|
                  |L1.5120|
;;;663                        }
;;;664                        
;;;665                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "maxtime");
001400  e28f1f93          ADR      r1,|L1.5716|
001404  e1a00009          MOV      r0,r9
001408  ebfffffe          BL       cJSON_GetObjectItem
00140c  e1a05000          MOV      r5,r0
;;;666                        if (tmp_json3 != NULL)
001410  e3550000          CMP      r5,#0
001414  0a00000a          BEQ      |L1.5188|
;;;667                        {
;;;668                            jsonTariff[index].tariffSetting[i].maxtime = tmp_json3->valueint*60;
001418  e5950014          LDR      r0,[r5,#0x14]
00141c  e0600200          RSB      r0,r0,r0,LSL #4
001420  e1a00100          LSL      r0,r0,#2
001424  e59f120c          LDR      r1,|L1.5688|
001428  e0010194          MUL      r1,r4,r1
00142c  e59f2208          LDR      r2,|L1.5692|
001430  e0821101          ADD      r1,r2,r1,LSL #2
001434  e2811fc9          ADD      r1,r1,#0x324
001438  e0811287          ADD      r1,r1,r7,LSL #5
00143c  e5810018          STR      r0,[r1,#0x18]
001440  ea000007          B        |L1.5220|
                  |L1.5188|
;;;669                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;670                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].maxtime: %d\n", i, jsonTariff[index].tariffSetting[i].maxtime);
;;;671                            #endif
;;;672                        }
;;;673                        else
;;;674                        {
;;;675                            sysprintf("error(maxtime):%s\n", cJSON_GetErrorPtr());   
001444  ebfffffe          BL       cJSON_GetErrorPtr
001448  e58d0014          STR      r0,[sp,#0x14]
00144c  e1a01000          MOV      r1,r0
001450  e28f0f81          ADR      r0,|L1.5724|
001454  ebfffffe          BL       sysprintf
;;;676                            errorCode = 21;                                     
001458  e3a00015          MOV      r0,#0x15
00145c  e58d0018          STR      r0,[sp,#0x18]
;;;677                            goto jsonExit;
001460  ea00002f          B        |L1.5412|
                  |L1.5220|
;;;678                        }
;;;679                        
;;;680                        tmp_json3 = cJSON_GetObjectItem(tmp_json2, "continuedtime");
001464  e28f1f81          ADR      r1,|L1.5744|
001468  e1a00009          MOV      r0,r9
00146c  ebfffffe          BL       cJSON_GetObjectItem
001470  e1a05000          MOV      r5,r0
;;;681                        if (tmp_json3 != NULL)
001474  e3550000          CMP      r5,#0
001478  0a00000a          BEQ      |L1.5288|
;;;682                        {
;;;683                            jsonTariff[index].tariffSetting[i].continuedtime = tmp_json3->valueint*60;
00147c  e5950014          LDR      r0,[r5,#0x14]
001480  e0600200          RSB      r0,r0,r0,LSL #4
001484  e1a00100          LSL      r0,r0,#2
001488  e59f11a8          LDR      r1,|L1.5688|
00148c  e0010194          MUL      r1,r4,r1
001490  e59f21a4          LDR      r2,|L1.5692|
001494  e0821101          ADD      r1,r2,r1,LSL #2
001498  e2811fc9          ADD      r1,r1,#0x324
00149c  e0811287          ADD      r1,r1,r7,LSL #5
0014a0  e581001c          STR      r0,[r1,#0x1c]
0014a4  ea000007          B        |L1.5320|
                  |L1.5288|
;;;684                            #if(ENABLE_LOAD_JSON_DEBUG)
;;;685                            sysprintf("     >> jsonTariff[index].tariffSetting[%d].continuedtime: %d\n", i, jsonTariff[index].tariffSetting[i].continuedtime);
;;;686                            #endif
;;;687                        }
;;;688                        else
;;;689                        {
;;;690                            sysprintf("error(continuedtime):%s\n", cJSON_GetErrorPtr());   
0014a8  ebfffffe          BL       cJSON_GetErrorPtr
0014ac  e58d0014          STR      r0,[sp,#0x14]
0014b0  e1a01000          MOV      r1,r0
0014b4  e28f0f71          ADR      r0,|L1.5760|
0014b8  ebfffffe          BL       sysprintf
;;;691                            errorCode = 22;                                     
0014bc  e3a00016          MOV      r0,#0x16
0014c0  e58d0018          STR      r0,[sp,#0x18]
;;;692                            goto jsonExit;
0014c4  ea000016          B        |L1.5412|
                  |L1.5320|
0014c8  e2877001          ADD      r7,r7,#1              ;570
                  |L1.5324|
0014cc  e157000b          CMP      r7,r11                ;570
0014d0  bafffef8          BLT      |L1.4280|
;;;693                        }                    
;;;694                    }                            
;;;695                }
;;;696            }     
0014d4  ea000007          B        |L1.5368|
                  |L1.5336|
;;;697            else
;;;698            {
;;;699                sysprintf("error(tariffsetting):%s\n", cJSON_GetErrorPtr());   
0014d8  ebfffffe          BL       cJSON_GetErrorPtr
0014dc  e1a07000          MOV      r7,r0
0014e0  e1a01007          MOV      r1,r7
0014e4  e59f01b0          LDR      r0,|L1.5788|
0014e8  ebfffffe          BL       sysprintf
;;;700                errorCode = 23;                         
0014ec  e3a00017          MOV      r0,#0x17
0014f0  e58d0018          STR      r0,[sp,#0x18]
;;;701                goto jsonExit;
0014f4  ea00000a          B        |L1.5412|
                  |L1.5368|
;;;702            }                            
;;;703            cJSON_Delete(root_json);
0014f8  e1a0000a          MOV      r0,r10
0014fc  ebfffffe          BL       cJSON_Delete
;;;704            if(needFree)
001500  e5dd0020          LDRB     r0,[sp,#0x20]
001504  e3500000          CMP      r0,#0
001508  0a000001          BEQ      |L1.5396|
;;;705            {
;;;706                vPortFree(dataTmp);
00150c  e59d0028          LDR      r0,[sp,#0x28]
001510  ebfffffe          BL       vPortFree
                  |L1.5396|
;;;707            }        
;;;708             //__SHOW_FREE_HEAP_SIZE__ 
;;;709            return TRUE;
001514  e3a00001          MOV      r0,#1
                  |L1.5400|
001518  e28dd034          ADD      sp,sp,#0x34
;;;710        }   
;;;711        
;;;712    jsonExit:
;;;713    
;;;714        if(root_json != NULL)
;;;715            cJSON_Delete(root_json);
;;;716       
;;;717        sysprintf("     load loadJsonTariff ERROR (errorCode = %d)>>\r\n", errorCode); 
;;;718        //{
;;;719        //    char str[256];
;;;720        //    sprintf(str, "!!ERROR!! loadJsonTariff ERROR (errorCode = %d)\r\n", errorCode); 
;;;721        //    LoglibPrintf(LOG_TYPE_ERROR, str);
;;;722        //}
;;;723        return FALSE;
;;;724    
;;;725    }
00151c  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.5408|
001520  e1a00000          MOV      r0,r0                 ;712
                  |L1.5412|
001524  e35a0000          CMP      r10,#0                ;714
001528  0a000001          BEQ      |L1.5428|
00152c  e1a0000a          MOV      r0,r10                ;715
001530  ebfffffe          BL       cJSON_Delete
                  |L1.5428|
001534  e28f0f59          ADR      r0,|L1.5792|
001538  e59d1018          LDR      r1,[sp,#0x18]         ;717
00153c  ebfffffe          BL       sysprintf
001540  e3a00000          MOV      r0,#0                 ;723
001544  eafffff3          B        |L1.5400|
;;;726    
                          ENDP

                  TariffUpdateCurrentTariffData PROC
;;;802    
;;;803    BOOL TariffUpdateCurrentTariffData(void)
001548  e92d4010          PUSH     {r4,lr}
;;;804    {
;;;805        if(selectTariffFile() == FALSE)
00154c  ebfffffe          BL       selectTariffFile
001550  e3500000          CMP      r0,#0
001554  1a000001          BNE      |L1.5472|
;;;806            return FALSE;
001558  e3a00000          MOV      r0,#0
                  |L1.5468|
;;;807        return updateCurrentTariffData(currentTariffFileIndex);
;;;808    }
00155c  e8bd8010          POP      {r4,pc}
                  |L1.5472|
001560  e59f016c          LDR      r0,|L1.5844|
001564  e5900000          LDR      r0,[r0,#0]            ;807  ; currentTariffFileIndex
001568  ebfffffe          BL       updateCurrentTariffData
00156c  eafffffa          B        |L1.5468|
;;;809    
                          ENDP

                  TariffLoadTariffFile PROC
;;;761    }
;;;762    BOOL TariffLoadTariffFile(void)
001570  e92d4010          PUSH     {r4,lr}
;;;763    {//有檔案改變時 重新載入到MEMORY
;;;764        int i;
;;;765        sysprintf("  !!! TariffLoadTariffFile !!!\n");
001574  e28f0f57          ADR      r0,|L1.5848|
001578  ebfffffe          BL       sysprintf
;;;766        if(loadTariffFileName() == TRUE)
00157c  ebfffffe          BL       loadTariffFileName
001580  e3500001          CMP      r0,#1
001584  1a000027          BNE      |L1.5672|
;;;767        {
;;;768            for(i = 0; i<TARIFF_FILE_NUM; i++)
001588  e3a04000          MOV      r4,#0
00158c  ea000022          B        |L1.5660|
                  |L1.5520|
;;;769            {
;;;770                //sysprintf(" -->> INFO[%d] >> Tariff File Name[%d] [%s] \r\n", i, 0, tariffFileName[0]);
;;;771                //sysprintf(" -->> INFO >> Tariff File Name[%d] [%s] \r\n", 1, tariffFileName[1]);
;;;772                //sysprintf(" -->> INFO >> Tariff File Name[%d] [%s] \r\n", 2, tariffFileName[2]);
;;;773                tariffEffectiveDate[i] = 20991231;
001590  e59f0160          LDR      r0,|L1.5880|
001594  e59f1160          LDR      r1,|L1.5884|
001598  e7810104          STR      r0,[r1,r4,LSL #2]
;;;774                if(strlen(tariffFileName[i]) != 0)
00159c  e0641404          RSB      r1,r4,r4,LSL #8
0015a0  e59f2158          LDR      r2,|L1.5888|
0015a4  e0810002          ADD      r0,r1,r2
0015a8  ebfffffe          BL       strlen
0015ac  e3500000          CMP      r0,#0
0015b0  0a000012          BEQ      |L1.5632|
;;;775                {
;;;776                    if(loadJsonTariff(i, tariffFileName[i]) == FALSE)
0015b4  e0640404          RSB      r0,r4,r4,LSL #8
0015b8  e59f2140          LDR      r2,|L1.5888|
0015bc  e0801002          ADD      r1,r0,r2
0015c0  e1a00004          MOV      r0,r4
0015c4  ebfffffe          BL       loadJsonTariff
0015c8  e3500000          CMP      r0,#0
0015cc  1a000001          BNE      |L1.5592|
;;;777                    {
;;;778                        return FALSE;
0015d0  e3a00000          MOV      r0,#0
                  |L1.5588|
;;;779                    }
;;;780                    else
;;;781                    {
;;;782                        tariffEffectiveDate[i] = jsonTariff[i].effectivetime;
;;;783                        printJsonTariff(i);
;;;784                    }
;;;785                }
;;;786                else
;;;787                {
;;;788                    sysprintf("  !!! TariffLoadTariffFile [%d] ignore (%s)!!!\n", i, tariffFileName[i]);
;;;789                }
;;;790            }   
;;;791            sortTariffFile();
;;;792        }
;;;793        else
;;;794        {
;;;795            //GuiManagerShowScreen(GUI_FILE_DOWNLOAD_ID, GUI_REDRAW_PARA_REFRESH, 0, 0);
;;;796        }
;;;797        
;;;798        //if(TariffUpdateCurrentTariffData() == FALSE)
;;;799        //    return FALSE;  
;;;800        return TRUE;    
;;;801    }
0015d4  e8bd8010          POP      {r4,pc}
                  |L1.5592|
0015d8  e59f0058          LDR      r0,|L1.5688|
0015dc  e0000094          MUL      r0,r4,r0              ;782
0015e0  e59f1054          LDR      r1,|L1.5692|
0015e4  e0810100          ADD      r0,r1,r0,LSL #2       ;782
0015e8  e5900024          LDR      r0,[r0,#0x24]         ;782
0015ec  e59f1108          LDR      r1,|L1.5884|
0015f0  e7810104          STR      r0,[r1,r4,LSL #2]     ;782
0015f4  e1a00004          MOV      r0,r4                 ;783
0015f8  ebfffffe          BL       printJsonTariff
0015fc  ea000005          B        |L1.5656|
                  |L1.5632|
001600  e0640404          RSB      r0,r4,r4,LSL #8       ;788
001604  e59f10f4          LDR      r1,|L1.5888|
001608  e0802001          ADD      r2,r0,r1              ;788
00160c  e1a01004          MOV      r1,r4                 ;788
001610  e28f00ec          ADR      r0,|L1.5892|
001614  ebfffffe          BL       sysprintf
                  |L1.5656|
001618  e2844001          ADD      r4,r4,#1              ;768
                  |L1.5660|
00161c  e3540003          CMP      r4,#3                 ;768
001620  baffffda          BLT      |L1.5520|
001624  ebfffffe          BL       sortTariffFile
                  |L1.5672|
001628  e3a00001          MOV      r0,#1                 ;800
00162c  eaffffe8          B        |L1.5588|
                  |L1.5680|
001630  6d617863          DCB      "maxcost",0
001634  6f737400
                  |L1.5688|
                          DCD      0x00000119
                  |L1.5692|
                          DCD      jsonTariff
                  |L1.5696|
001640  6572726f          DCB      "error(maxcost):%s\n",0
001644  72286d61
001648  78636f73
00164c  74293a25
001650  730a00  
001653  00                DCB      0
                  |L1.5716|
001654  6d617874          DCB      "maxtime",0
001658  696d6500
                  |L1.5724|
00165c  6572726f          DCB      "error(maxtime):%s\n",0
001660  72286d61
001664  7874696d
001668  65293a25
00166c  730a00  
00166f  00                DCB      0
                  |L1.5744|
001670  636f6e74          DCB      "continuedtime",0
001674  696e7565
001678  6474696d
00167c  6500    
00167e  00                DCB      0
00167f  00                DCB      0
                  |L1.5760|
001680  6572726f          DCB      "error(continuedtime):%s\n",0
001684  7228636f
001688  6e74696e
00168c  75656474
001690  696d6529
001694  3a25730a
001698  00      
001699  00                DCB      0
00169a  00                DCB      0
00169b  00                DCB      0
                  |L1.5788|
                          DCD      ||.text||+0xf7c
                  |L1.5792|
0016a0  20202020          DCB      "     load loadJsonTariff ERROR (errorCode = %d)>>\r\n",0
0016a4  206c6f61
0016a8  64206c6f
0016ac  61644a73
0016b0  6f6e5461
0016b4  72696666
0016b8  20455252
0016bc  4f522028
0016c0  6572726f
0016c4  72436f64
0016c8  65203d20
0016cc  2564293e
0016d0  3e0d0a00
                  |L1.5844|
                          DCD      currentTariffFileIndex
                  |L1.5848|
0016d8  20202121          DCB      "  !!! TariffLoadTariffFile !!!\n",0
0016dc  21205461
0016e0  72696666
0016e4  4c6f6164
0016e8  54617269
0016ec  66664669
0016f0  6c652021
0016f4  21210a00
                  |L1.5880|
                          DCD      0x01404cff
                  |L1.5884|
                          DCD      tariffEffectiveDate
                  |L1.5888|
                          DCD      tariffFileName
                  |L1.5892|
001704  20202121          DCB      "  !!! TariffLoadTariffFile [%d] ignore (%s)!!!\n",0
001708  21205461
00170c  72696666
001710  4c6f6164
001714  54617269
001718  66664669
00171c  6c65205b
001720  25645d20
001724  69676e6f
001728  72652028
00172c  25732921
001730  21210a00
                          ENDP

                  swInit PROC
;;;726    
;;;727    static BOOL swInit(void)
001734  e92d4010          PUSH     {r4,lr}
;;;728    {   
;;;729        if(TariffLoadTariffFile() == FALSE)
001738  ebfffffe          BL       TariffLoadTariffFile
00173c  e3500000          CMP      r0,#0
001740  1a000001          BNE      |L1.5964|
;;;730            return FALSE; 
001744  e3a00000          MOV      r0,#0
                  |L1.5960|
;;;731        return TariffUpdateCurrentTariffData();
;;;732    }
001748  e8bd8010          POP      {r4,pc}
                  |L1.5964|
00174c  ebfffffe          BL       TariffUpdateCurrentTariffData
001750  eafffffc          B        |L1.5960|
;;;733    
                          ENDP

                  applyData PROC
;;;734    static BOOL applyData(void)
001754  e3a00001          MOV      r0,#1
;;;735    { 
;;;736        
;;;737        return TRUE;
;;;738    }
001758  e12fff1e          BX       lr
;;;739        
                          ENDP

                  TariffLibInit PROC
;;;742    /*-----------------------------------------*/
;;;743    BOOL TariffLibInit(void)
00175c  e92d4010          PUSH     {r4,lr}
;;;744    {
;;;745        sysprintf("TariffLibInit!!\n");
001760  e28f00b0          ADR      r0,|L1.6168|
001764  ebfffffe          BL       sysprintf
;;;746        
;;;747        if(swInit() == FALSE)
001768  ebfffffe          BL       swInit
00176c  e3500000          CMP      r0,#0
001770  1a000003          BNE      |L1.6020|
;;;748        {
;;;749            sysprintf("TariffLibInit ERROR (swInit false)!!\n");
001774  e28f00b0          ADR      r0,|L1.6188|
001778  ebfffffe          BL       sysprintf
;;;750            
;;;751            return FALSE;
00177c  e3a00000          MOV      r0,#0
                  |L1.6016|
;;;752        }
;;;753        if(applyData() == FALSE)
;;;754        {
;;;755            sysprintf("TariffLibInit ERROR (applyData false)!!\n");
;;;756            return FALSE;
;;;757        }
;;;758        
;;;759        sysprintf("TariffLibInit OK!!\n");
;;;760        return TRUE;
;;;761    }
001780  e8bd8010          POP      {r4,pc}
                  |L1.6020|
001784  ebfffffe          BL       applyData
001788  e3500000          CMP      r0,#0                 ;753
00178c  1a000003          BNE      |L1.6048|
001790  e28f00bc          ADR      r0,|L1.6228|
001794  ebfffffe          BL       sysprintf
001798  e3a00000          MOV      r0,#0                 ;756
00179c  eafffff7          B        |L1.6016|
                  |L1.6048|
0017a0  e28f00d8          ADR      r0,|L1.6272|
0017a4  ebfffffe          BL       sysprintf
0017a8  e3a00001          MOV      r0,#1                 ;760
0017ac  eafffff3          B        |L1.6016|
;;;762    BOOL TariffLoadTariffFile(void)
                          ENDP

                  TariffGetCurrentTariffType PROC
;;;809    
;;;810    JsonTariffSetting* TariffGetCurrentTariffType(void)
0017b0  e51f0f50          LDR      r0,|L1.2152|
;;;811    {
;;;812        return currentJsonTariffType;
0017b4  e5900000          LDR      r0,[r0,#0]  ; currentJsonTariffType
;;;813    }
0017b8  e12fff1e          BX       lr
;;;814    char* TariffGetFileName()
                          ENDP

                  TariffGetFileName PROC
0017bc  e51f00f0          LDR      r0,|L1.5844|
;;;815    {
;;;816        return jsonTariff[currentTariffFileIndex].name;
0017c0  e5900000          LDR      r0,[r0,#0]  ; currentTariffFileIndex
0017c4  e51f1194          LDR      r1,|L1.5688|
0017c8  e0000091          MUL      r0,r1,r0
0017cc  e51f1198          LDR      r1,|L1.5692|
0017d0  e0810100          ADD      r0,r1,r0,LSL #2
0017d4  e2800004          ADD      r0,r0,#4
;;;817    }
0017d8  e12fff1e          BX       lr
;;;818    
                          ENDP

                  TariffGetNextWakeupTime PROC
;;;819    BOOL TariffGetNextWakeupTime(UINT32* wakeUpTime, RTC_TIME_DATA_T* sCurTime)
0017dc  e92d4070          PUSH     {r4-r6,lr}
;;;820    {
0017e0  e1a04000          MOV      r4,r0
0017e4  e1a05001          MOV      r5,r1
;;;821        *wakeUpTime = 0;
0017e8  e3a00000          MOV      r0,#0
0017ec  e5840000          STR      r0,[r4,#0]
;;;822        /* Get the currnet time */
;;;823        if(E_RTC_SUCCESS == RTC_Read(RTC_CURRENT_TIME, sCurTime))
0017f0  e1a01005          MOV      r1,r5
0017f4  ebfffffe          BL       RTC_Read
0017f8  e3500000          CMP      r0,#0
0017fc  1a000003          BNE      |L1.6160|
;;;824        {
;;;825            #if(BUILD_RELEASE_VERSION || BUILD_PRE_RELEASE_VERSION)
;;;826            *wakeUpTime = 60 - sCurTime->u32cSecond;
;;;827            if(*wakeUpTime < 5)
;;;828                *wakeUpTime = *wakeUpTime + 60;
;;;829            #else
;;;830            *wakeUpTime = 5;
001800  e3a00005          MOV      r0,#5
001804  e5840000          STR      r0,[r4,#0]
;;;831            #endif
;;;832            return TRUE;
001808  e3a00001          MOV      r0,#1
                  |L1.6156|
;;;833        }
;;;834        return FALSE;
;;;835    }
00180c  e8bd8070          POP      {r4-r6,pc}
                  |L1.6160|
001810  e3a00000          MOV      r0,#0                 ;834
001814  eafffffc          B        |L1.6156|
;;;836    
                          ENDP

                  |L1.6168|
001818  54617269          DCB      "TariffLibInit!!\n",0
00181c  66664c69
001820  62496e69
001824  7421210a
001828  00      
001829  00                DCB      0
00182a  00                DCB      0
00182b  00                DCB      0
                  |L1.6188|
00182c  54617269          DCB      "TariffLibInit ERROR (swInit false)!!\n",0
001830  66664c69
001834  62496e69
001838  74204552
00183c  524f5220
001840  28737749
001844  6e697420
001848  66616c73
00184c  65292121
001850  0a00    
001852  00                DCB      0
001853  00                DCB      0
                  |L1.6228|
001854  54617269          DCB      "TariffLibInit ERROR (applyData false)!!\n",0
001858  66664c69
00185c  62496e69
001860  74204552
001864  524f5220
001868  28617070
00186c  6c794461
001870  74612066
001874  616c7365
001878  2921210a
00187c  00      
00187d  00                DCB      0
00187e  00                DCB      0
00187f  00                DCB      0
                  |L1.6272|
001880  54617269          DCB      "TariffLibInit OK!!\n",0
001884  66664c69
001888  62496e69
00188c  74204f4b
001890  21210a00

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  tariffEffectiveDate
                          %        12
                  jsonTariff
                          %        3372
                  tariffFileName
                          %        765

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

000000  0d0a202d          DCB      0x0d,0x0a,0x20,0x2d
000004  2d2d2d2d          DCB      0x2d,0x2d,0x2d,0x2d
000008  2d2d2d2d          DCB      0x2d,0x2d,0x2d,0x2d
00000c  2d206a73          DCB      0x2d,0x20,0x6a,0x73
000010  6f6e7665          DCB      0x6f,0x6e,0x76,0x65
000014  723a2025          DCB      0x72,0x3a,0x20,0x25
000018  64202825          DCB      0x64,0x20,0x28,0x25
00001c  732c2025          DCB      0x73,0x2c,0x20,0x25
000020  73292865          DCB      0x73,0x29,0x28,0x65
000024  66666563          DCB      0x66,0x66,0x65,0x63
000028  74697665          DCB      0x74,0x69,0x76,0x65
00002c  203a2025          DCB      0x20,0x3a,0x20,0x25
000030  6429202d          DCB      0x64,0x29,0x20,0x2d
000034  2d2d2d2d          DCB      0x2d,0x2d,0x2d,0x2d
000038  2d2d2d2d          DCB      0x2d,0x2d,0x2d,0x2d
00003c  2d2d0d0a          DCB      0x2d,0x2d,0x0d,0x0a
000040  00000000          DCB      0x00,0x00,0x00,0x00
000044  20202020          DCB      0x20,0x20,0x20,0x20
000048  20546172          DCB      0x20,0x54,0x61,0x72
00004c  69666620          DCB      0x69,0x66,0x66,0x20
000050  54797065          DCB      0x54,0x79,0x70,0x65
000054  2d2d3e20          DCB      0x2d,0x2d,0x3e,0x20
000058  74797065          DCB      0x74,0x79,0x70,0x65
00005c  3a202564          DCB      0x3a,0x20,0x25,0x64
000060  2c207469          DCB      0x2c,0x20,0x74,0x69
000064  6d65756e          DCB      0x6d,0x65,0x75,0x6e
000068  69743a20          DCB      0x69,0x74,0x3a,0x20
00006c  25642c20          DCB      0x25,0x64,0x2c,0x20
000070  62617365          DCB      0x62,0x61,0x73,0x65
000074  636f7374          DCB      0x63,0x6f,0x73,0x74
000078  3a202564          DCB      0x3a,0x20,0x25,0x64
00007c  2c20636f          DCB      0x2c,0x20,0x63,0x6f
000080  7374756e          DCB      0x73,0x74,0x75,0x6e
000084  69743a20          DCB      0x69,0x74,0x3a,0x20
000088  25642c20          DCB      0x25,0x64,0x2c,0x20
00008c  6d617863          DCB      0x6d,0x61,0x78,0x63
000090  6f73743a          DCB      0x6f,0x73,0x74,0x3a
000094  2025642c          DCB      0x20,0x25,0x64,0x2c
000098  206d6178          DCB      0x20,0x6d,0x61,0x78
00009c  74696d65          DCB      0x74,0x69,0x6d,0x65
0000a0  3a202564          DCB      0x3a,0x20,0x25,0x64
0000a4  2c20636f          DCB      0x2c,0x20,0x63,0x6f
0000a8  6e74696e          DCB      0x6e,0x74,0x69,0x6e
0000ac  75656474          DCB      0x75,0x65,0x64,0x74
0000b0  696d653a          DCB      0x69,0x6d,0x65,0x3a
0000b4  2025640d          DCB      0x20,0x25,0x64,0x0d
0000b8  0a00              DCB      0x0a,0x00

                          AREA ||.data||, DATA, ALIGN=2

                  currentJsonTariffType
                          DCD      0x00000000
                  currentJsonTariffDayType
                          DCD      0x00000000
                  currentTariffFileIndex
                          DCD      0x000000ff
                  tariffIndex
                          DCD      0x00000000
